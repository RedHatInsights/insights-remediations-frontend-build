{"version":3,"file":"js/1527.1681921242871.e337906e8ba2096b8e9a.js","mappings":"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","sources":["webpack:///./node_modules/@redhat-cloud-services/frontend-components/esm/useChrome/useChrome.js","webpack:///./src/modules/RemediationsButton.js","webpack:///./src/modules/RemediationsModal/NoDataModal.js","webpack:///./src/modules/RemediationsModal/validate/validator.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { useScalprum } from '@scalprum/react-core';\nvar useChrome = function (selector) {\n    var _a;\n    var state = useScalprum();\n    var chrome = ((_a = state.api) === null || _a === void 0 ? void 0 : _a.chrome) || {};\n    chrome = __assign(__assign({}, chrome), { initialized: state.initialized });\n    if (typeof selector === 'function') {\n        return selector(chrome);\n    }\n    return chrome;\n};\nexport default useChrome;\n//# sourceMappingURL=useChrome.js.map","import React, { useEffect, useState } from 'react';\n\nimport propTypes from 'prop-types';\nimport useChrome from '@redhat-cloud-services/frontend-components/useChrome';\nimport validate from './RemediationsModal/validate';\n\nimport { CAN_REMEDIATE, matchPermissions } from '../Utilities/utils';\nimport { Button, Tooltip } from '@patternfly/react-core';\nimport RemediationWizard from './RemediationsModal';\nimport NoDataModal from './RemediationsModal/NoDataModal';\n\nconst RemediationButton = ({\n  isDisabled,\n  children,\n  dataProvider,\n  onRemediationCreated,\n  buttonProps,\n}) => {\n  const [hasPermissions, setHasPermissions] = useState(false);\n  const [remediationsData, setRemediationsData] = useState();\n  const [isNoDataModalOpen, setNoDataModalOpen] = useState(false);\n  const chrome = useChrome();\n\n  useEffect(() => {\n    chrome.getUserPermissions('remediations').then((permissions) => {\n      setHasPermissions(\n        permissions.some(({ permission }) => {\n          return matchPermissions(permission, CAN_REMEDIATE);\n        })\n      );\n    });\n  }, []);\n\n  if (!hasPermissions) {\n    return (\n      <Tooltip content=\"You do not have correct permissions to remediate this entity.\">\n        <span>\n          <Button isDisabled {...buttonProps}>\n            {children}\n          </Button>\n        </span>\n      </Tooltip>\n    );\n  }\n\n  return (\n    <React.Fragment>\n      <Button\n        isDisabled={isDisabled}\n        onClick={() => {\n          Promise.resolve(dataProvider()).then((data) => {\n            if (!data) {\n              setNoDataModalOpen(true);\n              return;\n            }\n\n            validate(data);\n            setRemediationsData(data);\n          });\n        }}\n        {...buttonProps}\n      >\n        {children}\n      </Button>\n      <NoDataModal isOpen={isNoDataModalOpen} setOpen={setNoDataModalOpen} />\n      {remediationsData && (\n        <RemediationWizard\n          setOpen={(isOpen) =>\n            setRemediationsData((prevData) =>\n              isOpen === false ? null : prevData\n            )\n          }\n          data={{\n            onRemediationCreated,\n            ...(remediationsData || {}),\n          }}\n        />\n      )}\n    </React.Fragment>\n  );\n};\n\nRemediationButton.propTypes = {\n  isDisabled: propTypes.bool,\n  dataProvider: propTypes.func.isRequired,\n  onRemediationCreated: propTypes.func,\n  children: propTypes.node,\n  buttonProps: propTypes.shape({\n    [propTypes.string]: propTypes.any,\n  }),\n};\n\nRemediationButton.defaultProps = {\n  isDisabled: false,\n  onRemediationCreated: (f) => f,\n  children: 'Remediate with Ansible',\n};\n\nexport default RemediationButton;\n","import React from 'react';\nimport propTypes from 'prop-types';\nimport { Button, Modal, ModalVariant } from '@patternfly/react-core';\n\nexport const NoDataModal = ({ isOpen, setOpen }) => {\n  return (\n    <Modal\n      variant={ModalVariant.small}\n      title=\"Remediate with Ansible\"\n      isOpen={isOpen}\n      onClose={() => setOpen(false)}\n      actions={[\n        <Button key=\"confirm\" variant=\"primary\" onClick={() => setOpen(false)}>\n          Back to Insights\n        </Button>,\n      ]}\n    >\n      None of the selected issues can be remediated with Ansible.\n      <br />\n      <br />\n      To remediate these issues, review the manual remediation steps associated\n      with each.\n    </Modal>\n  );\n};\n\nNoDataModal.propTypes = {\n  isOpen: propTypes.bool,\n  setOpen: propTypes.func,\n};\n\nexport default NoDataModal;\n","function assert(test, msg) {\n  if (!test) {\n    throw new TypeError(msg);\n  }\n}\n\nfunction checkAllowedKeys(reference, ...keys) {\n  Object.keys(reference).forEach((key) =>\n    assert(\n      keys.includes(key),\n      `Unexpected key: ${key} Expected one of: ${keys}`\n    )\n  );\n}\n\nfunction checkRequiredKeys(reference, ...keys) {\n  keys.forEach((key) =>\n    assert(\n      Object.prototype.hasOwnProperty.call(reference, key),\n      `Required key missing: ${key}`\n    )\n  );\n}\n\nfunction checkSystems(systems) {\n  assert(Array.isArray(systems), 'Systems must be an array');\n  assert(systems.length, 'Systems array must not be empty');\n  systems.forEach((system) =>\n    assert(typeof system === 'string', 'System must be of type string')\n  );\n}\n\nexport default function validate(data) {\n  assert(typeof data === 'object' && data !== null);\n  checkAllowedKeys(data, 'issues', 'systems', 'onRemediationCreated');\n  checkRequiredKeys(data, 'issues');\n\n  assert(Array.isArray(data.issues), 'Issues must be an array');\n  assert(data.issues.length, 'Issues array must not be empty');\n  data.issues.forEach((issue) => {\n    assert(\n      typeof issue === 'object' && issue !== null,\n      'Issue must be an object'\n    );\n    checkAllowedKeys(issue, 'id', 'description', 'systems');\n    checkRequiredKeys(issue, 'id', 'description');\n    Object.prototype.hasOwnProperty.call(issue, 'systems') &&\n      checkSystems(issue.systems);\n    assert(\n      Object.prototype.hasOwnProperty.call(issue, 'systems') ||\n        Object.prototype.hasOwnProperty.call(data, 'systems'),\n      `No systems defined for ${issue.id}`\n    );\n  });\n\n  Object.prototype.hasOwnProperty.call(data, 'systems') &&\n    checkSystems(data.systems);\n}\n"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","selector","_a","state","useScalprum","chrome","api","initialized","RemediationButton","isDisabled","children","dataProvider","onRemediationCreated","buttonProps","useState","hasPermissions","setHasPermissions","remediationsData","setRemediationsData","isNoDataModalOpen","setNoDataModalOpen","useChrome","useEffect","getUserPermissions","then","permissions","some","permission","matchPermissions","CAN_REMEDIATE","Button","onClick","Promise","resolve","data","validate","isOpen","setOpen","prevData","Tooltip","content","propTypes","defaultProps","f","NoDataModal","Modal","variant","ModalVariant","title","onClose","actions","key","assert","test","msg","TypeError","checkAllowedKeys","reference","keys","forEach","includes","checkRequiredKeys","checkSystems","systems","Array","isArray","system","issues","issue","id"],"sourceRoot":""}