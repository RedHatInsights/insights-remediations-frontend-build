(self.webpackChunkremediations=self.webpackChunkremediations||[]).push([[4424],{84487:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>je});var s=a(10756),n=a.n(s),o=a(45697),l=a.n(o),i=a(33366);const r=new(a(68004).HostsApi)(void 0,"/api/inventory/v1",i.ZP);function c(e,{page:t,perPage:a}){return r.apiHostGetHostById(e,void 0,a,t)}var m=a(37468),d=a(33626),u=a(68718),p=a.n(u);const y=async e=>{try{const t=await d.mY(e.map((e=>e.id))),[a,s]=p()(t,(([e,t],a,s)=>(a?e.push(a):t.push(`Issue ${s} does not have Ansible support`),[e,t])),[[],[]]);return{resolutions:a,warnings:s}}catch(e){return{errors:["Error obtaining resolution information. Please try again later."]}}};var h=a(28216),g=a(57283),E=a.n(g),b=a(18546);const f={isLoading:!1,hosts:[]},v={[`${m.mg}_FULFILLED`]:(e,{payload:t})=>({...e,hosts:[...e.hosts,...t.results||[]],isLoading:!1}),[`${m.mg}_PENDING`]:e=>({...e,isLoading:!0})};var k=a(39133),S=a(24350),w=a.n(S),T=a(51912),R=a(67850),C=a(96354),I=a(64124),x=a(10621);const F=[{name:x.mT,component:"select-playbook",validate:[{type:I.Z.PATTERN,pattern:/^$|^.*[\w\d]+.*$/},{type:I.Z.REQUIRED}]},{name:x.yu,component:C.Z.TEXT_FIELD,hideField:!0},{name:x.m0,component:C.Z.TEXT_FIELD,hideField:!0},{name:x.Vf,component:C.Z.TEXT_FIELD,hideField:!0}],N=[{name:x.BA,component:"review-actions"}];var O=a(26854),A=a(28685),B=a(9820),$=a(11395),_=a(81169),P=a(48880),Z=a(32819),q=a(4252),z=a(20211),L=a.n(z),V=a(3428);const G=e=>{const{resolutionsCount:t}=e,{input:a}=(0,_.Z)(e);return a.valid=!1,n().createElement(q.EmptyState,{variant:q.EmptyStateVariant.sm,"data-component-ouia-id":"wizard-fetch-error"},n().createElement(q.EmptyStateHeader,{titleText:"Unexpected error",icon:n().createElement(q.EmptyStateIcon,{color:V.ZP.value,icon:L()}),headingLevel:"h4"}),n().createElement(q.EmptyStateBody,null,"Please try again later."," ",0!==t&&n().createElement("div",null,"Hint: No resolutions for selected issues.")))};G.propTypes={resolutionsCount:l().number};const D=G;var j=a(79194),W=a(39480),Y=a(14832),H=a(36028),U=a(95499),M=a(26438),X=a(40667),J=a(59671),Q=a(31593),K=a(13996),ee=a(29521),te=a.n(ee),ae=a(18446),se=a.n(ae);const ne=e=>{const{issues:t,systems:a,allSystems:o}=e,{input:l}=(0,_.Z)(e),i=(0,P.default)(),r=i.getState().values,[c,m]=(0,s.useState)(),[u,p]=(0,s.useState)(r[x.yu]),[y,g]=(0,s.useState)(r[x.yu]?"":l.value),[E,b]=(0,s.useState)(r[x.m0]),[f,v]=(0,s.useState)(!1),k=(0,h.useSelector)((({resolutionsReducer:e})=>e?.errors||[]),h.shallowEqual),S=(0,h.useSelector)((({resolutionsReducer:e})=>e?.warnings||[]),h.shallowEqual),w=(0,h.useSelector)((({resolutionsReducer:e})=>e?.resolutions||[]),h.shallowEqual),T=(0,h.useSelector)((({resolutionsReducer:e})=>e?.isLoading));return(0,s.useEffect)((()=>{!async function(){const{data:e}=await d.lK();m(e)}()}),[]),(0,s.useEffect)((()=>{te()(w,r[x.Vf],se())?.length>0&&(i.change(x.Vf,w),i.change(x.ko,(0,x.W3)(t,a,w)))})),k.length<=0?n().createElement(X.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-select-playbook"},n().createElement(X.StackItem,null,0!==S.length&&n().createElement(X.StackItem,null,n().createElement(K.Alert,{variant:"warning",isInline:!0,title:n().createElement(U.Text,null,"There ",(0,x._6)(S.length,"was","were")," ",n().createElement(J.Popover,{"aria-label":"Resolution error popover",bodyContent:n().createElement(s.Fragment,null,S.map(((e,t)=>n().createElement("div",{key:t},e))))},n().createElement("b",null,n().createElement(Q.Button,{variant:"link",isInline:!0},S.length)," ",(0,x._6)(S.length,"error")))," ","while fetching resolutions for your issues!"," ")})),n().createElement(U.TextContent,null,n().createElement(U.Text,null,"You selected"," ",n().createElement("b",null,`${o.length} ${(0,x._6)(o.length,"system")}`," "),"to remediate with Ansible, which in total includes"," ",n().createElement("b",null,`${t?.length} ${(0,x._6)(t?.length,"issue")}`," "),t?.length===w.length||T?"which":n().createElement(s.Fragment,null,"of which ",n().createElement("b",null,w.length," "))," ","can be remediated by Ansible."))),n().createElement(X.StackItem,null,n().createElement(W.Grid,{hasGutter:!0},n().createElement(W.GridItem,{sm:12,md:6,lg:4},n().createElement(Y.Radio,{label:c?`Add to existing playbook (${c.length})`:"Add to existing playbook","aria-label":"Add to existing playbook",id:"existing",name:"radio",isDisabled:!c||!c.length,defaultChecked:u,onChange:()=>{p(!0),i.change(x.yu,!0),l.onChange(E?.name||""),i.change(x.m0,E)}})),n().createElement(W.GridItem,{sm:12,md:6,lg:4},c&&!f?n().createElement(H.FormSelect,{onChange:(e,t)=>{v(!0),d.NH(t).then((e=>{b(e),v(!1),u&&l.onChange(e.name),u&&i.change(x.m0,e)}))},value:E?.id||"","aria-label":"Select an existing playbook"},c?.length?[n().createElement(H.FormSelectOption,{key:"select-playbook-placeholder","data-testid":"select-playbook-placeholder",value:"",label:"Select playbook",isDisabled:!0}),...c.map((({id:e,name:t})=>n().createElement(H.FormSelectOption,{key:e,value:e,label:t})))]:n().createElement(H.FormSelectOption,{key:"empty",value:"empty",label:"No existing playbooks"})):n().createElement(Z.Z,{size:Z.i.lg,"data-testid":"skeleton-loader"})))),n().createElement(X.StackItem,null,n().createElement(W.Grid,{hasGutter:!0},n().createElement(W.GridItem,{sm:12,md:6,lg:4},n().createElement(Y.Radio,{label:"Create new playbook","aria-label":"Create new playbook",id:"new",name:"radio",defaultChecked:!u,onChange:()=>{p(!1),i.change(x.yu,!1),l.onChange(y),i.change(x.m0,void 0)}})),n().createElement(W.GridItem,{sm:12,md:6,lg:4},n().createElement(j.FormGroup,{fieldId:"remediation-name"},n().createElement(M.TextInput,{type:"text",value:y,onChange:(e,t)=>{g(t),u||l.onChange(t)},"aria-label":"Name your playbook",autoFocus:!0})))))):n().createElement(D,null)};ne.propTypes={issues:l().arrayOf(l().shape({description:l().string,id:l().string})).isRequired,systems:l().arrayOf(l().string).isRequired,allSystems:l().arrayOf(l().string).isRequired};const oe=ne;var le=a(73399);const ie=({issues:e,systems:t,allSystems:a,registry:o,...l})=>{let i=(0,h.useDispatch)();const{input:r}=(0,_.Z)(l),c=(0,P.default)(),m=c.getState().errors?.systems,[d,u]=(0,s.useState)(null),p=(0,h.useSelector)((({entities:e})=>(e?.rows||[]).length)),y=(0,h.useSelector)((({entities:e})=>e?.selected||[])),g=(0,h.useSelector)((({entities:e})=>e?.rows?.filter((e=>e.system_profile?.bootc_status?.booted?.image)).map((e=>e.id))||[])),E=(0,h.useSelector)((({entities:e})=>e?.loaded)),b=(0,h.useSelector)((({hostReducer:{hosts:e}})=>e?.map((e=>({id:e.id,name:e.display_name})))||[]));(0,s.useEffect)((()=>{const a=y.some((e=>g.includes(e))),s=e?.some((e=>e?.id?.startsWith("advisor")));if(a&&!s)return u("Image mode systems cannot be added to a remediation playbook."),r.onChange({});u(null);const n=e?.reduce(((e,a)=>{const s=(0,x.Y4)([...t,...a.systems||[]]).filter((e=>y?.includes(e)));return{...e,...s.length>0?{[a.id]:s}:{}}}),{});se()(r.value,n)||r.onChange(n)}),[y]);const f=e=>{i({type:x.Zp,payload:e})};return n().createElement(X.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-review-systems","data-testid":"wizard-review-systems"},n().createElement(X.StackItem,null,n().createElement(U.TextContent,null,n().createElement(U.Text,null,"Review and optionally exclude systems from your selection."))),n().createElement(X.StackItem,null,n().createElement(le.Z,{registry:o,allSystemsNamed:b,allSystems:a,hasCheckbox:!0,bulkSelect:{id:"select-systems",count:y.length,items:[{title:"Select none (0)",onClick:()=>f(!1)},...E&&p>0?[{title:`Select page (${p})`,onClick:()=>f(!0)}]:[]],checked:y.length>0,onSelect:e=>f(e)},onSelectRows:!0})),(d||m)&&E&&n().createElement(X.StackItem,null,n().createElement(L(),{className:"ins-c-remediations-error pf-u-mr-sm"}),n().createElement("span",{className:"ins-c-remediations-error"},d||m)))};ie.propTypes={issues:l().arrayOf(l().shape({description:l().string,id:l().string})).isRequired,systems:l().arrayOf(l().string).isRequired,allSystems:l().arrayOf(l().string).isRequired,registry:l().instanceOf(b.ZP).isRequired};const re=ie;var ce=a(75863),me=a(7732),de=a(5756),ue=a(43416),pe=a(49004),ye=a(58027);const he=e=>{const t=(0,P.default)().getState().values,a=e.issues.filter((e=>Object.keys(t[x.vF]).includes(e.id))),{input:o}=(0,_.Z)(e),[l,i]=(0,s.useState)({index:void 0,direction:void 0}),r=(0,h.useSelector)((({hostReducer:{hosts:e}})=>e?.map((e=>({id:e.id,name:e.display_name})))||[])),c=(t[x.yu]?t[x.ko].filter((e=>!t[x.m0].issues.some((t=>t.id===e.id)))):t[x.ko]).map((e=>({...e,systems:t[x.vF][e.id]}))).filter((e=>e?.systems?.length>0)),[m,d]=(0,s.useState)((0,x.TE)(c,l,!0,r));return(0,s.useEffect)((()=>{d((0,x.TE)(c,l,!0,r))}),[l]),n().createElement(X.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-review-actions","data-testid":"wizard-review-actions"},n().createElement(X.StackItem,null,n().createElement(U.TextContent,null,n().createElement(U.Text,null,"You have selected"," ",n().createElement("b",null,`${a.length} ${(0,x._6)(a.length,"item")}`)," to remediate."," ",n().createElement("b",null,c.length," of"," ",`${a.length} ${(0,x._6)(a.length,"item")}`),1!==c.length?" allow":" allows"," for you to chose from multiple resolution steps."))),n().createElement(X.StackItem,null,n().createElement(Y.Radio,{label:`Review and/or change the resolution steps for ${1!==c.length?"these":"this"}\n                         ${c.length} ${(0,x._6)(c.length,"action")}.`,id:"change",name:"radio",isChecked:o.value,onChange:()=>o.onChange(!0)}),a.length-c.length>0&&n().createElement(U.Text,{className:"rem-c-choose-actions-description"},`The ${a.length-c.length} other selected ${(0,x._6)(a.length-c.length,"issue")} \n                    ${a.length-c.length!=1?"do":"does"} not have multiple resolution options.`)),n().createElement(ue.i,{"aria-label":"Actions",className:"ins-c-remediation-summary-table",variant:ce.B.compact,onCollapse:(e,t,a)=>(0,x.ar)(e,t,a,m,d),cells:[{title:"Action",transforms:[me.p]},{title:"Resolution",transforms:[me.p]},{title:"Reboot required",transforms:[me.p]},{title:"Systems",transforms:[me.p],cellFormatters:[de.zW]}],rows:m,onSort:(e,t,a)=>i({index:t,direction:a}),sortBy:l},n().createElement(pe.x,{noWrap:!0}),n().createElement(ye.R,null)),n().createElement(X.StackItem,null,n().createElement(Y.Radio,{label:"Accept all recommended resolution steps for all actions",id:"accept",name:"radio",isChecked:!o.value,onChange:()=>o.onChange(!1)}),n().createElement(U.Text,{className:"rem-c-choose-actions-description"},"You may modify reboot status to manual reboot in the next step, or from the playbook.")))};he.propTypes={issues:l().arrayOf(l().shape({description:l().string,id:l().string})).isRequired};const ge=he;var Ee=a(45997),be=a(13193),fe=a(45578),ve=a.n(fe);const ke=({issue:e})=>{const t=(0,P.default)(),a=t.getState().values[x.Vf],o=t.getState().values[x.vF][e.id]||[],l=a.find((t=>t.id===e.id))?.resolutions||[],i=ve()(l,"id"),r=te()(l,i,se());return n().createElement(X.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-issue-resolution"},n().createElement(X.StackItem,null,n().createElement(be.Title,{headingLevel:"h2"},`Choose action: ${(0,x.u9)(e.id)}`)),n().createElement(X.StackItem,null,r.length>0&&n().createElement(X.StackItem,{className:"pf-u-mb-sm"},n().createElement(K.Alert,{variant:"warning",isInline:!0,title:n().createElement(U.Text,null,"There ",(0,x._6)(r.length,"was","were")," ",n().createElement(J.Popover,{"aria-label":"Resolution duplicates popover",bodyContent:n().createElement(s.Fragment,null,r.map(((e,t)=>n().createElement("div",{key:t},e.description))))},n().createElement("b",null,n().createElement(Q.Button,{variant:"link",isInline:!0},r.length)," ",(0,x._6)(r.length,"resolution")))," ","removed due to duplication")})),n().createElement(U.TextContent,null,n().createElement(U.Text,null,"Review the possible resolution steps and select which to add to your playbook."),n().createElement(U.Text,{className:"ins-c-remediations-action-description"},e.action),n().createElement(U.Text,{className:"ins-c-remediations-action-description"},`Resolution affects ${o.length} ${(0,x._6)(o.length,"system")}`))),n().createElement(X.StackItem,null,n().createElement("div",{className:"ins-c-resolution-container"},i.map(((a,s)=>n().createElement("div",{className:"ins-c-resolution-option",key:a.id},n().createElement(Ee.Tile,{onClick:()=>t.change(x.Tx,{...t.getState().values[x.Tx],[e.id]:a.id}),isSelected:t.getState().values[x.Tx][e.id]?t.getState().values[x.Tx][e.id]===a.id:0===s,title:a.description},n().createElement(U.TextContent,{className:"pf-u-pt-sm"},n().createElement(U.Text,{className:"pf-u-mb-sm ins-c-playbook-description"},'Resolution from "',e.id.split(/:|\|/)[1],'"'),n().createElement("div",{className:"ins-c-reboot-required"},n().createElement(U.Text,{component:"span"},a.needs_reboot?"Reboot required":n().createElement("span",null,"Reboot ",n().createElement("b",null,"not")," required")))))))))))};ke.propTypes={issue:l().shape({id:l().string,action:l().string,alternate:l().number,systems:l().arrayOf(l().string)}).isRequired};const Se=ke;var we=a(29738),Te=a.n(we),Re=a(70358);const Ce=e=>{const t=(0,P.default)(),a=t.getState().values[x.m0],o=t.getState().values[x.yu],l=t.getState().values[x.vF],{data:i,issuesById:r}={...e,data:{...e.data,issues:e.data.issues.filter((e=>l[e.id]?.length>0))}},{input:c}=(0,_.Z)(e),[m,d]=(0,s.useState)({index:void 0,direction:void 0}),u=(0,h.useSelector)((({hostReducer:{hosts:e}})=>e?.map((e=>({id:e.id,name:e.display_name})))||[])),p=i.issues.map((e=>{const a=(0,x.uG)(e.id,t.getState().values),{description:s,needs_reboot:n}=a?.[0]||{};return{action:r[e.id].description,resolution:s,needsReboot:n,systems:l[e.id]}}));(0,s.useEffect)((()=>{c.onChange(""!==c.value?c.value:o&&a.auto_reboot||p.some((e=>e.needsReboot)))}),[]);const[y,g]=(0,s.useState)((0,x.TE)(p,m,!1,u));return(0,s.useEffect)((()=>{g((0,x.TE)(p,m,!1,u))}),[m]),n().createElement(X.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-review","data-testid":"wizard-review"},n().createElement(X.StackItem,null,n().createElement(U.TextContent,null,n().createElement(U.Text,null,"Issues listed below will be added to the playbook"," ",n().createElement("b",null,t.getState().values[x.mT]),"."))),p.some((e=>e.needsReboot))&&n().createElement(X.StackItem,null,n().createElement(U.TextContent,null,n().createElement(U.Text,{className:"ins-c-playbook-reboot-required"},n().createElement(Te(),null)," A system reboot is required to remediate selected issues"))),n().createElement(X.StackItem,null,n().createElement(U.TextContent,null,n().createElement(U.Text,null,"The playbook ",n().createElement("b",null,t.getState().values[x.mT]),c.value?" does":n().createElement("span",{className:"ins-c-remediation-danger-text"}," does not")," ","auto reboot systems."))),n().createElement(X.StackItem,null,n().createElement(Re.Switch,{"data-testid":"autoreboot-switch",label:"Turn off autoreboot",labelOff:"Turn on autoreboot",isChecked:c.value,onChange:()=>c.onChange(!c.value)})),n().createElement(ue.i,{"aria-label":"Actions",className:"ins-c-remediation-summary-table",variant:ce.B.compact,cells:[{title:"Action",transforms:[me.p]},{title:"Resolution",transforms:[me.p]},{title:"Reboot required",transforms:[me.p]},{title:"Systems",transforms:[me.p],cellFormatters:[de.zW]}],rows:y,onSort:(e,t,a)=>d({index:t,direction:a}),onCollapse:(e,t,a)=>(0,x.ar)(e,t,a,y,g),sortBy:m},n().createElement(pe.x,{noWrap:!0}),n().createElement(ye.R,null)))};Ce.propTypes={data:l().shape({issues:l().array,systems:l().array,onRemediationCreated:l().func}).isRequired,issuesById:l().shape({[l().string]:l().shape({id:l().string,description:l().string})}).isRequired};const Ie=Ce,xe={isLoading:!1,resolutions:void 0},Fe={[`${m.JY}_FULFILLED`]:(e,{payload:t})=>({...e,...t,isLoading:!1}),[`${m.JY}_PENDING`]:e=>({...e,isLoading:!0})};var Ne=a(48273);const Oe=({percent:e,failed:t})=>{let a,s;return 100===e?(s="Completed",a=Ne.ProgressVariant.success):t?(s="Error",a=Ne.ProgressVariant.danger):(s="In progress",a=Ne.ProgressVariant.info),n().createElement(Ne.Progress,{"data-testid":"finished-create-remediation",value:e,title:s,variant:a})};Oe.propTypes={percent:l().number,failed:l().bool};const Ae=Oe;var Be=a(44278),$e=a.n(Be),_e=a(40773),Pe=a.n(_e),Ze=a(37248),qe=a.n(Ze);const ze=({onClose:e,setOpen:t,submitRemediation:a,setState:s,state:o})=>{const{percent:l,failed:i,systems:r,issues:c,playbook:m}={percent:o.percent,failed:o.failed,systems:(0,x.Y4)(Object.values(o.formValues[x.vF]).flat()),issues:Object.keys(o.formValues[x.vF]),playbook:{name:o.formValues[x.mT],id:o.id}};return n().createElement(q.EmptyState,{variant:q.EmptyStateVariant.lg,"data-testid":"wizard-progress","data-component-ouia-id":"wizard-progress"},n().createElement(q.EmptyStateHeader,{titleText:n().createElement(n().Fragment,null,i?"Error: Unable to add items to playbook":100===l?"Items added to playbook":"Adding items to the playbook"),icon:n().createElement(q.EmptyStateIcon,{className:"pf-u-mb-lg pf-u-mt-sm",color:i?"var(--pf-global--danger-color--100)":100===l?"var(--pf-global--success-color--100)":void 0,icon:i?L():100===l?$e():qe()}),headingLevel:"h1"}),n().createElement(q.EmptyStateBody,{className:"pf-c-progress-bar pf-u-mt-md"},n().createElement(Ae,{percent:l,failed:i})),n().createElement(q.EmptyStateFooter,null,(i||100===l)&&n().createElement(q.EmptyStateBody,{className:"pf-c-progress-message"},i?"Please try again.":n().createElement("div",null,`${c.length} ${(0,x._6)(c.length,"action")} affecting \n                        ${r.length} ${(0,x._6)(r.length,"system")} \n                        ${c.length>1?"were":"was"} added to the playbook `,n().createElement("a",{href:(0,x.B3)(m.id)},m.name),".")),100===l&&n().createElement(q.EmptyStateBody,{className:"pf-c-progress-message-description pf-u-mb-md"},"You can remediate these systems directly from Insights by enabling",n().createElement(Q.Button,{className:"pf-u-py-0 pf-u-px-xs",variant:"link",ouiaId:"CloudConnectorButton",icon:n().createElement(Pe(),null),iconPosition:"right",size:"sm",onClick:()=>window.location.href=`${window.location.origin}/${(0,x.QU)()}settings/connector`},"Cloud Connector"),"on eligible systems."),i&&n().createElement(Q.Button,{className:"pf-u-mt-md pf-u-mb-sm",variant:"primary",ouiaId:"TryAgainButton","data-testid":"TryAgainButton",onClick:()=>{s({failed:!1,percent:0}),a(!1)}},"Try again"),100===l&&n().createElement(Q.Button,{className:"pf-u-mt-md pf-u-mb-sm",variant:"primary",ouiaId:"ReturnToAppButton",onClick:()=>{e(),t(!1)}},"Return to application"),n().createElement(q.EmptyStateActions,null,i&&n().createElement(Q.Button,{variant:"secondary",ouiaId:"BackToWizardButton","data-testid":"BackToWizardButton",onClick:()=>{e()}},"Go back to the wizard"),100===l&&n().createElement(Q.Button,{variant:"link",component:"a",ouiaId:"OpenPlaybookButton","data-testid":"OpenPlaybookButton",href:(0,x.B3)(m.id),onClick:()=>{e(),t(!1)}},"Open playbook ",m.name))))};ze.propTypes={onClose:l().func,setOpen:l().func,submitRemediation:l().func,setState:l().func,state:l().shape({id:l().string,percent:l().number.isRequired,failed:l().bool.isRequired,formValues:l().shape({[x.mT]:l().string,[x.vF]:l().objectOf(l().arrayOf(l().string))})})};const Le=ze,Ve={submitted:!1,id:void 0,percent:0,failed:!1,formValues:void 0},Ge=(e,t)=>{switch(t.type){case"schema":return{...e,schema:t.payload};case"state":return{...e,...t.payload};default:throw new Error}},De=({setOpen:e,data:t,basePath:a,registry:o})=>{const l=(0,s.useRef)((0,x.Y4)(t.issues?.reduce(((e,t)=>[...e,...t.systems||[]]),[...t.systems||[]]))),i=(0,h.useDispatch)(),[r,d]=(0,s.useReducer)(Ge,Ve),u=w()(t.issues,(e=>e.id));(0,s.useEffect)((()=>{var e;d({type:"schema",payload:(e=t.issues,{fields:[{component:C.Z.WIZARD,name:"remediations-wizard",isDynamic:!0,inModal:!0,showTitles:!0,title:"Remediate with Ansible",description:"Add actions to an Ansible Playbook",fields:[{name:"playbook",title:"Select playbook",fields:F,nextStep:"systems"},{name:"systems",title:"Review systems",fields:[{name:x.vF,component:"review-systems",validate:[{type:"validate-systems"}]}],nextStep:({values:e})=>(e=>(e[x.yu]?e[x.ko].filter((t=>!e[x.m0].issues.some((a=>a.id===t.id&&Object.keys(e[x.vF]).includes(t.id))))):e[x.ko].filter((t=>Object.keys(e[x.vF]).includes(t.id)))).length>0?"actions":"review")(e)},{name:"actions",title:"Review and edit actions",fields:N,nextStep:({values:e})=>(e=>{const t=e[x.yu]?e[x.ko].filter((t=>!e[x.m0].issues.some((e=>e.id===t.id))&&Object.keys(e[x.vF]).includes(t.id))):e[x.ko].filter((t=>Object.keys(e[x.vF]).includes(t.id)));return e[x.BA]?t[0]?.id:"review"})(e)},...e?.map((e=>({name:e.id,title:(0,x.u9)(e.id),showTitle:!1,fields:[{name:e.id,component:"issue-resolution",issue:e},{name:x.Tx,component:C.Z.TEXT_FIELD,hideField:!0}],nextStep:({values:t})=>((e,t)=>{const a=e[x.yu]?e[x.ko].filter((t=>!e[x.m0].issues.some((a=>a.id===t.id&&Object.keys(e[x.vF]).includes(t.id))))):e[x.ko].filter((t=>Object.keys(e[x.vF]).includes(t.id)));return a.slice(a.findIndex((e=>e.id===t.id))+1,a.length)[0]?.id||"review"})(t,e),substepOf:"Choose actions"})))||[],{name:"review",title:"Remediation review",fields:[{name:x.Ej,component:"review"}]}]}]})}),o.register({hostReducer:(0,k.applyReducerHash)(v,f),resolutionsReducer:(0,k.applyReducerHash)(Fe,xe)}),i(((e=[])=>({type:m.JY,payload:y(e)}))(t.issues)),((e=[])=>{(0,x.C1)(e,50).forEach((e=>{i(((e,t={})=>({type:m.mg,payload:c(e,t)}))(e,{page:1,perPage:50}))}))})(l.current)}),[]);const p={"select-playbook":{component:oe,issues:t.issues,systems:t.systems,allSystems:l.current},"review-systems":{component:re,issues:t.issues,systems:t.systems||[],allSystems:l.current,registry:o},"review-actions":{component:ge,issues:t.issues},"issue-resolution":{component:Se},review:{component:Ie,data:t,issuesById:u}},g={"validate-systems":()=>e=>e&&Object.values(e).filter((e=>void 0!==e)).length?void 0:"At least one system must be selected. Actions must be associated to a system to be added to a playbook."};return n().createElement(s.Fragment,null,r.schema&&!r.submitted?n().createElement(T.Z,{schema:r.schema,subscription:{values:!0},FormTemplate:e=>n().createElement(R.ZP,{...e,showFormControls:!1}),initialValues:{[x.Vf]:[],[x.ko]:[],[x.vF]:{},[x.BA]:!0,[x.Tx]:{},[x.yu]:!1},componentMapper:{[C.Z.WIZARD]:{component:O.Z,className:"remediations","data-ouia-component-id":"remediation-wizard"},[C.Z.TEXT_FIELD]:$.Z,...p},validatorMapper:g,onSubmit:e=>{d({type:"state",payload:{submitted:!0,formValues:e}}),(0,x.ec)(e,t,a,(e=>d({type:"state",payload:e})))},onCancel:()=>e(!1)}):null,r.submitted?n().createElement(A.Modal,{isOpen:!0,variant:A.ModalVariant.large,showClose:!1,className:"remediations",hasNoBodyWrapper:!0,"aria-describedby":"wiz-modal-description","aria-labelledby":"wiz-modal-title"},n().createElement(B.e,{className:"remediations",title:"Remediate with Ansible",description:"Add actions to an Ansible Playbook",steps:[{name:"progress",component:n().createElement(Le,{onClose:()=>{d({type:"state",payload:{submitted:!1,id:void 0,failed:!1,formValues:void 0}})},title:"Adding items to the playbook",setOpen:e,submitRemediation:()=>(0,x.ec)(r.formValues,t,a,(e=>d({type:"state",payload:e}))),setState:e=>d({type:"state",payload:e}),state:r}),isFinishedStep:!0}],onClose:()=>{d({type:"state",payload:{submitted:!1,id:void 0,failed:!1,formValues:void 0}}),e(!1)}})):null)};De.propTypes={setOpen:l().func.isRequired,data:l().shape({issues:l().arrayOf(l().shape({description:l().string,id:l().string})),systems:l().arrayOf(l().string),onRemediationCreated:l().func}).isRequired,basePath:l().string,registry:l().shape({register:l().func}).isRequired};const je=e=>{const[t,a]=(0,s.useState)();return(0,s.useEffect)((()=>{a((()=>new b.ZP({},[E()])))}),[]),t?.store?n().createElement(h.Provider,{store:t.store},n().createElement(De,{...e,registry:t})):null}},65088:()=>{}}]);
//# sourceMappingURL=../sourcemaps/4424.46a3a91fa779d8c2a819ea33a9e8efa5.js.map