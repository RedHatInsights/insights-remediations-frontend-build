(self.webpackChunkremediations=self.webpackChunkremediations||[]).push([[4424],{84487:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>je});var s=a(10756),n=a.n(s),l=a(45697),i=a.n(l),o=a(33366);const r=new(a(68004).HostsApi)(void 0,"/api/inventory/v1",o.ZP);function c(e,{page:t,perPage:a}){return r.apiHostGetHostById(e,void 0,a,t)}var m=a(37468),d=a(33626),u=a(68718),p=a.n(u);const y=async e=>{try{const t=await d.mY(e.map((e=>e.id))),[a,s]=p()(t,(([e,t],a,s)=>(a?e.push(a):t.push(`Issue ${s} does not have Ansible support`),[e,t])),[[],[]]);return{resolutions:a,warnings:s}}catch(e){return{errors:["Error obtaining resolution information. Please try again later."]}}};var h=a(28216),g=a(57283),E=a.n(g),f=a(18546);const b={isLoading:!1,hosts:[]},v={[`${m.mg}_FULFILLED`]:(e,{payload:t})=>({...e,hosts:[...e.hosts,...t.results||[]],isLoading:!1}),[`${m.mg}_PENDING`]:e=>({...e,isLoading:!0})};var k=a(39133),S=a(24350),w=a.n(S),T=a(51912),R=a(67850),C=a(96354),x=a(64124),I=a(10621);const F=[{name:I.mT,component:"select-playbook",validate:[{type:x.Z.PATTERN,pattern:/^$|^.*[\w\d]+.*$/},{type:x.Z.REQUIRED}]},{name:I.yu,component:C.Z.TEXT_FIELD,hideField:!0},{name:I.m0,component:C.Z.TEXT_FIELD,hideField:!0},{name:I.Vf,component:C.Z.TEXT_FIELD,hideField:!0}],N=[{name:I.BA,component:"review-actions"}];var O=a(26854),A=a(28685),B=a(9820),$=a(11395),_=a(81169),P=a(48880),Z=a(32819),q=a(4252),z=a(20211),L=a.n(z),V=a(3428);const G=e=>{const{resolutionsCount:t}=e,{input:a}=(0,_.Z)(e);return a.valid=!1,n().createElement(q.EmptyState,{variant:q.EmptyStateVariant.sm,"data-component-ouia-id":"wizard-fetch-error"},n().createElement(q.EmptyStateHeader,{titleText:"Unexpected error",icon:n().createElement(q.EmptyStateIcon,{color:V.ZP.value,icon:L()}),headingLevel:"h4"}),n().createElement(q.EmptyStateBody,null,"Please try again later."," ",0!==t&&n().createElement("div",null,"Hint: No resolutions for selected issues.")))};G.propTypes={resolutionsCount:i().number};const D=G;var j=a(79194),Y=a(39480),W=a(14832),H=a(36028),U=a(95499),M=a(26438),X=a(40667),J=a(59671),Q=a(31593),K=a(13996),ee=a(29521),te=a.n(ee),ae=a(18446),se=a.n(ae);const ne=e=>{const{issues:t,systems:a,allSystems:l}=e,{input:i}=(0,_.Z)(e),o=(0,P.default)(),r=o.getState().values,[c,m]=(0,s.useState)(),[u,p]=(0,s.useState)(r[I.yu]),[y,g]=(0,s.useState)(r[I.yu]?"":i.value),[E,f]=(0,s.useState)(r[I.m0]),[b,v]=(0,s.useState)(!1),k=(0,h.useSelector)((({resolutionsReducer:e})=>e?.errors||[]),h.shallowEqual),S=(0,h.useSelector)((({resolutionsReducer:e})=>e?.warnings||[]),h.shallowEqual),w=(0,h.useSelector)((({resolutionsReducer:e})=>e?.resolutions||[]),h.shallowEqual),T=(0,h.useSelector)((({resolutionsReducer:e})=>e?.isLoading));return(0,s.useEffect)((()=>{!async function(){const{data:e}=await d.lK();m(e)}()}),[]),(0,s.useEffect)((()=>{te()(w,r[I.Vf],se())?.length>0&&(o.change(I.Vf,w),o.change(I.ko,(0,I.W3)(t,a,w)))})),k.length<=0?n().createElement(X.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-select-playbook"},n().createElement(X.StackItem,null,0!==S.length&&n().createElement(X.StackItem,null,n().createElement(K.Alert,{variant:"warning",isInline:!0,title:n().createElement(U.Text,null,"There ",(0,I._6)(S.length,"was","were")," ",n().createElement(J.Popover,{"aria-label":"Resolution error popover",bodyContent:n().createElement(s.Fragment,null,S.map(((e,t)=>n().createElement("div",{key:t},e))))},n().createElement("b",null,n().createElement(Q.Button,{variant:"link",isInline:!0},S.length)," ",(0,I._6)(S.length,"error")))," ","while fetching resolutions for your issues!"," ")})),n().createElement(U.TextContent,null,n().createElement(U.Text,null,"You selected"," ",n().createElement("b",null,`${l.length} ${(0,I._6)(l.length,"system")}`," "),"to remediate with Ansible, which in total includes"," ",n().createElement("b",null,`${t?.length} ${(0,I._6)(t?.length,"issue")}`," "),t?.length===w.length||T?"which":n().createElement(s.Fragment,null,"of which ",n().createElement("b",null,w.length," "))," ","can be remediated by Ansible."))),n().createElement(X.StackItem,null,n().createElement(Y.Grid,{hasGutter:!0},n().createElement(Y.GridItem,{sm:12,md:6,lg:4},n().createElement(W.Radio,{label:c?`Add to existing playbook (${c.length})`:"Add to existing playbook","aria-label":"Add to existing playbook",id:"existing",name:"radio",isDisabled:!c||!c.length,defaultChecked:u,onChange:()=>{p(!0),o.change(I.yu,!0),i.onChange(E?.name||""),o.change(I.m0,E)}})),n().createElement(Y.GridItem,{sm:12,md:6,lg:4},c&&!b?n().createElement(H.FormSelect,{onChange:(e,t)=>{v(!0),d.NH(t).then((e=>{f(e),v(!1),u&&i.onChange(e.name),u&&o.change(I.m0,e)}))},value:E?.id||"","aria-label":"Select an existing playbook"},c?.length?[n().createElement(H.FormSelectOption,{key:"select-playbook-placeholder","data-testid":"select-playbook-placeholder",value:"",label:"Select playbook",isDisabled:!0}),...c.map((({id:e,name:t})=>n().createElement(H.FormSelectOption,{key:e,value:e,label:t})))]:n().createElement(H.FormSelectOption,{key:"empty",value:"empty",label:"No existing playbooks"})):n().createElement(Z.Z,{size:Z.i.lg,"data-testid":"skeleton-loader"})))),n().createElement(X.StackItem,null,n().createElement(Y.Grid,{hasGutter:!0},n().createElement(Y.GridItem,{sm:12,md:6,lg:4},n().createElement(W.Radio,{label:"Create new playbook","aria-label":"Create new playbook",id:"new",name:"radio",defaultChecked:!u,onChange:()=>{p(!1),o.change(I.yu,!1),i.onChange(y),o.change(I.m0,void 0)}})),n().createElement(Y.GridItem,{sm:12,md:6,lg:4},n().createElement(j.FormGroup,{fieldId:"remediation-name"},n().createElement(M.TextInput,{type:"text",value:y,onChange:(e,t)=>{g(t),u||i.onChange(t)},"aria-label":"Name your playbook",autoFocus:!0})))))):n().createElement(D,null)};ne.propTypes={issues:i().arrayOf(i().shape({description:i().string,id:i().string})).isRequired,systems:i().arrayOf(i().string).isRequired,allSystems:i().arrayOf(i().string).isRequired};const le=ne;var ie=a(73399);const oe=({issues:e,systems:t,allSystems:a,registry:l,...i})=>{let o=(0,h.useDispatch)();const{input:r}=(0,_.Z)(i),c=(0,P.default)(),m=c.getState().errors?.systems,d=(0,h.useSelector)((({entities:e})=>(e?.rows||[]).length)),u=(0,h.useSelector)((({entities:e})=>e?.selected||[])),p=(0,h.useSelector)((({entities:e})=>e?.loaded)),y=(0,h.useSelector)((({hostReducer:{hosts:e}})=>e?.map((e=>({id:e.id,name:e.display_name})))||[]));(0,s.useEffect)((()=>{const a=e?.reduce(((e,a)=>{const s=(0,I.Y4)([...t,...a.systems||[]]).filter((e=>u?.includes(e)));return{...e,...s.length>0?{[a.id]:s}:{}}}),{});se()(r.value,a)||r.onChange(a)}),[u]);const g=e=>{o({type:I.Zp,payload:e})};return n().createElement(X.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-review-systems","data-testid":"wizard-review-systems"},n().createElement(X.StackItem,null,n().createElement(U.TextContent,null,n().createElement(U.Text,null,"Review and optionally exclude systems from your selection."))),n().createElement(X.StackItem,null,n().createElement(ie.Z,{registry:l,allSystemsNamed:y,allSystems:a,hasCheckbox:!0,bulkSelect:{id:"select-systems",count:u.length,items:[{title:"Select none (0)",onClick:()=>g(!1)},...p&&d>0?[{title:`Select page (${d})`,onClick:()=>g(!0)}]:[]],checked:u.length>0,onSelect:e=>g(e)},onSelectRows:!0})),m&&p&&n().createElement(X.StackItem,null,n().createElement(L(),{className:"ins-c-remediations-error pf-u-mr-sm"}),n().createElement("span",{className:"ins-c-remediations-error"},m)))};oe.propTypes={issues:i().arrayOf(i().shape({description:i().string,id:i().string})).isRequired,systems:i().arrayOf(i().string).isRequired,allSystems:i().arrayOf(i().string).isRequired,registry:i().instanceOf(f.ZP).isRequired};const re=oe;var ce=a(75863),me=a(7732),de=a(5756),ue=a(43416),pe=a(49004),ye=a(58027);const he=e=>{const t=(0,P.default)().getState().values,a=e.issues.filter((e=>Object.keys(t[I.vF]).includes(e.id))),{input:l}=(0,_.Z)(e),[i,o]=(0,s.useState)({index:void 0,direction:void 0}),r=(0,h.useSelector)((({hostReducer:{hosts:e}})=>e?.map((e=>({id:e.id,name:e.display_name})))||[])),c=(t[I.yu]?t[I.ko].filter((e=>!t[I.m0].issues.some((t=>t.id===e.id)))):t[I.ko]).map((e=>({...e,systems:t[I.vF][e.id]}))).filter((e=>e?.systems?.length>0)),[m,d]=(0,s.useState)((0,I.TE)(c,i,!0,r));return(0,s.useEffect)((()=>{d((0,I.TE)(c,i,!0,r))}),[i]),n().createElement(X.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-review-actions","data-testid":"wizard-review-actions"},n().createElement(X.StackItem,null,n().createElement(U.TextContent,null,n().createElement(U.Text,null,"You have selected"," ",n().createElement("b",null,`${a.length} ${(0,I._6)(a.length,"item")}`)," to remediate."," ",n().createElement("b",null,c.length," of"," ",`${a.length} ${(0,I._6)(a.length,"item")}`),1!==c.length?" allow":" allows"," for you to chose from multiple resolution steps."))),n().createElement(X.StackItem,null,n().createElement(W.Radio,{label:`Review and/or change the resolution steps for ${1!==c.length?"these":"this"}\n                         ${c.length} ${(0,I._6)(c.length,"action")}.`,id:"change",name:"radio",isChecked:l.value,onChange:()=>l.onChange(!0)}),a.length-c.length>0&&n().createElement(U.Text,{className:"rem-c-choose-actions-description"},`The ${a.length-c.length} other selected ${(0,I._6)(a.length-c.length,"issue")} \n                    ${a.length-c.length!=1?"do":"does"} not have multiple resolution options.`)),n().createElement(ue.i,{"aria-label":"Actions",className:"ins-c-remediation-summary-table",variant:ce.B.compact,onCollapse:(e,t,a)=>(0,I.ar)(e,t,a,m,d),cells:[{title:"Action",transforms:[me.p]},{title:"Resolution",transforms:[me.p]},{title:"Reboot required",transforms:[me.p]},{title:"Systems",transforms:[me.p],cellFormatters:[de.zW]}],rows:m,onSort:(e,t,a)=>o({index:t,direction:a}),sortBy:i},n().createElement(pe.x,{noWrap:!0}),n().createElement(ye.R,null)),n().createElement(X.StackItem,null,n().createElement(W.Radio,{label:"Accept all recommended resolution steps for all actions",id:"accept",name:"radio",isChecked:!l.value,onChange:()=>l.onChange(!1)}),n().createElement(U.Text,{className:"rem-c-choose-actions-description"},"You may modify reboot status to manual reboot in the next step, or from the playbook.")))};he.propTypes={issues:i().arrayOf(i().shape({description:i().string,id:i().string})).isRequired};const ge=he;var Ee=a(45997),fe=a(13193),be=a(45578),ve=a.n(be);const ke=({issue:e})=>{const t=(0,P.default)(),a=t.getState().values[I.Vf],l=t.getState().values[I.vF][e.id]||[],i=a.find((t=>t.id===e.id))?.resolutions||[],o=ve()(i,"id"),r=te()(i,o,se());return n().createElement(X.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-issue-resolution"},n().createElement(X.StackItem,null,n().createElement(fe.Title,{headingLevel:"h2"},`Choose action: ${(0,I.u9)(e.id)}`)),n().createElement(X.StackItem,null,r.length>0&&n().createElement(X.StackItem,{className:"pf-u-mb-sm"},n().createElement(K.Alert,{variant:"warning",isInline:!0,title:n().createElement(U.Text,null,"There ",(0,I._6)(r.length,"was","were")," ",n().createElement(J.Popover,{"aria-label":"Resolution duplicates popover",bodyContent:n().createElement(s.Fragment,null,r.map(((e,t)=>n().createElement("div",{key:t},e.description))))},n().createElement("b",null,n().createElement(Q.Button,{variant:"link",isInline:!0},r.length)," ",(0,I._6)(r.length,"resolution")))," ","removed due to duplication")})),n().createElement(U.TextContent,null,n().createElement(U.Text,null,"Review the possible resolution steps and select which to add to your playbook."),n().createElement(U.Text,{className:"ins-c-remediations-action-description"},e.action),n().createElement(U.Text,{className:"ins-c-remediations-action-description"},`Resolution affects ${l.length} ${(0,I._6)(l.length,"system")}`))),n().createElement(X.StackItem,null,n().createElement("div",{className:"ins-c-resolution-container"},o.map(((a,s)=>n().createElement("div",{className:"ins-c-resolution-option",key:a.id},n().createElement(Ee.Tile,{onClick:()=>t.change(I.Tx,{...t.getState().values[I.Tx],[e.id]:a.id}),isSelected:t.getState().values[I.Tx][e.id]?t.getState().values[I.Tx][e.id]===a.id:0===s,title:a.description},n().createElement(U.TextContent,{className:"pf-u-pt-sm"},n().createElement(U.Text,{className:"pf-u-mb-sm ins-c-playbook-description"},'Resolution from "',e.id.split(/:|\|/)[1],'"'),n().createElement("div",{className:"ins-c-reboot-required"},n().createElement(U.Text,{component:"span"},a.needs_reboot?"Reboot required":n().createElement("span",null,"Reboot ",n().createElement("b",null,"not")," required")))))))))))};ke.propTypes={issue:i().shape({id:i().string,action:i().string,alternate:i().number,systems:i().arrayOf(i().string)}).isRequired};const Se=ke;var we=a(29738),Te=a.n(we),Re=a(70358);const Ce=e=>{const t=(0,P.default)(),a=t.getState().values[I.m0],l=t.getState().values[I.yu],i=t.getState().values[I.vF],{data:o,issuesById:r}={...e,data:{...e.data,issues:e.data.issues.filter((e=>i[e.id]?.length>0))}},{input:c}=(0,_.Z)(e),[m,d]=(0,s.useState)({index:void 0,direction:void 0}),u=(0,h.useSelector)((({hostReducer:{hosts:e}})=>e?.map((e=>({id:e.id,name:e.display_name})))||[])),p=o.issues.map((e=>{const a=(0,I.uG)(e.id,t.getState().values),{description:s,needs_reboot:n}=a?.[0]||{};return{action:r[e.id].description,resolution:s,needsReboot:n,systems:i[e.id]}}));(0,s.useEffect)((()=>{c.onChange(""!==c.value?c.value:l&&a.auto_reboot||p.some((e=>e.needsReboot)))}),[]);const[y,g]=(0,s.useState)((0,I.TE)(p,m,!1,u));return(0,s.useEffect)((()=>{g((0,I.TE)(p,m,!1,u))}),[m]),n().createElement(X.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-review","data-testid":"wizard-review"},n().createElement(X.StackItem,null,n().createElement(U.TextContent,null,n().createElement(U.Text,null,"Issues listed below will be added to the playbook"," ",n().createElement("b",null,t.getState().values[I.mT]),"."))),p.some((e=>e.needsReboot))&&n().createElement(X.StackItem,null,n().createElement(U.TextContent,null,n().createElement(U.Text,{className:"ins-c-playbook-reboot-required"},n().createElement(Te(),null)," A system reboot is required to remediate selected issues"))),n().createElement(X.StackItem,null,n().createElement(U.TextContent,null,n().createElement(U.Text,null,"The playbook ",n().createElement("b",null,t.getState().values[I.mT]),c.value?" does":n().createElement("span",{className:"ins-c-remediation-danger-text"}," does not")," ","auto reboot systems."))),n().createElement(X.StackItem,null,n().createElement(Re.Switch,{"data-testid":"autoreboot-switch",label:"Turn off autoreboot",labelOff:"Turn on autoreboot",isChecked:c.value,onChange:()=>c.onChange(!c.value)})),n().createElement(ue.i,{"aria-label":"Actions",className:"ins-c-remediation-summary-table",variant:ce.B.compact,cells:[{title:"Action",transforms:[me.p]},{title:"Resolution",transforms:[me.p]},{title:"Reboot required",transforms:[me.p]},{title:"Systems",transforms:[me.p],cellFormatters:[de.zW]}],rows:y,onSort:(e,t,a)=>d({index:t,direction:a}),onCollapse:(e,t,a)=>(0,I.ar)(e,t,a,y,g),sortBy:m},n().createElement(pe.x,{noWrap:!0}),n().createElement(ye.R,null)))};Ce.propTypes={data:i().shape({issues:i().array,systems:i().array,onRemediationCreated:i().func}).isRequired,issuesById:i().shape({[i().string]:i().shape({id:i().string,description:i().string})}).isRequired};const xe=Ce,Ie={isLoading:!1,resolutions:void 0},Fe={[`${m.JY}_FULFILLED`]:(e,{payload:t})=>({...e,...t,isLoading:!1}),[`${m.JY}_PENDING`]:e=>({...e,isLoading:!0})};var Ne=a(48273);const Oe=({percent:e,failed:t})=>{let a,s;return 100===e?(s="Completed",a=Ne.ProgressVariant.success):t?(s="Error",a=Ne.ProgressVariant.danger):(s="In progress",a=Ne.ProgressVariant.info),n().createElement(Ne.Progress,{"data-testid":"finished-create-remediation",value:e,title:s,variant:a})};Oe.propTypes={percent:i().number,failed:i().bool};const Ae=Oe;var Be=a(44278),$e=a.n(Be),_e=a(40773),Pe=a.n(_e),Ze=a(37248),qe=a.n(Ze);const ze=({onClose:e,setOpen:t,submitRemediation:a,setState:s,state:l})=>{const{percent:i,failed:o,systems:r,issues:c,playbook:m}={percent:l.percent,failed:l.failed,systems:(0,I.Y4)(Object.values(l.formValues[I.vF]).flat()),issues:Object.keys(l.formValues[I.vF]),playbook:{name:l.formValues[I.mT],id:l.id}};return n().createElement(q.EmptyState,{variant:q.EmptyStateVariant.lg,"data-testid":"wizard-progress","data-component-ouia-id":"wizard-progress"},n().createElement(q.EmptyStateHeader,{titleText:n().createElement(n().Fragment,null,o?"Error: Unable to add items to playbook":100===i?"Items added to playbook":"Adding items to the playbook"),icon:n().createElement(q.EmptyStateIcon,{className:"pf-u-mb-lg pf-u-mt-sm",color:o?"var(--pf-global--danger-color--100)":100===i?"var(--pf-global--success-color--100)":void 0,icon:o?L():100===i?$e():qe()}),headingLevel:"h1"}),n().createElement(q.EmptyStateBody,{className:"pf-c-progress-bar pf-u-mt-md"},n().createElement(Ae,{percent:i,failed:o})),n().createElement(q.EmptyStateFooter,null,(o||100===i)&&n().createElement(q.EmptyStateBody,{className:"pf-c-progress-message"},o?"Please try again.":n().createElement("div",null,`${c.length} ${(0,I._6)(c.length,"action")} affecting \n                        ${r.length} ${(0,I._6)(r.length,"system")} \n                        ${c.length>1?"were":"was"} added to the playbook `,n().createElement("a",{href:(0,I.B3)(m.id)},m.name),".")),100===i&&n().createElement(q.EmptyStateBody,{className:"pf-c-progress-message-description pf-u-mb-md"},"You can remediate these systems directly from Insights by enabling",n().createElement(Q.Button,{className:"pf-u-py-0 pf-u-px-xs",variant:"link",ouiaId:"CloudConnectorButton",icon:n().createElement(Pe(),null),iconPosition:"right",size:"sm",onClick:()=>window.location.href=`${window.location.origin}/${(0,I.QU)()}settings/connector`},"Cloud Connector"),"on eligible systems."),o&&n().createElement(Q.Button,{className:"pf-u-mt-md pf-u-mb-sm",variant:"primary",ouiaId:"TryAgainButton","data-testid":"TryAgainButton",onClick:()=>{s({failed:!1,percent:0}),a(!1)}},"Try again"),100===i&&n().createElement(Q.Button,{className:"pf-u-mt-md pf-u-mb-sm",variant:"primary",ouiaId:"ReturnToAppButton",onClick:()=>{e(),t(!1)}},"Return to application"),n().createElement(q.EmptyStateActions,null,o&&n().createElement(Q.Button,{variant:"secondary",ouiaId:"BackToWizardButton","data-testid":"BackToWizardButton",onClick:()=>{e()}},"Go back to the wizard"),100===i&&n().createElement(Q.Button,{variant:"link",component:"a",ouiaId:"OpenPlaybookButton","data-testid":"OpenPlaybookButton",href:(0,I.B3)(m.id),onClick:()=>{e(),t(!1)}},"Open playbook ",m.name))))};ze.propTypes={onClose:i().func,setOpen:i().func,submitRemediation:i().func,setState:i().func,state:i().shape({id:i().string,percent:i().number.isRequired,failed:i().bool.isRequired,formValues:i().shape({[I.mT]:i().string,[I.vF]:i().objectOf(i().arrayOf(i().string))})})};const Le=ze,Ve={submitted:!1,id:void 0,percent:0,failed:!1,formValues:void 0},Ge=(e,t)=>{switch(t.type){case"schema":return{...e,schema:t.payload};case"state":return{...e,...t.payload};default:throw new Error}},De=({setOpen:e,data:t,basePath:a,registry:l})=>{const i=(0,s.useRef)((0,I.Y4)(t.issues?.reduce(((e,t)=>[...e,...t.systems||[]]),[...t.systems||[]]))),o=(0,h.useDispatch)(),[r,d]=(0,s.useReducer)(Ge,Ve),u=w()(t.issues,(e=>e.id));(0,s.useEffect)((()=>{var e;d({type:"schema",payload:(e=t.issues,{fields:[{component:C.Z.WIZARD,name:"remediations-wizard",isDynamic:!0,inModal:!0,showTitles:!0,title:"Remediate with Ansible",description:"Add actions to an Ansible Playbook",fields:[{name:"playbook",title:"Select playbook",fields:F,nextStep:"systems"},{name:"systems",title:"Review systems",fields:[{name:I.vF,component:"review-systems",validate:[{type:"validate-systems"}]}],nextStep:({values:e})=>(e=>(e[I.yu]?e[I.ko].filter((t=>!e[I.m0].issues.some((a=>a.id===t.id&&Object.keys(e[I.vF]).includes(t.id))))):e[I.ko].filter((t=>Object.keys(e[I.vF]).includes(t.id)))).length>0?"actions":"review")(e)},{name:"actions",title:"Review and edit actions",fields:N,nextStep:({values:e})=>(e=>{const t=e[I.yu]?e[I.ko].filter((t=>!e[I.m0].issues.some((e=>e.id===t.id))&&Object.keys(e[I.vF]).includes(t.id))):e[I.ko].filter((t=>Object.keys(e[I.vF]).includes(t.id)));return e[I.BA]?t[0]?.id:"review"})(e)},...e?.map((e=>({name:e.id,title:(0,I.u9)(e.id),showTitle:!1,fields:[{name:e.id,component:"issue-resolution",issue:e},{name:I.Tx,component:C.Z.TEXT_FIELD,hideField:!0}],nextStep:({values:t})=>((e,t)=>{const a=e[I.yu]?e[I.ko].filter((t=>!e[I.m0].issues.some((a=>a.id===t.id&&Object.keys(e[I.vF]).includes(t.id))))):e[I.ko].filter((t=>Object.keys(e[I.vF]).includes(t.id)));return a.slice(a.findIndex((e=>e.id===t.id))+1,a.length)[0]?.id||"review"})(t,e),substepOf:"Choose actions"})))||[],{name:"review",title:"Remediation review",fields:[{name:I.Ej,component:"review"}]}]}]})}),l.register({hostReducer:(0,k.applyReducerHash)(v,b),resolutionsReducer:(0,k.applyReducerHash)(Fe,Ie)}),o(((e=[])=>({type:m.JY,payload:y(e)}))(t.issues)),((e=[])=>{(0,I.C1)(e,50).forEach((e=>{o(((e,t={})=>({type:m.mg,payload:c(e,t)}))(e,{page:1,perPage:50}))}))})(i.current)}),[]);const p={"select-playbook":{component:le,issues:t.issues,systems:t.systems,allSystems:i.current},"review-systems":{component:re,issues:t.issues,systems:t.systems||[],allSystems:i.current,registry:l},"review-actions":{component:ge,issues:t.issues},"issue-resolution":{component:Se},review:{component:xe,data:t,issuesById:u}},g={"validate-systems":()=>e=>e&&Object.values(e).filter((e=>void 0!==e)).length?void 0:"At least one system must be selected. Actions must be associated to a system to be added to a playbook."};return n().createElement(s.Fragment,null,r.schema&&!r.submitted?n().createElement(T.Z,{schema:r.schema,subscription:{values:!0},FormTemplate:e=>n().createElement(R.ZP,{...e,showFormControls:!1}),initialValues:{[I.Vf]:[],[I.ko]:[],[I.vF]:{},[I.BA]:!0,[I.Tx]:{},[I.yu]:!1},componentMapper:{[C.Z.WIZARD]:{component:O.Z,className:"remediations","data-ouia-component-id":"remediation-wizard"},[C.Z.TEXT_FIELD]:$.Z,...p},validatorMapper:g,onSubmit:e=>{d({type:"state",payload:{submitted:!0,formValues:e}}),(0,I.ec)(e,t,a,(e=>d({type:"state",payload:e})))},onCancel:()=>e(!1)}):null,r.submitted?n().createElement(A.Modal,{isOpen:!0,variant:A.ModalVariant.large,showClose:!1,className:"remediations",hasNoBodyWrapper:!0,"aria-describedby":"wiz-modal-description","aria-labelledby":"wiz-modal-title"},n().createElement(B.e,{className:"remediations",title:"Remediate with Ansible",description:"Add actions to an Ansible Playbook",steps:[{name:"progress",component:n().createElement(Le,{onClose:()=>{d({type:"state",payload:{submitted:!1,id:void 0,failed:!1,formValues:void 0}})},title:"Adding items to the playbook",setOpen:e,submitRemediation:()=>(0,I.ec)(r.formValues,t,a,(e=>d({type:"state",payload:e}))),setState:e=>d({type:"state",payload:e}),state:r}),isFinishedStep:!0}],onClose:()=>{d({type:"state",payload:{submitted:!1,id:void 0,failed:!1,formValues:void 0}}),e(!1)}})):null)};De.propTypes={setOpen:i().func.isRequired,data:i().shape({issues:i().arrayOf(i().shape({description:i().string,id:i().string})),systems:i().arrayOf(i().string),onRemediationCreated:i().func}).isRequired,basePath:i().string,registry:i().shape({register:i().func}).isRequired};const je=e=>{const[t,a]=(0,s.useState)();return(0,s.useEffect)((()=>{a((()=>new f.ZP({},[E()])))}),[]),t?.store?n().createElement(h.Provider,{store:t.store},n().createElement(De,{...e,registry:t})):null}},65088:()=>{}}]);
//# sourceMappingURL=../sourcemaps/4424.57e696cd8f7b0b64f630fd3e82012d74.js.map