"use strict";(self.webpackChunkremediations=self.webpackChunkremediations||[]).push([[1390],{77832:(e,t,n)=>{function a(e){return e.split(":")[0]}function l({id:e}){switch(a(e)){case"advisor":return"Advisor";case"ssg":return"Compliance";case"vulnerabilities":return"Vulnerability";case"patch-advisory":return"Patch";default:return"Unknown"}}function s({display_name:e,hostname:t,id:n}){return e||t||n}function i(e,t){return e.toLowerCase().includes(t.toLowerCase())}n.d(t,{PW:()=>i,Pz:()=>a,_f:()=>s,lN:()=>l})},18293:(e,t,n)=>{n.d(t,{Gd:()=>o,T:()=>i,Tj:()=>r});var a=n(54998),l=n.n(a),s=n(77832);function i(e){const t=function({id:e}){switch((0,s.Pz)(e)){case"advisor":return"advisor";case"vulnerabilities":return"vulnerabilities";case"ssg":return"compliance";case"patch-advisory":return"patch";default:return"general_information"}}(e),n=o("inventory").toString();return e=>`${n}/${e}?appName=${t}`}function r(e){const t=e.split(":");switch(t[0]){case"advisor":return o(t[0]).segment("recommendations").segment(t[1]).toString();case"vulnerabilities":return o(t[0]).segment("cves").segment(t[1]).toString();case"patch-advisory":return o(t[0]).segment("advisories").segment(t[1]+":"+t[2]).toString();default:return null}}function o(e){switch(e){case"advisor":return l()(document.baseURI).segment("insights").segment("advisor");case"vulnerabilities":return l()(document.baseURI).segment("insights").segment("vulnerability");case"compliance":case"ssg":return l()(document.baseURI).segment("insights").segment("compliance");case"inventory":return l()(document.baseURI).segment(function(){const e=window.location.pathname.split("/");return"preview"===e[1]?e[2]:e[1]}()).segment("inventory");case"patch-advisory":return l()(document.baseURI).segment("insights").segment("patch");default:throw new Error(`Unknown app: ${e}`)}}},76400:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(10756),l=n.n(a),s=n(45697),i=n.n(s),r=n(93967),o=n.n(r);const c=({title:e,className:t,children:n,isBold:a,hasGutter:s,needsPointer:i,...r})=>{const c=o()("rem-c-description-list__description",{"rem-c-description-list__description--bold":a},{"rem-c-description-list__description--withGutter":s},{"rem-c-description-list__description--needsPointer":i}),m=o()(t,"rem-c-description-list");return l().createElement("dl",{className:m,...r},l().createElement("dt",{className:"rem-c-description-list__title"},l().createElement("b",null,e)),l().createElement("dd",{className:c}," ",n," "))},m=c;c.propTypes={title:i().string,children:i().any,isBold:i().bool,className:i().string,hasGutter:i().bool,needsPointer:i().bool}},68175:(e,t,n)=>{n.d(t,{Gx:()=>s,M1:()=>l,VA:()=>i,um:()=>a});const a=(e=[],t)=>e.every((({id:e})=>t?.has(e)))?e.length>0:e.some((({id:e})=>t?.has(e)))&&null,l=e=>e?.issues?.reduce(((e,t)=>(t?.systems?.forEach((n=>{const a=e.find((({id:e})=>n.id===e)),l={id:t.id,resolution:t.resolution,description:t.description};a?(a.issues=[...a.issues,{...l,resolved:a.resolved}],a.rebootRequired=a.issues.some((({resolution:e})=>e?.needs_reboot))):e.push({...n,issues:[{...l,resolved:n.resolved}],rebootRequired:t?.resolution?.needs_reboot})})),e)),[])||[],s=async({page:e=0,...t}={},n,a)=>{const l=n.filter((({display_name:e})=>!t.filters?.hostnameOrId||e.includes(t.filters.hostnameOrId))),s=await a(l.slice((e-1)*t.per_page,e*t.per_page).map((({id:e})=>e)),{...t,hasItems:!0},!0);return{...s,page:e,results:s.results.map((e=>({...l.find((({id:t})=>t===e.id)),...e}))),total:l.length}},i=(e=[],t=[])=>t.map((t=>e.find((e=>e.key===t.key))||t))},8121:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Wt});var a=n(10756),l=n.n(a),s=n(92397),i=n(98773),r=n(88208),o=n(45697),c=n.n(o),m=n(28216),u=n(34413),d=n(33626),p=n(94654),E=n.n(p),g=n(75472),b=n.n(g),h=n(61869),y=n(75863),f=n(7732),v=n(43416),S=n(49004),R=n(58027),k=n(96087),C=n(15433),_=n(75998),I=n(77832),x=n(18293),T=n(31593),w=n(28685),N=n(79194),D=n(87282),Z=n(14832),B=n(29684),q=n(40667),F=n(24224),$=n(32819);class A extends a.Component{constructor(e){super(e),this.issue=e.issue,this.state={selected:e.issue.resolution,resolutions:!1}}onRadioChange=e=>{this.setState({selected:e})};async componentDidMount(){const e=await this.props.getResolutions(this.issue.id);this.setState({resolutions:e.value})}getSelectedResolution=()=>this.state.selected;render(){const{resolutions:e,selected:t}=this.state;let n;return n=e?l().createElement(l().Fragment,null,l().createElement(q.StackItem,null,l().createElement(N.Form,null,e.resolutions.map((e=>l().createElement("div",{className:"ins-c-resolution-option",key:e.id},l().createElement(Z.Radio,{label:l().createElement(q.Stack,{className:"ins-c-resolution-choice__details"},l().createElement(q.StackItem,null,e.description),e.needs_reboot&&l().createElement(q.StackItem,null,l().createElement(F.Z,{red:!0}))),"aria-label":e.description,id:e.id,name:"radio",defaultChecked:e.id===t.id,onChange:()=>this.onRadioChange(e)}))))))):l().createElement(l().Fragment,null,l().createElement(q.StackItem,null,l().createElement($.Z,null)),l().createElement(q.StackItem,null,l().createElement($.Z,null)),l().createElement(q.StackItem,null,l().createElement($.Z,null))),l().createElement(q.Stack,{hasGutter:!0},l().createElement(q.StackItem,null,l().createElement("div",null,"Select resolution for this action.")),l().createElement(q.StackItem,null,l().createElement(B.Split,{hasGutter:!0},l().createElement(B.SplitItem,null,l().createElement(D.Label,null,"Action")),l().createElement(B.SplitItem,{isFilled:!0},l().createElement("h1",{className:"ins-m-text__bold"},this.issue.description)))),n)}}A.propTypes={issue:c().object.isRequired,getResolutions:c().func.isRequired};const P=A,L=({remediation:e,issue:t,onResolutionSelected:n,getResolutions:s})=>{const[i,r]=(0,a.useState)(!1),o=(0,a.useRef)();return l().createElement(l().Fragment,null,l().createElement("a",{onClick:()=>r(!0)},"Edit"),i&&l().createElement(w.Modal,{variant:w.ModalVariant.medium,className:"rem-c-resolution-modal",isOpen:i,onClose:()=>r(!1),title:"Edit resolution",actions:[l().createElement(T.Button,{key:"confirm",variant:"primary",onClick:a=>{r(!1);const l=o.current?.getSelectedResolution();a&&t.resolution.id!==l.id&&n(e.id,t.id,l.id)}},"Save"),l().createElement(T.Button,{key:"cancel",variant:"secondary",onClick:()=>r(!1)},"Cancel")]},l().createElement(P,{key:"ResolutionStep",issue:t,ref:o,getResolutions:s})))};L.propTypes={remediation:c().object.isRequired,issue:c().object.isRequired,onResolutionSelected:c().func.isRequired,getResolutions:c().func.isRequired};const O=L,z=(0,m.connect)((e=>e),(e=>({onResolutionSelected:async(t,n,a)=>{await e((0,u.ok)(t,n,a)),e((0,u.hU)(t))},getResolutions:t=>e((0,u.MR)(t))})))(O);var j=n(37903);class G extends a.Component{state={dialogOpen:!1};onButtonClicked=()=>{this.setState({dialogOpen:!0})};onDialogClose=e=>{this.setState({dialogOpen:!1}),e&&this.props.onDelete()};render(){const{dialogOpen:e}=this.state;return l().createElement(l().Fragment,null,l().createElement(T.Button,{onClick:this.onButtonClicked,isDisabled:this.props.isDisabled,variant:this.props.variant},this.props.label),e&&l().createElement(j.Z,{title:this.props.dialogTitle,confirmText:this.props.dialogConfirmationText,text:this.props.dialogMessage,onClose:this.onDialogClose}))}}G.propTypes={label:c().string,dialogTitle:c().string,dialogMessage:c().string,dialogConfirmationText:c().string,isDisabled:c().bool,onDelete:c().func.isRequired,variant:c().string},G.defaultProps={label:"Delete",variant:"link"};const V=G,M=((0,m.connect)(((e,{remediations:t})=>({dialogMessage:"You will not be able to recover "+(t.length>1?"these remediations":"this remediation")})),((e,{remediations:t})=>({onDelete:async()=>{await Promise.all(t.map((t=>e((0,u.YW)(t))))),e((0,u.ch)())}})))(V),(0,m.connect)(((e,{issues:t})=>({label:"Remove action"+(t.length>1?"s":""),dialogTitle:"Remove action"+(t.length>1?"s":""),dialogConfirmationText:"Remove action"+(t.length>1?"s":"")})),((e,{remediation:t,issues:n,afterDelete:a,isBeta:l})=>({onDelete:async()=>{await Promise.all(n.map((n=>e((0,u.Kn)(t.id,n))))),l&&e((0,u.uz)(t.id)),a()}})))(V));var U=n(42247),W=n.n(U),Y=n(80212),K=n.n(Y),H=n(49231),J=n(67336),Q=n(63652),X=n(18213),ee=n(87123),te=n(881),ne=n(79332),ae=n(30120),le=n(41435);function se({remediation:e,issue:t,system:n,onDelete:s}){const[i,r]=(0,a.useState)(!1),[o,c]=(0,a.useState)(!1);return l().createElement(l().Fragment,null,l().createElement(j.Z,{isOpen:o,text:`This playbook will not address ${t.description} on ${(0,I._f)(n)}`,onClose:a=>{c(!1),a&&s(e.id,t.id,n.id),(0,_.q)({title:`Removed systems from ${e.name}`,description:"",variant:"success",dismissable:!0,autoDismiss:!0})}}),l().createElement(ne.L,{onSelect:e=>e,toggle:l().createElement(ae.a,{onToggle:()=>r((e=>!e))}),isOpen:i,position:le.ir.right,isPlain:!0},l().createElement(T.Button,{onClick:()=>c(!0),variant:"link"},"Remove system")))}se.propTypes={remediation:c().object.isRequired,issue:c().object.isRequired,system:c().object.isRequired,onDelete:c().func.isRequired};const ie=(0,m.connect)(null,(e=>({onDelete:(t,n,a)=>e((0,u.$A)(t,n,a))})))(se),re=({icon:e,text:t})=>l().createElement("div",{className:"rem-c-icon-inline"},e,l().createElement("span",{className:"rem-c-icon-inline__text"},t));re.propTypes={icon:c().node.isRequired,text:c().string.isRequired};const oe=({isOpen:e,onClose:t,issue:n,remediation:s,onDelete:i})=>{const[r,o]=(0,a.useState)(!1),[c,m]=(0,a.useState)({}),[u,d]=(0,a.useState)({}),[p,E]=(0,a.useState)(1),[g,h]=(0,a.useState)(50),[y,f]=(0,a.useState)(""),v=(0,a.useRef)(null),{current:S}=(0,a.useRef)((0,x.T)(n));(0,a.useEffect)((()=>{const e={};n.systems.map((t=>{e[t.id]=!0===t.resolved?l().createElement(re,{icon:l().createElement(W(),null),text:"Remediated"}):l().createElement(re,{icon:l().createElement(K(),null),text:"Not remediated"})})),d(e)}),[]);const R=(e,t)=>n=>l().createElement(ie,{remediation:e,issue:t,system:n}),k=e=>u[e];return l().createElement(l().Fragment,null,l().createElement(w.Modal,{className:"remediations",variant:w.ModalVariant.large,title:`System${n.systems.length>1?"s":""} for action`,isOpen:e,onClose:t,isFooterLeftAligned:!0},l().createElement("b",null,"Action:")," ",n.description,l().createElement("div",{className:"rem-c-toolbar__filter"},l().createElement(Q.Z,{onLoad:({mergeWithEntities:e,INVENTORY_ACTION_TYPES:t})=>(0,J.JH)().register({...e(te.Z.inventoryEntitiesReducer({INVENTORY_ACTION_TYPES:t,detailDropdown:R(s,n),urlBuilder:S,generateStatus:k})())}),ref:v,items:b()(n.systems.filter((e=>(0,I._f)(e).includes(y))),[e=>(0,I._f)(e),e=>e.id]),onRefresh:e=>{v&&v.current&&(E(e.page),h(e.per_page),v.current.onRefreshData({timestamp:Date.now(),...e}))},page:p,total:n.systems.length,perPage:g,hasCheckbox:!1,actions:[{title:" Remove system",onClick:(e,t,n)=>{m(n),o(!0)}}]},l().createElement(C.Z,null,l().createElement(H.ToolbarGroup,null,l().createElement(H.ToolbarItem,null,l().createElement(X.Z,{items:[{value:"display_name",label:"Name",type:ee.Yu.text,filterValues:{placeholder:"Search by name",value:y,onChange:(e,t)=>f(t)}}]}))))))),l().createElement(j.Z,{isOpen:r,text:`Removing the system ${(0,I._f)(c)} from the action ${n.description}\n                    will remove this system’s remediation from the playbook.`,onClose:e=>{o(!1),e&&i(s.id,n.id,c.id)}}))};oe.propTypes={isOpen:c().bool,onClose:c().func,issue:c().object,remediation:c().object,onDelete:c().func};const ce=({issue:e,remediation:t,title:n})=>{const[s,i]=(0,a.useState)(!1),r=(0,m.useDispatch)();return l().createElement(l().Fragment,null,l().createElement("a",{onClick:()=>i(!0)},n),l().createElement(oe,{isOpen:s,onClose:()=>i(!1),issue:e,remediation:t,onDelete:(e,t,n)=>r((0,u.$A)(e,t,n))}))};ce.propTypes={issue:c().object.isRequired,remediation:c().object.isRequired,title:c().string.isRequired};var me=n(38318);const ue="true"===localStorage.getItem("remediations:debug")?{perPageOptions:[1,2,3,4,5,10,15,20,25,50,100,200].map((e=>({title:`${e}`,value:e})))}:{};var de=n(95726),pe=n(45791),Ee=n(4252),ge=n(13193);const be=e=>l().createElement(pe.Bullseye,{className:"pf-u-pt-2xl"},l().createElement(Ee.EmptyState,null,!0===e.filtered?l().createElement(ge.Title,{size:"lg",headingLevel:"h5"},"No actions found"):l().createElement(ge.Title,{size:"lg",headingLevel:"h5"},"This playbook is empty"),l().createElement(Ee.EmptyStateBody,null,"To add an action, select issues identified in",l().createElement("br",null),l().createElement("a",{href:(0,x.Gd)("advisor").toString()},"Recommendations"),", ",l().createElement("a",{href:(0,x.Gd)("compliance").toString()},"Compliance")," or ",l().createElement("a",{href:(0,x.Gd)("vulnerabilities").toString()},"Vulnerability"),"  and select",l().createElement("br",null),l().createElement("strong",null,"Remediate with Ansible."))));be.propTypes={filtered:c().bool.isRequired};var he=n(55140);function ye(e,t){const n=(0,x.Tj)(t.id);return t.resolutions_available<=1?n?l().createElement(l().Fragment,null,l().createElement("span",null,l().createElement("a",{href:n},t.description),l().createElement("br",null),t.resolution.description)):t.resolution.description:n?l().createElement(l().Fragment,null,l().createElement("span",null,l().createElement("a",{href:n},t.description),l().createElement("br",null),t.resolution.description,l().createElement("br",null),l().createElement(z,{issue:t,remediation:e}))):l().createElement(l().Fragment,null,t.resolution.description,l().createElement("br",null),l().createElement(z,{issue:t,remediation:e}))}function fe(e,t,n){return l().createElement(ce,{key:e.id,remediation:t,issue:e,title:n})}function ve(e){let t=0;return e.systems.map((e=>{e.resolved&&t++})),t}const Se=[null,e=>e.description,null,e=>e.resolution.needs_reboot,e=>e.systems.length,e=>(0,I.lN)(e)];function Re(e){const t=(0,me.h0)(),n=(0,me.sk)(1,"asc"),s=(0,me.L0)(),i=(0,me.v9)(),r=(0,a.useContext)(de.B),[o,c]=(0,a.useState)(""),[m,u]=(0,a.useState)(0),d=(0,he.Z)();(0,a.useEffect)((()=>{s.setValue(o)}),[o]),n.onChange(t.reset),s.onChange(t.reset);const p=e.remediation.issues.filter((e=>(0,I.PW)(e.description,s.value.trim()))),g=b()(p,[Se[n.sortBy]],[n.sortDir]).slice(t.offset,t.offset+t.pageSize),x=E()(g,(T=e.remediation,e=>{var t;return[{isOpen:!1,id:e.id,cells:[{title:ye(T,e)},{title:(t=e.resolution.needs_reboot,l().createElement("span",null,t?"Required":"Not required"))},{title:fe(e,T,`${e.systems.length}`)},{title:(0,I.lN)(e),props:{className:"rem-m-nowrap"}},{title:fe(e,T,`${ve(e)}/${e.systems.length} remediated`)}]}]}));var T;i.register(x);const w=i.getSelectedIds(),N={filters:o.length?[{category:"Action",chips:[{name:o}]}]:[],onDelete:()=>{c(""),s.setValue("")}},D=e=>e?.filter((e=>!0===e.selected));return l().createElement("div",{className:"test"},l().createElement(k.Z,{filterConfig:{items:[{label:"Search actions",type:"text",filterValues:{id:"filter-by-string",key:"filter-by-string",placeholder:"Search",value:o,onChange:(e,t)=>{c(t)}}}]},bulkSelect:{isDisabled:!x,items:[{title:"Select none (0)",onClick:()=>{i.props.onSelect("none")}},x.length>0?{title:`Select page (${x?.length})`,onClick:()=>{0===D(x).length?i.props.onSelect("page",!0,0):x.length===D(x).length?i.props.onSelect("page",!1,0):i.props.onSelect("page",!0,0)}}:{},x.length>0?{title:`Select all (${e?.remediation?.issues.length})`,onClick:()=>{i.register(e?.remediation.issues),w?.length<e?.remediation?.issues.length?i.props.onSelect("page",!0,0):i.props.onSelect("page",!1,0)}}:{}],checked:w.length&&p.length>w.length?null:w.length,count:w.length,onSelect:()=>{0===D(x).length?i.props.onSelect("page",!0,0):i.props.onSelect("page",!1,0)}},actionsConfig:{actions:[l().createElement(M,{key:e.remediation.id,variant:"secondary",isDisabled:!w.length,remediation:e.remediation,issues:w,afterDelete:()=>{(0,_.q)({title:`Removed ${w.length} actions from ${e.remediation.name}`,description:"",variant:"success",dismissable:!0,autoDismiss:!0}),i.reset()},isBeta:d?.isBeta?.()})]},pagination:{...t.props,itemCount:p.length},activeFiltersConfig:N}),x.length>0?l().createElement(v.i,{variant:y.B.compact,"aria-label":"Actions",canSelectAll:!1,className:"ins-c-remediation-details-table",cells:[{title:"Actions",transforms:[f.p]},{title:"Reboot required",transforms:[f.p]},{title:"Systems",transforms:[f.p]},{title:"Type",transforms:[f.p]},{title:"Status",transforms:[f.p]}],rows:x,...n.props,...r.permissions.write&&{...i.props}},l().createElement(S.x,null),l().createElement(R.R,{...i.tbodyProps})):s.value?l().createElement(be,{filtered:!0}):l().createElement(be,{filtered:!1}),x.length>0&&l().createElement(C.Z,{isFooter:!0},l().createElement(h.Pagination,{variant:"bottom",dropDirection:"up",itemCount:p.length,...t.props,...ue})))}Re.propTypes={remediation:c().object.isRequired,status:c().object.isRequired};const ke=Re;var Ce=n(57283),_e=n.n(Ce),Ie=n(18546),xe=n(62703),Te=n(29738),we=n.n(Te),Ne=n(15848);const De=({isOpen:e,selected:t,onConfirm:n,onClose:a,remediationName:s})=>l().createElement(w.Modal,{variant:w.ModalVariant.medium,title:`Remove selected systems from ${s}`,isOpen:e,onClose:a,appendTo:document.getElementsByClassName("remediations")[0],actions:[l().createElement(T.Button,{key:"remove-confirm",variant:"danger",onClick:n,ouiaId:"confirm-delete"},"Remove"),l().createElement(T.Button,{key:"remove-cancel",variant:"link",onClick:a},"Cancel")]},l().createElement(B.Split,{hasGutter:!0},l().createElement(B.SplitItem,null,l().createElement(xe.Icon,{size:"xl",className:"ins-m-alert",status:"warning"},l().createElement(we(),null))),l().createElement(B.SplitItem,{isFilled:!0},l().createElement(q.Stack,{hasGutter:!0},l().createElement(q.StackItem,null,"This action will remove"," ",1===t.length?l().createElement("span",null,l().createElement("b",null," ",t[0]?.display_name," ")," system"):l().createElement("span",null,l().createElement("b",null," ",t.length," ")," systems")," ","from ",l().createElement("b",null,s)," Remediation."),l().createElement(q.StackItem,null,"Removing ",(0,Ne._6)(t.length,"system")," from this Remediation will remove it from all associated issues in"," ",l().createElement("b",null,s)," Remediation. Be careful as you can end up with Remediation without any systems.")))));De.propTypes={selected:c().arrayOf(c().shape({id:c().string,display_name:c().string})).isRequired,remediationName:c().string.isRequired,isOpen:c().bool.isRequired,onConfirm:c().func.isRequired,onClose:c().func.isRequired};const Ze=De;var Be=n(68175),qe=n(1082);const Fe=({rebootRequired:e})=>l().createElement(a.Fragment,null,l().createElement("span",null,e?"Required":"Not required"));Fe.propTypes={rebootRequired:c().bool};const $e=Fe;var Ae=n(89734),Pe=n.n(Ae);const Le={advisor:"Advisor recommendation",vulnerabilities:"Vulnerability","patch-advisory":"Patch advisory"},Oe=({issues:e,display_name:t})=>{const[n,s]=(0,a.useState)({index:0,direction:"asc"}),[i,r]=(0,a.useState)(),o=Pe()(e,(e=>{return(t=e,[t.description,t.resolution.needs_reboot,Le?.[t.id.split(":")[0]],t.resolved])[n.index];var t}));return l().createElement(a.Fragment,null,l().createElement(T.Button,{variant:"link",isInline:!0,onClick:()=>r(!0)},e.length),l().createElement(w.Modal,{variant:w.ModalVariant.medium,title:`Actions for system ${t}`,isOpen:i,onClose:()=>r(!1)},l().createElement(v.i,{variant:"compact","aria-label":`Issues table for ${t}`,rows:("asc"===n.direction?o:o.reverse()).map((e=>[{title:l().createElement(a.Fragment,null,l().createElement("div",null,l().createElement("a",{href:(0,x.Tj)(e.id)},e.description)),l().createElement("div",null,e.resolution.description))},{title:l().createElement(a.Fragment,null,l().createElement($e,{rebootRequired:e.resolution.needs_reboot}))},Le?.[e.id.split(":")[0]]||"Unknown",{title:l().createElement(a.Fragment,null,e.resolved?l().createElement(W(),null):l().createElement(K(),null)," ",e.resolved?"Remediated":"Not remediated")}])),cells:[{title:"Action",transforms:[f.p]},{title:"Reboot required",transforms:[f.p,(0,qe.d)(20)]},{title:"Type",transforms:[f.p,(0,qe.d)(15)]},{title:"Status",transforms:[f.p,(0,qe.d)(20)]}],sortBy:n,onSort:(e,t,n)=>s({index:t,direction:n})},l().createElement(S.x,null),l().createElement(R.R,null))))};Oe.propTypes={issues:c().arrayOf(c().shape()),display_name:c().string};const ze=Oe,je=[{key:"display_name"},{key:"tags"},{key:"system_profile"},{key:"issues",title:"Issues",renderFunc:(e,t,{display_name:n})=>l().createElement(ze,{issues:e,display_name:n}),props:{width:15,isStatic:!0}},{key:"rebootRequired",title:"Reboot required",renderFunc:e=>l().createElement($e,{rebootRequired:e}),props:{width:15,isStatic:!0}}],Ge=({remediation:e,registry:t,refreshRemediation:n})=>{const[s,i]=(0,a.useState)(!1),r=(0,a.useRef)(),o=(0,a.useRef)((()=>{})),c=(0,a.useRef)(void 0),d=(0,m.useDispatch)(),p=(0,m.useSelector)((({entities:e})=>e?.selected||new Map)),E=(0,m.useSelector)((({entities:e})=>e?.loaded)),g=(0,m.useSelector)((({entities:e})=>e?.rows)),b=e=>e?.filter((e=>!0===e.selected)),h=e=>{switch(e){case"none":case"deselect all":r.current.map((e=>d((0,u.CL)(e.id,!1))));break;case"page":d((0,u.CL)(0,!0));break;case"deselect page":g.map((()=>d((0,u.CL)(0,!1))));break;case"all":r.current.map((e=>d((0,u.CL)(e.id,!0))))}};return(0,a.useEffect)((()=>{r.current=(0,Be.M1)(e)}),[e.id]),l().createElement(Q.Z,{variant:"compact",showTags:!0,noDetail:!0,hideFilters:{all:!0,name:!1},tableProps:{canSelectAll:!1},columns:e=>(0,Be.VA)(e,je),bulkSelect:{isDisabled:!g,count:p?p.size:0,items:[{title:"Select none (0)",onClick:()=>h("none")},{...E&&g&&g.length>0?{title:`Select page (${g.length})`,onClick:()=>{p?b(g).length===g.length?h("deselect page"):r.current.length>p.size?h("page"):h("deselect page"):h("page")}}:{}},{...E&&g&&g.length>0?{title:`Select all (${r.current.length})`,onClick:()=>{(0,Be.um)(r.current,p)?h("deselect all"):h("all")}}:{}}],checked:(0,Be.um)(r.current,p),onSelect:()=>{b(g).length===g.length?h("deselect page"):h("page")}},getEntities:async(e,t)=>(0,Be.Gx)(t,r.current,o.current),onLoad:({INVENTORY_ACTION_TYPES:e,mergeWithEntities:n,api:a})=>{o.current=a?.getEntities,t?.register?.({...n((0,te.L)(e))})},actions:[{title:"Remove system",onClick:(t,n,{id:a,display_name:l})=>{c.current={id:a,display_name:l,issues:e.issues.filter((e=>e.systems.find((({id:e})=>e===a))))},i(!0)}}]},E&&l().createElement(T.Button,{variant:"secondary",onClick:()=>i(!0),isDisabled:0===p.size},"Remove system"),l().createElement(Ze,{isOpen:s,onConfirm:()=>{(async()=>{const t=p.size>0?Array.from(p,(([,e])=>e)):[{...c.current}],a=(0,u.Ph)(t,e);d(a),await a.payload,n()})(),c.current=void 0,(0,_.q)({title:`Removed ${p.size} ${p.size>1?"systems":"system"} from playbook`,description:"",variant:"success",dismissable:!0,autoDismiss:!0}),i(!1)},selected:p.size>0?Array.from(p,(([,e])=>e)):[c.current],onClose:()=>{c.current=void 0,i(!1)},remediationName:e.name}))},Ve=e=>{const t=(0,m.useDispatch)(),[n,s]=(0,a.useState)();return(0,a.useEffect)((()=>{s(new Ie.ZP({selected:new Map},[_e()]))}),[]),n?l().createElement(m.Provider,{store:n.store},l().createElement(Ge,{registry:n,refreshRemediation:()=>t((0,u.d5)(e.remediation.id)),...e})):l().createElement(a.Fragment,null)};Ve.propTypes={remediation:c().shape({id:c().string,issues:c().arrayOf(c().shape({systems:c().arrayOf(c().shape({id:c().string,display_name:c().string,resolved:c().bool}))}))})},Ge.propTypes={...Ve.propTypes,registry:c().shape({register:c().func}),refreshRemediation:c().func};const Me=Ve;var Ue=n(5756),We=n(62410);const Ye=({remediation:e,playbookRuns:t})=>{const[n,i]=(0,a.useState)([]),r=(0,a.useContext)(de.B);return(0,a.useEffect)((()=>{t&&t.length&&i((()=>(t=>t.reduce(((t,n,a)=>[...t,{isOpen:!1,cells:[{title:l().createElement(s.Z,{to:`/${e.id}/${n.id}`},l().createElement(We.Z,{type:"exact",date:n.created_at})),cellFormatters:[Ue.zW]},n.created_by.last_name?`${n.created_by.first_name} ${n.created_by.last_name}`:`${n.created_by.username}`,{title:l().createElement(Ne.kf,{executorStatus:(0,Ne.fb)(n.status),counts:n.executors.reduce(((e,t)=>({pending:e.pending+t.counts.pending,running:e.running+t.counts.running,success:e.success+t.counts.success,failure:e.failure+t.counts.failure,canceled:e.canceled+t.counts.canceled,acked:e.acked+t.counts.acked})),{pending:0,running:0,success:0,failure:0,canceled:0,acked:0}),hasCancel:!0,remediationName:e.name,remediationId:e.id,playbookId:n.id,permission:r})}]},{parent:2*a,fullWidth:!0,cells:[{title:l().createElement(v.i,{"aria-label":"Compact expandable table",cells:["Connection","Systems","Playbook run status"],rows:n.executors.map((t=>({cells:[{title:l().createElement(s.Z,{to:`/${e.id}/${n.id}/${t.executor_id}`},t.executor_name)},t.system_count,{title:l().createElement(Ne.kf,{executorStatus:(0,Ne.fb)(t.status),counts:t.counts,permission:r})}]})))},l().createElement(S.x,null),l().createElement(R.R,null))}]}]),[]))(t)))}),[t]),l().createElement(v.i,{className:"rem-c-activity-table","aria-label":"Collapsible table",onCollapse:(e,t,a)=>{const l=[...n];l[t]={...l[t],isOpen:a},i(l)},rows:n,cells:["Run on","Run by","Status"]},l().createElement(S.x,null),l().createElement(R.R,null))};Ye.propTypes={remediation:c().object,playbookRuns:c().array};const Ke=Ye;var He=n(26438);function Je(e){const[t,n]=(0,a.useState)(e.value||""),[s,i]=(0,a.useState)(!0),{title:r,onCancel:o,onSubmit:c,ariaLabel:m,className:u}=e;return l().createElement(w.Modal,{title:r,isOpen:!0,onClose:e=>o(e),actions:[l().createElement(T.Button,{key:"confirm",variant:"primary",onClick:()=>c(t),isDisabled:!s,ouiaId:"save"},"Save"),l().createElement(T.Button,{key:"cancel",variant:"secondary",onClick:o,ouiaId:"cancel"},"Cancel")],variant:w.ModalVariant.small,className:u},l().createElement(N.FormGroup,{fieldId:"remediation-name",helperTextInvalid:"Playbook name has to contain alphanumeric characters",isValid:s},l().createElement(He.TextInput,{value:t,type:"text",onChange:(t,a)=>function(t){n(t),e.pattern&&i(e.pattern.test(t))}(a),"aria-label":m||"input text",autoFocus:!0,isValid:s})))}Je.propTypes={title:c().string.isRequired,onCancel:c().func,onSubmit:c().func,ariaLabel:c().string,value:c().string,className:c().string,pattern:c().instanceOf(RegExp)};const Qe=/^$|^.*[\w\d]+.*$/;function Xe({remediation:e,onRename:t,onDelete:n}){const[s,r]=(0,a.useState)(!1),[o,c]=(0,a.useState)(!1),[m,u]=(0,a.useState)(!1),d=(0,a.useContext)(de.B),p=(0,i.Z)();return l().createElement(l().Fragment,null,o&&l().createElement(Je,{title:"Edit playbook name",ariaLabel:"Playbook name",value:e.name,onCancel:()=>c(!1),onSubmit:n=>{c(!1),t(e.id,n),(0,_.q)({title:`Updated playbook name to ${n}`,description:"",variant:"success",dismissable:!0,autoDismiss:!0})},pattern:Qe}),l().createElement(j.Z,{isOpen:m,title:"Remove playbook?",text:"You will not be able to recover this Playbook",confirmText:"Remove playbook",onClose:t=>{u(!1),t&&(n(e.id),(0,_.q)({title:`Deleted playbook ${e.name}`,variant:"success",dismissable:!0,autoDismiss:!0}),p("/"))}}),d.permissions.write&&l().createElement(ne.L,{onSelect:e=>e,toggle:l().createElement(ae.a,{onToggle:()=>r((e=>!e))}),isOpen:s,position:le.ir.right,isPlain:!0},l().createElement(T.Button,{onClick:()=>c(!0),variant:"link"},"Rename"),l().createElement(T.Button,{className:"rem-c-button__danger-link",onClick:()=>u(!0),variant:"link",isDanger:!0},"Delete")))}Xe.propTypes={remediation:c().object.isRequired,onRename:c().func.isRequired,onDelete:c().func.isRequired};const et=(0,m.connect)(null,(e=>({onRename:(t,n)=>{n||(n="Unnamed Playbook"),e((0,u.o6)(t,{name:n}))},onDelete:t=>e((0,u.YW)(t))})))(Xe);var tt=n(77457),nt=n(75796),at=n(80595),lt=n(60278);const st=({isLoading:e,isDisabled:t,data:n,getConnectionStatus:s,remediationId:i,remediationName:r,issueCount:o,runRemediation:c,etag:m,remediationStatus:u,setEtag:d,connectionDetails:p,areDetailsLoading:E,detailsError:g,permissions:b})=>{const[h,y]=(0,a.useState)(!1),[f,v]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{"changed"===u?(s(i),v(!0)):"fulfilled"===u&&y(!1)}),[u]),E?E?l().createElement(nt.Spinner,{size:"lg"}):null:l().createElement(l().Fragment,null,t?l().createElement(at.Tooltip,{minWidth:"400px","aria-label":"details Tooltip",content:l().createElement(l().Fragment,null,l().createElement(tt.Flex,{className:"pf-v5-u-ml-md",direction:{default:"column"},spaceItems:{default:"spaceItemsNone"},alignItems:{default:"alignItemsFlexStart"}},l().createElement(ge.Title,{headingLevel:"h6",className:"pf-v5-u-mb-md"},"Remediations Readiness Check"),l().createElement("span",{className:"pf-v5-u-font-size-sm"},4===p?.system_count?l().createElement(W(),{className:"pf-v5-u-mr-sm"}):l().createElement(K(),{className:"pf-v5-u-mr-sm"}),"Connected Systems (",p?.system_count,"/4). See systems tab."),l().createElement("span",{className:"pf-v5-u-font-size-sm"},403===g?l().createElement(K(),{className:"pf-v5-u-mr-sm"}):l().createElement(W(),{className:"pf-v5-u-mr-sm"}),l().createElement("a",{href:"https://console.redhat.com/insights/connector",style:{textDecoration:"underline",color:"white"}},"RHC manager"),"is ",403===g?"disabled":"enabled","."),l().createElement("span",{className:"pf-v5-u-font-size-sm pf-v5-u-mb-sm"},b?l().createElement(W(),{className:"pf-v5-u-mr-sm"}):l().createElement(K(),{className:"pf-v5-u-mr-sm"}),l().createElement("a",{href:"https://console.redhat.com/iam/user-access/overview",style:{textDecoration:"underline",color:"white"}},"User access permissions"),"are ",b?"":"not"," granted.")))},l().createElement(T.Button,{isAriaDisabled:!0},"Execute playbook")):l().createElement(T.Button,{"data-testid":"execute-button-enabled",onClick:()=>{y(!0),s(i)}},"Execute playbook"),h&&l().createElement(lt.l,{isOpen:h,onClose:()=>{v(!1),y(!1)},showRefresh:f,remediationId:i,remediationName:r,data:n,etag:m,isLoading:e,issueCount:o,runRemediation:c,setEtag:d}))};st.propTypes={isLoading:c().bool,data:c().array,getConnectionStatus:c().func,runRemediation:c().func,remediationId:c().string,remediationName:c().string,remediationStatus:c().string,issueCount:c().number,etag:c().string,setEtag:c().func,isDisabled:c().bool,disabledStateText:c().string,connectionDetails:c().object,areDetailsLoading:c().bool,detailsError:c().any,permissions:c().bool},st.defaultProps={data:[],isDisabled:!1};const it=st,rt=(0,m.connect)((({connectionStatus:{data:e,status:t,etag:n},selectedRemediation:a,runRemediation:l,sources:s,executable:i})=>({data:e,isLoading:"fulfilled"!==t,issueCount:a.remediation.issues.length,etag:n,remediationStatus:l.status,sources:s,executable:i})),(e=>({getConnectionStatus:t=>{e((0,u.Zp)(t))},runRemediation:(t,n,a)=>{e((0,u.JW)(t,n,a)).then((()=>e((0,u.Is)(t))))},setEtag:t=>{e((0,u.Fo)(t))},getEndpoint:t=>{e((0,u.O3)(t))},checkExecutable:t=>{e((0,u.lh)(t))}})))(it);var ot=n(83215),ct=n(13996);const mt=({onClose:e,...t})=>l().createElement(ct.Alert,{variant:"info",isInline:!0,title:"Put Insights into action",actionClose:l().createElement(ct.AlertActionCloseButton,{onClose:e,"data-testid":"upselBanner-close"}),...t},l().createElement(q.Stack,{hasGutter:!0},l().createElement(q.StackItem,null,"Enable push-button remediation across your hybrid cloud environment with Red Hat Satellite."),l().createElement(q.StackItem,null,l().createElement("a",{href:"https://www.redhat.com/en/technologies/management/satellite"},"Learn more")))),ut=mt;mt.propTypes={onClose:c().func},mt.defaultProps={onClose:()=>{}};var dt=n(98871),pt=n.n(dt);const Et=()=>l().createElement(pe.Bullseye,null,l().createElement(Ee.EmptyState,null,l().createElement(Ee.EmptyStateHeader,{titleText:"Get more with Find it Fix it capabilities",icon:l().createElement(Ee.EmptyStateIcon,{icon:pt()}),headingLevel:"h5"}),l().createElement(Ee.EmptyStateBody,null,"Upgrade to Red Hat Satellite to remediate all your systems, across regions and geographies directly from Red Hat Insights."),l().createElement(Ee.EmptyStateFooter,null,l().createElement(T.Button,{variant:"link",component:"a",ouiaId:"learn_more",href:"https://www.redhat.com/en/technologies/management/satellite"},"Learn more"))));var gt=n(76744),bt=n(2648),ht=n(63456),yt=n(39173),ft=n(99087),vt=n(39467),St=n(64596),Rt=n(53774),kt=n(48211),Ct=n(69409),_t=n(85998),It=n(65146),xt=n(71070);const Tt=()=>{const e=l().createElement(a.Fragment,null,l().createElement(H.ToolbarItem,null,l().createElement(ne.L,{toggle:l().createElement(_t.Z,{isDisabled:!0,splitButtonItems:[l().createElement(It.o,{id:"skeleton-dropdown",key:"skeleton-dropdown","aria-label":"Loading Select all"})],id:"skeleton-dropdown-toggle"})})),l().createElement(H.ToolbarItem,null,l().createElement(Ct.InputGroup,null,l().createElement(Ct.InputGroupItem,{isFill:!0},l().createElement(He.TextInput,{value:"Search",isDisabled:!0,name:"skeleton-search",id:"skeleton-search",type:"search","aria-label":"search loading"})),l().createElement(Ct.InputGroupItem,null,l().createElement(T.Button,{isDisabled:!0,variant:"control","aria-label":"search button for search input"},l().createElement(xt.ZP,null))))),l().createElement(H.ToolbarItem,null,l().createElement(T.Button,{isDisabled:!0,variant:"primary"},"Remove action")));return l().createElement(H.Toolbar,{id:"skeleton-toolbar"},l().createElement(H.ToolbarContent,null," ",e," "))},wt=()=>l().createElement(kt.Tabs,{activeKey:0,className:"ins-s-tabs"},l().createElement(kt.Tab,{eventKey:0,title:l().createElement(kt.TabTitleText,null,"Actions")}),l().createElement(kt.Tab,{eventKey:1,title:l().createElement(kt.TabTitleText,null,"Systems")}),l().createElement(kt.Tab,{eventKey:2,title:l().createElement(kt.TabTitleText,null,"Activity")}));var Nt=n(9677),Dt=n(10310),Zt=n(76400);const Bt=()=>l().createElement(l().Fragment,null,l().createElement(ht.Z,{className:"rem-c-page-details__header"},l().createElement(Rt.Breadcrumb,null,l().createElement(Rt.BreadcrumbItem,null,l().createElement(s.Z,{to:"/"}," Remediations ")),l().createElement(Rt.BreadcrumbItem,{isActive:!0},l().createElement($.Z,{size:"lg"}))),l().createElement(St.Level,{className:"rem-l-level"},l().createElement(St.LevelItem,null,l().createElement(yt.Z,{className:"rem-s-page-header",title:l().createElement(l().Fragment,null,l().createElement($.Z,{size:"md"}))})),l().createElement(St.LevelItem,null,l().createElement(B.Split,{hasGutter:!0},l().createElement(B.SplitItem,null,l().createElement(T.Button,{isDisabled:!0,variant:"link"},"Download playbook")),l().createElement(B.SplitItem,null,l().createElement(ne.L,{toggle:l().createElement(ae.a,{isDisabled:!0}),isOpen:!1,isPlain:!0}))))),l().createElement(qt,null)),l().createElement(ft.ZP,null,l().createElement(q.Stack,{hasGutter:!0},l().createElement(q.StackItem,{className:"ins-c-playbookSummary__tabs"},l().createElement(wt,null),l().createElement(Tt,null),l().createElement(bt.Z,null))))),qt=()=>l().createElement(B.Split,null,l().createElement(B.SplitItem,null,l().createElement(Nt.z,{ariaDesc:"Resolved issues count",ariaTitle:"Resolved issues chart",constrainToVisibleArea:!0,data:{x:"Resolved",y:1},labels:({datum:e})=>e.x?`${e.x}: ${e.y}%`:null,title:"Loading",subTitle:"Issues resolved",subTitleComponent:l().createElement(Dt.D,{y:102}),thresholds:[{value:100,color:"#3E8635"}],height:175,width:175,padding:{bottom:20,left:0,right:20,top:20}})),l().createElement(B.SplitItem,{className:"ins-c-remediation-summary__body"},l().createElement(q.Stack,{hasGutter:!0},l().createElement(q.StackItem,null,l().createElement(B.Split,null,l().createElement(B.SplitItem,null,l().createElement(tt.Flex,null,l().createElement(tt.FlexItem,{spacer:{default:"spacer-lg"}},l().createElement(Zt.Z,{title:"Total systems"},l().createElement($.Z,{size:"md"}))))),l().createElement(B.SplitItem,null,l().createElement(tt.Flex,null,l().createElement(tt.FlexItem,{spacer:{default:"spacer-lg"}},l().createElement(Zt.Z,{title:"Latest activity"},l().createElement($.Z,{size:"md"}))))))),l().createElement(q.StackItem,null,l().createElement(tt.Flex,null,l().createElement(tt.FlexItem,{spacer:{default:"spacer-lg"}},l().createElement(Zt.Z,{title:"Autoreboot"},l().createElement($.Z,{size:"md"})))))))),Ft=()=>l().createElement(v.i,{"aria-label":"No activity",cells:["Run on","Run by","Status"],ouiaId:"activity-table",rows:[{cells:[{title:l().createElement(Ee.EmptyState,{className:"rem-c-activity-table__empty"},l().createElement(Ee.EmptyStateHeader,{titleText:"No activity",headingLevel:"h5"}),l().createElement(Ee.EmptyStateBody,null,"Execute this playbook to see a history and summary of the activity.")),props:{colSpan:3}}]}]},l().createElement(S.x,null),l().createElement(R.R,null));var $t=n(82494),At=n(44278),Pt=n.n(At),Lt=n(71916),Ot=n.n(Lt),zt=n(93967),jt=n.n(zt);const Gt=({remediation:e,playbookRuns:t,switchAutoReboot:n,context:a})=>{const i=t=>{n(e.id,t)},r=(t,n)=>{return t?l().createElement("div",null,l().createElement(Pt(),{className:"rem-c-success"}),l().createElement("b",{className:"ins-c-remediation-summary__reboot--enabled"}," Enabled "),a.permissions.write&&l().createElement(T.Button,{variant:"link",onClick:()=>i(!e.auto_reboot)},"Turn off")):(s=n,l().createElement("div",null,l().createElement(Ot(),null),l().createElement("b",{className:"ins-c-remediation-summary__reboot--disabled"+(s?"--warning":"")},"Off"),s&&l().createElement(l().Fragment,null,l().createElement(we(),{className:"ins-c-remediation-summary__reboot--required--icon"}),l().createElement("b",{className:"ins-c-remediation-summary__reboot--required"},`${r=(()=>{let t=0;for(const n of e.issues)n.resolution.needs_reboot&&t++;return t})()} issue${1===r?"":"s"} require${1===r?"s":""} reboot to remediate`)),a.permissions.write&&l().createElement(T.Button,{variant:"link",onClick:()=>i(!e.auto_reboot)},"Turn on")));var s,r},{stats:o}=e,c=o.systemsWithReboot+o.systemsWithoutReboot,m=(e=>{let t=0;return e.map((e=>e.systems.every((e=>e.resolved))&&t++)),t})(e.issues);return l().createElement(B.Split,null,l().createElement(B.SplitItem,null,l().createElement(Nt.z,{ariaDesc:"Resolved issues count",ariaTitle:"Resolved issues chart",constrainToVisibleArea:!0,data:{x:"Resolved",y:m/e.issues.length*100},labels:({data:e})=>e.x?`${e.x}: ${e.y}%`:null,title:`${m}/${e.issues.length}`,subTitle:"Issues resolved",subTitleComponent:l().createElement(Dt.D,{y:102}),thresholds:[{value:100,color:"#3E8635"}],height:175,width:175,padding:{bottom:20,left:0,right:20,top:20}})),l().createElement(B.SplitItem,{className:"ins-c-remediation-summary__body"},l().createElement(q.Stack,{hasGutter:!0},l().createElement(q.StackItem,null,l().createElement(B.Split,null,l().createElement(B.SplitItem,null,l().createElement(tt.Flex,null,l().createElement(tt.FlexItem,{spacer:{default:"spacer-lg"}},l().createElement(Zt.Z,{title:"Total systems"},(d="system",1===(u=c)?`${u} ${d}`:`${u} ${d}s`))))),l().createElement(B.SplitItem,null,l().createElement(tt.Flex,null,t&&(e=>{if(e.length){const t=e[0];return l().createElement(tt.FlexItem,{spacer:{default:"spacer-xl"}},l().createElement(Zt.Z,{needsPointer:!0,className:"rem-c-description-list-latest-activity",title:"Latest activity"},l().createElement(Ne.kf,{executorStatus:t.status,counts:t.executors.reduce(((e,t)=>({pending:e.pending+t.counts.pending,running:e.running+t.counts.running,success:e.success+t.counts.success,failure:e.failure+t.counts.failure,canceled:e.canceled+t.counts.canceled,acked:e.acked+t.counts.acked})),{pending:0,running:0,success:0,failure:0,canceled:0,acked:0}),permission:{}}),l().createElement("span",{className:"rem-c-description-list-latest-activity__date"},l().createElement(We.Z,{type:"relative",date:t.updated_at})),l().createElement(s.Z,{to:`/${t.remediation_id}/${t.id}`},"View")))}})(t))))),l().createElement(q.StackItem,null,(e=>l().createElement(Zt.Z,{className:"rem-c-playbookSummary__settings",title:"Autoreboot"},l().createElement(tt.Flex,null,l().createElement(tt.FlexItem,{className:jt()("ins-c-reboot-status",{"ins-c-reboot-status__enabled":e.auto_reboot&&e.needs_reboot},{"ins-c-reboot-status__disabled":!e.auto_reboot}),spacer:{default:"spacer-xl"}},r(e.auto_reboot,e.needs_reboot)))))(e)))));var u,d};Gt.propTypes={remediation:c().object.isRequired,playbookRuns:c().array,switchAutoReboot:c().func.isRequired,context:c().object.isRequired};var Vt=n(33366);const{API_BASE:Mt}=n(93940),Ut=({selectedRemediation:e,selectedRemediationStatus:t,loadRemediation:n,loadRemediationStatus:o,switchAutoReboot:c,playbookRuns:m,getPlaybookRuns:u,checkExecutable:p,executable:E})=>{const g=(0,he.Z)(),b=(0,i.Z)(),{id:h}=(0,r.useParams)(),[y,f]=(0,r.useSearchParams)(),{isFedramp:v,isBeta:S}=g,R=(0,a.useContext)(de.B),[k,C]=(0,a.useState)("dismissed"!==localStorage.getItem("remediations:bannerStatus")),[I,x]=(0,a.useState)("dismissed"!==localStorage.getItem("remediations:receptorBannerStatus"));(0,a.useEffect)((()=>{n(h).catch((e=>{if(!e||!e.response||404!==e.response.status)throw e;b("/")})),S?.()&&o(h),p(h)}),[]),(0,a.useEffect)((()=>{u(h)}),[u]),(0,a.useEffect)((()=>{if(m&&m.length&&"running"===(0,Ne.fb)(m[0].status)){const e=setInterval((()=>u(h)),1e4);return()=>{clearInterval(e)}}}),[m]);const{status:w,remediation:N}=e,[D,Z,F,$]=(e=>{const t=(0,Vt.Vk)(),[n,l]=(0,a.useState)(),[s,i]=(0,a.useState)(!0),[r,o]=(0,a.useState)(),[c,m]=(0,a.useState)(),u=(0,a.useRef)(!1);return(0,a.useEffect)((()=>(u.current=!0,(async()=>{try{const n=e&&await t.get(`${Mt}/remediations/${e.id}/connection_status`);u.current&&l("connected"===n.data?.[0].connection_status),o(n.data[0]),i(!1)}catch(e){console.error(e),m(e.errors[0].status)}})(),()=>{u.current=!1})),[e]),[n,r,s,c]})(N);return(0,a.useEffect)((()=>{N&&g.updateDocumentTitle(`${N.name} - Remediations | Red Hat Insights`)}),[g,N]),"fulfilled"!==w&&"rejected"!==w?l().createElement(Bt,null):"rejected"===w?l().createElement(vt.Z,null):"fulfilled"===w?!1===R.permissions.read?l().createElement(gt.Z,null):l().createElement("div",{className:"page__remediation-details"},l().createElement(ht.Z,null,l().createElement(Rt.Breadcrumb,null,l().createElement(Rt.BreadcrumbItem,null,l().createElement(s.Z,{to:"/"}," Remediations ")),l().createElement(Rt.BreadcrumbItem,{isActive:!0}," ",N.name," ")),l().createElement(St.Level,{className:"rem-l-level"},l().createElement(St.LevelItem,null,l().createElement(yt.Z,{title:N.name})),l().createElement(St.LevelItem,null,l().createElement(B.Split,{hasGutter:!0},l().createElement(B.SplitItem,null,l().createElement(rt,{isDisabled:!D||!R.permissions.execute||!E||v,remediationId:N.id,remediationName:N.name,connectionDetails:Z,areDetailsLoading:F,detailsError:$,permissions:R.permissions.execute})),l().createElement(B.SplitItem,null,l().createElement(T.Button,{isDisabled:!N.issues.length,variant:"secondary",onClick:()=>{(0,d.rN)(N.id),(0,_.q)({title:"Preparing playbook for download.",description:"Once complete, your download will start automatically.",variant:"info",dismissable:!0,autoDismiss:!0})}},"Download playbook")),l().createElement(B.SplitItem,null,l().createElement(et,{remediation:N}))))),l().createElement(Gt,{remediation:N,playbookRuns:m,switchAutoReboot:c,context:R})),l().createElement(ft.ZP,null,l().createElement(q.Stack,{hasGutter:!0},!E&&k&&l().createElement(q.StackItem,null,l().createElement(ut,{onClose:()=>(C(!1),void localStorage.setItem("remediations:bannerStatus","dismissed"))})),E&&I&&l().createElement(q.StackItem,null,l().createElement($t.Z,{onClose:()=>(x(!1),void localStorage.setItem("remediations:receptorBannerStatus","dismissed"))})),l().createElement(q.StackItem,{className:"ins-c-playbookSummary__tabs"},l().createElement(kt.Tabs,{activeKey:y.get("activeTab")||"issues",onSelect:(e,t)=>f({...Object.fromEntries(y),activeTab:t})},l().createElement(kt.Tab,{eventKey:"issues",title:"Actions"},l().createElement(ke,{remediation:N,status:t})),l().createElement(kt.Tab,{eventKey:"systems",title:"Systems"},l().createElement(Me,{remediation:N})),l().createElement(kt.Tab,{eventKey:"activity",title:"Activity"},((e,t,n)=>e?Array.isArray(t)&&t.length?l().createElement(Ke,{remediation:n,playbookRuns:t}):Array.isArray(t)&&!t.length?l().createElement(Ft,null):l().createElement(bt.Z,null):l().createElement(Et,null))(E,m,N))))))):void 0};Ut.propTypes={selectedRemediation:c().object,selectedRemediationStatus:c().object,loadRemediation:c().func.isRequired,loadRemediationStatus:c().func.isRequired,switchAutoReboot:c().func.isRequired,deleteRemediation:c().func.isRequired,executePlaybookBanner:c().shape({isVisible:c().bool}),addNotification:c().func.isRequired,playbookRuns:c().array,getPlaybookRuns:c().func,checkExecutable:c().func,executable:c().object};const Wt=(0,m.connect)((({selectedRemediation:e,selectedRemediationStatus:t,executePlaybookBanner:n,playbookRuns:a,executable:l})=>({selectedRemediation:e,selectedRemediationStatus:t,executePlaybookBanner:n,playbookRuns:a.data,remediation:e.remediation,executable:l})),(e=>({loadRemediation:t=>e(u.d5(t)),loadRemediationStatus:t=>e(u.uz(t)),switchAutoReboot:(t,n)=>e(u.o6(t,{auto_reboot:n})),deleteRemediation:t=>e(u.YW(t)),addNotification:t=>e((0,ot.wN)(t)),getPlaybookRuns:t=>e(u.Is(t)),checkExecutable:t=>e(u.lh(t))})))(Ut)},2648:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(10756),l=n.n(a),s=n(75863),i=n(43416),r=n(49004),o=n(32819),c=n(15433),m=n(87694),u=n(82814);class d extends l().Component{constructor(e){super(e),this.state={columns:[{title:l().createElement(o.Z,{size:"xs"})},{title:l().createElement(o.Z,{size:"sm"})},{title:l().createElement(o.Z,{size:"sm"})},{title:l().createElement(o.Z,{size:"md"})},{title:l().createElement(o.Z,{size:"sm"})}],rows:[[{title:l().createElement(o.Z,{size:"md"})},{title:l().createElement(o.Z,{size:"xs"})},{title:l().createElement(o.Z,{size:"xs"})},{title:l().createElement(o.Z,{size:"md"})},{title:l().createElement(o.Z,{size:"md"})}]]}}render(){const{columns:e,rows:t}=this.state;return l().createElement(a.Fragment,null,l().createElement(i.i,{cells:e,rows:t,"aria-label":"Loading",variant:s.B.compact,...this.props},l().createElement(r.x,null)),l().createElement(u.Z,{centered:!0},l().createElement(m.Z,null)),l().createElement(c.Z,{isFooter:!0,className:"rem-c-skeleton-table__footer rem-m-align-right"},l().createElement(o.Z,{size:"sm"})))}}const p=d}}]);
//# sourceMappingURL=../sourcemaps/RemediationDetails.91eb2ca5b7372a44ff90e128a707b93f.js.map