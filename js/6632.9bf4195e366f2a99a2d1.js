(self.webpackChunkremediations=self.webpackChunkremediations||[]).push([[6632],{98901:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Ge});var r=n(87462),a=n(71002),o=n(29439),i=n(93433),s=n(4942),l=n(92950),c=n.n(l),u=n(45697),m=n.n(u),d=n(89863),p=new(n(68004).HostsApi)(void 0,"/api/inventory/v1",d.ZP);function f(e,t){var n=t.page,r=t.perPage;return p.apiHostGetHostById(e,void 0,r,n)}var y,b=n(58061),v=n(15861),g=n(64687),h=n.n(g),E=n(16075),O=n(68718),w=n.n(O),S=function(){var e=(0,v.Z)(h().mark((function e(t){var n,r,a,i,s;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.mY(t.map((function(e){return e.id})));case 3:return n=e.sent,r=w()(n,(function(e,t,n){var r=(0,o.Z)(e,2),a=r[0],i=r[1];return t?a.push(t):i.push("Issue ".concat(n," does not have Ansible support")),[a,i]}),[[],[]]),a=(0,o.Z)(r,2),i=a[0],s=a[1],e.abrupt("return",{resolutions:i,warnings:s});case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",{errors:["Error obtaining resolution information. Please try again later."]});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),k=n(28216),j=n(57283),T=n.n(j),P=n(18546);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var R={isLoading:!1,hosts:[]};const I=(y={},(0,s.Z)(y,"".concat(b.mg,"_FULFILLED"),(function(e,t){var n=t.payload;return C(C({},e),{},{hosts:[].concat((0,i.Z)(e.hosts),(0,i.Z)(n.results||[])),isLoading:!1})})),(0,s.Z)(y,"".concat(b.mg,"_PENDING"),(function(e){return C(C({},e),{},{isLoading:!0})})),y);var x=n(39133),D=n(24350),F=n.n(D),N=n(5502),A=n(67850),B=n(96354),_=n(64124),q=n(86507),V=[{name:q.mT,component:"select-playbook",validate:[{type:_.Z.PATTERN,pattern:/^$|^.*[\w\d]+.*$/},{type:_.Z.REQUIRED}]},{name:q.yu,component:B.Z.TEXT_FIELD,hideField:!0},{name:q.m0,component:B.Z.TEXT_FIELD,hideField:!0},{name:q.Vf,component:B.Z.TEXT_FIELD,hideField:!0}],L=[{name:q.BA,component:"review-actions"}];var G=n(26854),z=n(14938),Y=n(39532),H=n(41693),W=n(48880),U=n(35664),M=n(52017),X=n(3428),J=function(e){var t=e.resolutionsCount;return(0,H.Z)(e).input.valid=!1,c().createElement(z.EmptyState,{variant:z.EmptyStateVariant.small,"data-component-ouia-id":"wizard-fetch-error"},c().createElement(z.EmptyStateIcon,{color:X.ZP.value,icon:M.ExclamationCircleIcon}),c().createElement(z.Title,{headingLevel:"h4",size:"lg"},"Unexpected error"),c().createElement(z.EmptyStateBody,null,"Please try again later."," ",0!==t&&c().createElement("div",null,"Hint: No resolutions for selected issues.")))};J.propTypes={resolutionsCount:m().number};const Q=J;var $=n(29521),K=n.n($),ee=n(18446),te=n.n(ee),ne=function(e){var t=e.issues,n=e.systems,r=e.allSystems,a=(0,H.Z)(e).input,s=(0,W.default)(),u=s.getState().values,m=(0,l.useState)(),d=(0,o.Z)(m,2),p=d[0],f=d[1],y=(0,l.useState)(u[q.yu]),b=(0,o.Z)(y,2),g=b[0],O=b[1],w=(0,l.useState)(u[q.yu]?"":a.value),S=(0,o.Z)(w,2),j=S[0],T=S[1],P=(0,l.useState)(u[q.m0]),Z=(0,o.Z)(P,2),C=Z[0],R=Z[1],I=(0,l.useState)(!1),x=(0,o.Z)(I,2),D=x[0],F=x[1],N=(0,k.useSelector)((function(e){var t=e.resolutionsReducer;return(null==t?void 0:t.errors)||[]}),k.shallowEqual),A=(0,k.useSelector)((function(e){var t=e.resolutionsReducer;return(null==t?void 0:t.warnings)||[]}),k.shallowEqual),B=(0,k.useSelector)((function(e){var t=e.resolutionsReducer;return(null==t?void 0:t.resolutions)||[]}),k.shallowEqual),_=(0,k.useSelector)((function(e){var t=e.resolutionsReducer;return null==t?void 0:t.isLoading}));return(0,l.useEffect)((function(){function e(){return e=(0,v.Z)(h().mark((function e(){var t,n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.lK();case 2:t=e.sent,n=t.data,f(n);case 5:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),(0,l.useEffect)((function(){var e;(null===(e=K()(B,u[q.Vf],te()))||void 0===e?void 0:e.length)>0&&(s.change(q.Vf,B),s.change(q.ko,(0,q.W3)(t,n,B)))})),N.length<=0?c().createElement(z.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-select-playbook"},c().createElement(z.StackItem,null,0!==A.length&&c().createElement(z.StackItem,null,c().createElement(z.Alert,{variant:"warning",isInline:!0,title:c().createElement(z.Text,null,"There ",(0,q._6)(A.length,"was","were")," ",c().createElement(z.Popover,{"aria-label":"Resolution error popover",bodyContent:c().createElement(l.Fragment,null,A.map((function(e,t){return c().createElement("div",{key:t},e)})))},c().createElement("b",null,c().createElement(z.Button,{variant:"link",isInline:!0},A.length)," ",(0,q._6)(A.length,"error")))," ","while fetching resolutions for your issues!"," ")})),c().createElement(z.TextContent,null,c().createElement(z.Text,null,"You selected"," ",c().createElement("b",null,"".concat(r.length," ").concat((0,q._6)(r.length,"system"))," "),"to remediate with Ansible, which in total includes"," ",c().createElement("b",null,"".concat(null==t?void 0:t.length," ").concat((0,q._6)(null==t?void 0:t.length,"issue"))," "),(null==t?void 0:t.length)===B.length||_?"which":c().createElement(l.Fragment,null,"of which ",c().createElement("b",null,B.length," "))," ","can be remediated by Ansible."))),c().createElement(z.StackItem,null,c().createElement(z.Grid,{hasGutter:!0},c().createElement(z.GridItem,{sm:12,md:6,lg:4},c().createElement(z.Radio,{label:p?"Add to existing playbook (".concat(p.length,")"):"Add to existing playbook","aria-label":"Add to existing playbook",id:"existing",name:"radio",isDisabled:!p||!p.length,defaultChecked:g,onChange:function(){O(!0),s.change(q.yu,!0),a.onChange((null==C?void 0:C.name)||""),s.change(q.m0,C)}})),c().createElement(z.GridItem,{sm:12,md:6,lg:4},p&&!D?c().createElement(z.FormSelect,{onChange:function(e){F(!0),E.NH(e).then((function(e){R(e),F(!1),g&&a.onChange(e.name),g&&s.change(q.m0,e)}))},value:(null==C?void 0:C.id)||"","aria-label":"Select an existing playbook"},null!=p&&p.length?[c().createElement(z.FormSelectOption,{key:"select-playbook-placeholder",value:"",label:"Select playbook",isDisabled:!0})].concat((0,i.Z)(p.map((function(e){var t=e.id,n=e.name;return c().createElement(z.FormSelectOption,{key:t,value:t,label:n})})))):c().createElement(z.FormSelectOption,{key:"empty",value:"empty",label:"No existing playbooks"})):c().createElement(U.Z,{size:U.i.lg})))),c().createElement(z.StackItem,null,c().createElement(z.Grid,{hasGutter:!0},c().createElement(z.GridItem,{sm:12,md:6,lg:4},c().createElement(z.Radio,{label:"Create new playbook","aria-label":"Create new playbook",id:"new",name:"radio",defaultChecked:!g,onChange:function(){O(!1),s.change(q.yu,!1),a.onChange(j),s.change(q.m0,void 0)}})),c().createElement(z.GridItem,{sm:12,md:6,lg:4},c().createElement(z.FormGroup,{fieldId:"remediation-name"},c().createElement(z.TextInput,{type:"text",value:j,onChange:function(e){T(e),g||a.onChange(e)},"aria-label":"Name your playbook",autoFocus:!0})))))):c().createElement(Q,null)};ne.propTypes={issues:m().arrayOf(m().shape({description:m().string,id:m().string})).isRequired,systems:m().arrayOf(m().string).isRequired,allSystems:m().arrayOf(m().string).isRequired};const re=ne;var ae=n(45987),oe=n(47285),ie=["issues","systems","allSystems","registry"];function se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?se(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=function(e){var t,n=e.issues,r=e.systems,a=e.allSystems,o=e.registry,u=(0,ae.Z)(e,ie),m=(0,k.useDispatch)(),d=(0,H.Z)(u).input,p=null===(t=(0,W.default)().getState().errors)||void 0===t?void 0:t.systems,f=(0,k.useSelector)((function(e){var t=e.entities;return((null==t?void 0:t.rows)||[]).length})),y=(0,k.useSelector)((function(e){var t=e.entities;return(null==t?void 0:t.selected)||[]})),b=(0,k.useSelector)((function(e){var t=e.entities;return null==t?void 0:t.loaded})),v=(0,k.useSelector)((function(e){var t=e.hostReducer.hosts;return(null==t?void 0:t.map((function(e){return{id:e.id,name:e.display_name}})))||[]}));(0,l.useEffect)((function(){var e=null==n?void 0:n.reduce((function(e,t){var n=(0,q.Y4)([].concat((0,i.Z)(r),(0,i.Z)(t.systems||[]))).filter((function(e){return null==y?void 0:y.includes(e)}));return le(le({},e),n.length>0?(0,s.Z)({},t.id,n):{})}),{});te()(d.value,e)||d.onChange(e)}),[y]);var g=function(e){m({type:q.Zp,payload:e})};return c().createElement(z.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-review-systems"},c().createElement(z.StackItem,null,c().createElement(z.TextContent,null,c().createElement(z.Text,null,"Review and optionally exclude systems from your selection."))),c().createElement(z.StackItem,null,c().createElement(oe.Z,{registry:o,allSystemsNamed:v,allSystems:a,hasCheckbox:!0,bulkSelect:{id:"select-systems",count:y.length,items:[{title:"Select none (0)",onClick:function(){return g(!1)}}].concat((0,i.Z)(b&&f>0?[{title:"Select page (".concat(f,")"),onClick:function(){return g(!0)}}]:[])),checked:y.length>0,onSelect:function(e){return g(e)}},onSelectRows:!0})),p&&b&&c().createElement(z.StackItem,null,c().createElement(M.ExclamationCircleIcon,{className:"ins-c-remediations-error pf-u-mr-sm"}),c().createElement("span",{className:"ins-c-remediations-error"},p)))};ce.propTypes={issues:m().arrayOf(m().shape({description:m().string,id:m().string})).isRequired,systems:m().arrayOf(m().string).isRequired,allSystems:m().arrayOf(m().string).isRequired,registry:m().instanceOf(P.ZP).isRequired};const ue=ce;var me=n(17855);function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fe=function(e){var t=(0,W.default)().getState().values,n=e.issues.filter((function(e){return Object.keys(t[q.vF]).includes(e.id)})),r=(0,H.Z)(e).input,a=(0,l.useState)({index:void 0,direction:void 0}),i=(0,o.Z)(a,2),s=i[0],u=i[1],m=(0,k.useSelector)((function(e){var t=e.hostReducer.hosts;return(null==t?void 0:t.map((function(e){return{id:e.id,name:e.display_name}})))||[]})),d=(t[q.yu]?t[q.ko].filter((function(e){return!t[q.m0].issues.some((function(t){return t.id===e.id}))})):t[q.ko]).map((function(e){return pe(pe({},e),{},{systems:t[q.vF][e.id]})})).filter((function(e){var t;return(null==e||null===(t=e.systems)||void 0===t?void 0:t.length)>0})),p=(0,l.useState)((0,q.TE)(d,s,!0,m)),f=(0,o.Z)(p,2),y=f[0],b=f[1];return(0,l.useEffect)((function(){b((0,q.TE)(d,s,!0,m))}),[s]),c().createElement(z.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-review-actions"},c().createElement(z.StackItem,null,c().createElement(z.TextContent,null,c().createElement(z.Text,null,"You have selected"," ",c().createElement("b",null,"".concat(n.length," ").concat((0,q._6)(n.length,"item")))," to remediate."," ",c().createElement("b",null,d.length," of"," ","".concat(n.length," ").concat((0,q._6)(n.length,"item"))),1!==d.length?" allow":" allows"," for you to chose from multiple resolution steps."))),c().createElement(z.StackItem,null,c().createElement(z.Radio,{label:"Review and/or change the resolution steps for ".concat(1!==d.length?"these":"this","\n                         ").concat(d.length," ").concat((0,q._6)(d.length,"action"),"."),id:"change",name:"radio",isChecked:r.value,onChange:function(){return r.onChange(!0)}}),n.length-d.length>0&&c().createElement(z.Text,{className:"rem-c-choose-actions-description"},"The ".concat(n.length-d.length," other selected ").concat((0,q._6)(n.length-d.length,"issue")," \n                    ").concat(n.length-d.length!=1?"do":"does"," not have multiple resolution options."))),c().createElement(me.Table,{"aria-label":"Actions",className:"ins-c-remediation-summary-table",variant:me.TableVariant.compact,onCollapse:function(e,t,n){return(0,q.ar)(e,t,n,y,b)},cells:[{title:"Action",transforms:[me.sortable]},{title:"Resolution",transforms:[me.sortable]},{title:"Reboot required",transforms:[me.sortable]},{title:"Systems",transforms:[me.sortable],cellFormatters:[me.expandable]}],rows:y,onSort:function(e,t,n){return u({index:t,direction:n})},sortBy:s},c().createElement(me.TableHeader,{noWrap:!0}),c().createElement(me.TableBody,null)),c().createElement(z.StackItem,null,c().createElement(z.Radio,{label:"Accept all recommended resolution steps for all actions",id:"accept",name:"radio",isChecked:!r.value,onChange:function(){return r.onChange(!1)}}),c().createElement(z.Text,{className:"rem-c-choose-actions-description"},"You may modify reboot status to manual reboot in the next step, or from the playbook.")))};fe.propTypes={issues:m().arrayOf(m().shape({description:m().string,id:m().string})).isRequired};const ye=fe;var be=n(45578),ve=n.n(be);function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ee=function(e){var t,n=e.issue,r=(0,W.default)(),a=r.getState().values[q.Vf],o=r.getState().values[q.vF][n.id]||[],i=(null===(t=a.find((function(e){return e.id===n.id})))||void 0===t?void 0:t.resolutions)||[],u=ve()(i,"id"),m=K()(i,u,te());return c().createElement(z.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-issue-resolution"},c().createElement(z.StackItem,null,c().createElement(z.Title,{headingLevel:"h2"},"Choose action: ".concat((0,q.u9)(n.id)))),c().createElement(z.StackItem,null,m.length>0&&c().createElement(z.StackItem,{className:"pf-u-mb-sm"},c().createElement(z.Alert,{variant:"warning",isInline:!0,title:c().createElement(z.Text,null,"There ",(0,q._6)(m.length,"was","were")," ",c().createElement(z.Popover,{"aria-label":"Resolution duplicates popover",bodyContent:c().createElement(l.Fragment,null,m.map((function(e,t){return c().createElement("div",{key:t},e.description)})))},c().createElement("b",null,c().createElement(z.Button,{variant:"link",isInline:!0},m.length)," ",(0,q._6)(m.length,"resolution")))," ","removed due to duplication")})),c().createElement(z.TextContent,null,c().createElement(z.Text,null,"Review the possible resolution steps and select which to add to your playbook."),c().createElement(z.Text,{className:"ins-c-remediations-action-description"},n.action),c().createElement(z.Text,{className:"ins-c-remediations-action-description"},"Resolution affects ".concat(o.length," ").concat((0,q._6)(o.length,"system"))))),c().createElement(z.StackItem,null,c().createElement("div",{className:"ins-c-resolution-container"},u.map((function(e,t){return c().createElement("div",{className:"ins-c-resolution-option",sm:12,md:6,lg:4,xl:3,key:e.id},c().createElement(z.Tile,{onClick:function(){return r.change(q.Tx,he(he({},r.getState().values[q.Tx]),{},(0,s.Z)({},n.id,e.id)))},isSelected:r.getState().values[q.Tx][n.id]?r.getState().values[q.Tx][n.id]===e.id:0===t,title:e.description},c().createElement(z.TextContent,{className:"pf-u-pt-sm"},c().createElement(z.Text,{className:"pf-u-mb-sm ins-c-playbook-description"},'Resolution from "',n.id.split(/:|\|/)[1],'"'),c().createElement("div",{className:"ins-c-reboot-required"},c().createElement(z.Text,{component:"span"},e.needs_reboot?"Reboot required":c().createElement("span",null,"Reboot ",c().createElement("b",null,"not")," required"))))))})))))};Ee.propTypes={issue:m().shape({id:m().string,action:m().string,alternate:m().number,systems:m().arrayOf(m().string)}).isRequired};const Oe=Ee;function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ke=function(e){var t=(0,W.default)(),n=t.getState().values[q.m0],r=t.getState().values[q.yu],a=t.getState().values[q.vF],i=Se(Se({},e),{},{data:Se(Se({},e.data),{},{issues:e.data.issues.filter((function(e){var t;return(null===(t=a[e.id])||void 0===t?void 0:t.length)>0}))})}),s=i.data,u=i.issuesById,m=(0,H.Z)(e).input,d=(0,l.useState)({index:void 0,direction:void 0}),p=(0,o.Z)(d,2),f=p[0],y=p[1],b=(0,k.useSelector)((function(e){var t=e.hostReducer.hosts;return(null==t?void 0:t.map((function(e){return{id:e.id,name:e.display_name}})))||[]})),v=s.issues.map((function(e){var n=(0,q.uG)(e.id,t.getState().values),r=(null==n?void 0:n[0])||{},o=r.description,i=r.needs_reboot;return{action:u[e.id].description,resolution:o,needsReboot:i,systems:a[e.id]}}));(0,l.useEffect)((function(){m.onChange(""!==m.value?m.value:r&&n.auto_reboot||v.some((function(e){return e.needsReboot})))}),[]);var g=(0,l.useState)((0,q.TE)(v,f,!1,b)),h=(0,o.Z)(g,2),E=h[0],O=h[1];return(0,l.useEffect)((function(){O((0,q.TE)(v,f,!1,b))}),[f]),c().createElement(z.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-review"},c().createElement(z.StackItem,null,c().createElement(z.TextContent,null,c().createElement(z.Text,null,"Issues listed below will be added to the playbook"," ",c().createElement("b",null,t.getState().values[q.mT]),"."))),v.some((function(e){return e.needsReboot}))&&c().createElement(z.StackItem,null,c().createElement(z.TextContent,null,c().createElement(z.Text,{className:"ins-c-playbook-reboot-required"},c().createElement(M.ExclamationTriangleIcon,null)," A system reboot is required to remediate selected issues"))),c().createElement(z.StackItem,null,c().createElement(z.TextContent,null,c().createElement(z.Text,null,"The playbook ",c().createElement("b",null,t.getState().values[q.mT]),m.value?" does":c().createElement("span",{className:"ins-c-remediation-danger-text"}," does not")," ","auto reboot systems."))),c().createElement(z.StackItem,null,c().createElement(z.Button,{variant:"link",isInline:!0,onClick:function(){return m.onChange(!m.value)}},"Turn ",m.value?"off":"on"," autoreboot")),c().createElement(me.Table,{"aria-label":"Actions",className:"ins-c-remediation-summary-table",variant:me.TableVariant.compact,cells:[{title:"Action",transforms:[me.sortable]},{title:"Resolution",transforms:[me.sortable]},{title:"Reboot required",transforms:[me.sortable]},{title:"Systems",transforms:[me.sortable],cellFormatters:[me.expandable]}],rows:E,onSort:function(e,t,n){return y({index:t,direction:n})},onCollapse:function(e,t,n){return(0,q.ar)(e,t,n,E,O)},sortBy:f},c().createElement(me.TableHeader,{noWrap:!0}),c().createElement(me.TableBody,null)))};ke.propTypes={data:m().shape({issues:m().array,systems:m().array,onRemediationCreated:m().func}).isRequired,issuesById:m().shape((0,s.Z)({},m().string,m().shape({id:m().string,description:m().string}))).isRequired};const je=ke;var Te;function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ze(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ce={isLoading:!1,resolutions:void 0};const Re=(Te={},(0,s.Z)(Te,"".concat(b.JY,"_FULFILLED"),(function(e,t){var n=t.payload;return Ze(Ze(Ze({},e),n),{},{isLoading:!1})})),(0,s.Z)(Te,"".concat(b.JY,"_PENDING"),(function(e){return Ze(Ze({},e),{},{isLoading:!0})})),Te);var Ie=n(48273),xe=function(e){var t,n,r=e.percent,a=e.failed;return 100===r?(n="Completed",t=Ie.ProgressVariant.success):a?(n="Error",t=Ie.ProgressVariant.danger):(n="In progress",t=Ie.ProgressVariant.info),c().createElement(Ie.Progress,{id:"finished-create-remediation",value:r,title:n,variant:t})};xe.propTypes={percent:m().number,failed:m().bool};const De=xe;var Fe,Ne=function(e){var t=e.onClose,n=e.setOpen,r=e.submitRemediation,a=e.setState,o=e.state,i={percent:o.percent,failed:o.failed,systems:(0,q.Y4)(Object.values(o.formValues[q.vF]).flat()),issues:Object.keys(o.formValues[q.vF]),playbook:{name:o.formValues[q.mT],id:o.id}},s=i.percent,l=i.failed,u=i.systems,m=i.issues,d=i.playbook;return c().createElement(z.EmptyState,{variant:z.EmptyStateVariant.large,"data-component-ouia-id":"wizard-progress"},c().createElement(z.EmptyStateIcon,{className:"pf-u-mb-lg pf-u-mt-sm",color:l?"var(--pf-global--danger-color--100)":100===s?"var(--pf-global--success-color--100)":void 0,icon:l?M.ExclamationCircleIcon:100===s?M.CheckCircleIcon:M.InProgressIcon}),c().createElement(z.Title,{headingLevel:"h1",size:"lg"},l?"Error: Unable to add items to playbook":100===s?"Items added to playbook":"Adding items to the playbook"),c().createElement(z.EmptyStateBody,{className:"pf-c-progress-bar pf-u-mt-md"},c().createElement(De,{percent:s,failed:l})),(l||100===s)&&c().createElement(z.EmptyStateBody,{className:"pf-c-progress-message"},l?"Please try again.":c().createElement("div",null,"".concat(m.length," ").concat((0,q._6)(m.length,"action")," affecting \n                        ").concat(u.length," ").concat((0,q._6)(u.length,"system")," \n                        ").concat(m.length>1?"were":"was"," added to the playbook "),c().createElement("a",{href:(0,q.B3)(d.id)},d.name),".")),100===s&&c().createElement(z.EmptyStateBody,{className:"pf-c-progress-message-description pf-u-mb-md"},"You can remediate these systems directly from Insights by enabling",c().createElement(z.Button,{className:"pf-u-py-0 pf-u-px-xs",variant:"link",ouiaId:"CloudConnectorButton",icon:c().createElement(M.ExternalLinkAltIcon,null),iconPosition:"right",isSmall:!0,onClick:function(){return window.location.href="".concat(window.location.origin,"/").concat((0,q.QU)(),"settings/connector")}},"Cloud Connector"),"on eligible systems."),l&&c().createElement(z.Button,{className:"pf-u-mt-md pf-u-mb-sm",variant:"primary",ouiaId:"TryAgainButton",onClick:function(){a({failed:!1,percent:0}),r(!1)}},"Try again"),100===s&&c().createElement(z.Button,{className:"pf-u-mt-md pf-u-mb-sm",variant:"primary",ouiaId:"ReturnToAppButton",onClick:function(){t(),n(!1)}},"Return to application"),c().createElement(z.EmptyStateSecondaryActions,null,l&&c().createElement(z.Button,{variant:"secondary",ouiaId:"BackToWizardButton",onClick:function(){t()}},"Go back to the wizard"),100===s&&c().createElement(z.Button,{variant:"link",component:"a",ouiaId:"OpenPlaybookButton",href:(0,q.B3)(d.id),onClick:function(){t(),n(!1)}},"Open playbook ",d.name)))};Ne.propTypes={onClose:m().func,setOpen:m().func,submitRemediation:m().func,setState:m().func,state:m().shape({id:m().string,percent:m().number.isRequired,failed:m().bool.isRequired,formValues:m().shape((Fe={},(0,s.Z)(Fe,q.mT,m().string),(0,s.Z)(Fe,q.vF,m().objectOf(m().arrayOf(m().string))),Fe))})};const Ae=Ne;function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qe={submitted:!1,id:void 0,percent:0,failed:!1,formValues:void 0},Ve=function(e,t){switch(t.type){case"schema":return _e(_e({},e),{},{schema:t.payload});case"state":return _e(_e({},e),t.payload);default:throw new Error}},Le=function(e){var t,n,u,m=e.setOpen,d=e.data,p=e.basePath,y=e.registry,v=(0,l.useRef)((0,q.Y4)(null===(t=d.issues)||void 0===t?void 0:t.reduce((function(e,t){return[].concat((0,i.Z)(e),(0,i.Z)(t.systems||[]))}),(0,i.Z)(d.systems||[])))),g=(0,k.useDispatch)(),h=(0,l.useReducer)(Ve,qe),E=(0,o.Z)(h,2),O=E[0],w=E[1],j=F()(d.issues,(function(e){return e.id}));(0,l.useEffect)((function(){var e;w({type:"schema",payload:(e=d.issues,{fields:[{component:B.Z.WIZARD,name:"remediations-wizard",isDynamic:!0,inModal:!0,showTitles:!0,title:"Remediate with Ansible",description:"Add actions to an Ansible Playbook",fields:[{name:"playbook",title:"Select playbook",fields:V,nextStep:"systems"},{name:"systems",title:"Review systems",fields:[{name:q.vF,component:"review-systems",validate:[{type:"validate-systems"}]}],nextStep:function(e){return((t=e.values)[q.yu]?t[q.ko].filter((function(e){return!t[q.m0].issues.some((function(n){return n.id===e.id&&Object.keys(t[q.vF]).includes(e.id)}))})):t[q.ko].filter((function(e){return Object.keys(t[q.vF]).includes(e.id)}))).length>0?"actions":"review";var t}},{name:"actions",title:"Review and edit actions",fields:L,nextStep:function(e){return t=e.values,r=t[q.yu]?t[q.ko].filter((function(e){return!t[q.m0].issues.some((function(t){return t.id===e.id}))&&Object.keys(t[q.vF]).includes(e.id)})):t[q.ko].filter((function(e){return Object.keys(t[q.vF]).includes(e.id)})),t[q.BA]?null===(n=r[0])||void 0===n?void 0:n.id:"review";var t,n,r}}].concat((0,i.Z)((null==e?void 0:e.map((function(e){return{name:e.id,title:(0,q.u9)(e.id),showTitle:!1,fields:[{name:e.id,component:"issue-resolution",issue:e},{name:q.Tx,component:B.Z.TEXT_FIELD,hideField:!0}],nextStep:function(t){return function(e,t){var n,r=e[q.yu]?e[q.ko].filter((function(t){return!e[q.m0].issues.some((function(n){return n.id===t.id&&Object.keys(e[q.vF]).includes(t.id)}))})):e[q.ko].filter((function(t){return Object.keys(e[q.vF]).includes(t.id)}));return(null===(n=r.slice(r.findIndex((function(e){return e.id===t.id}))+1,r.length)[0])||void 0===n?void 0:n.id)||"review"}(t.values,e)},substepOf:"Choose actions"}})))||[]),[{name:"review",title:"Remediation review",fields:[{name:q.Ej,component:"review"}]}])}]})}),y.register({hostReducer:(0,x.applyReducerHash)(I,R),resolutionsReducer:(0,x.applyReducerHash)(Re,Ce)}),g(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:b.JY,payload:S(e)}}(d.issues)),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,q.C1)(e,50).forEach((function(e){g(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:b.mg,payload:f(e,t)}}(e,{page:1,perPage:50}))}))}(v.current)}),[]);var T={"select-playbook":{component:re,issues:d.issues,systems:d.systems,allSystems:v.current},"review-systems":{component:ue,issues:d.issues,systems:d.systems||[],allSystems:v.current,registry:y},"review-actions":{component:ye,issues:d.issues},"issue-resolution":{component:Oe},review:{component:je,data:d,issuesById:j}},P={"validate-systems":function(){return function(e){return e&&Object.values(e).filter((function(e){return void 0!==(0,a.Z)(e)})).length?void 0:"At least one system must be selected. Actions must be associated to a system to be added to a playbook."}}};return c().createElement(l.Fragment,null,O.schema&&!O.submitted?c().createElement(N.Z,{schema:O.schema,subscription:{values:!0},FormTemplate:function(e){return c().createElement(A.ZP,(0,r.Z)({},e,{showFormControls:!1}))},initialValues:(n={},(0,s.Z)(n,q.Vf,[]),(0,s.Z)(n,q.ko,[]),(0,s.Z)(n,q.vF,{}),(0,s.Z)(n,q.BA,!0),(0,s.Z)(n,q.Tx,{}),(0,s.Z)(n,q.yu,!1),n),componentMapper:_e((u={},(0,s.Z)(u,B.Z.WIZARD,{component:G.Z,className:"remediations","data-ouia-component-id":"remediation-wizard"}),(0,s.Z)(u,B.Z.TEXT_FIELD,Y.Z),u),T),validatorMapper:P,onSubmit:function(e){w({type:"state",payload:{submitted:!0,formValues:e}}),(0,q.ec)(e,d,p,(function(e){return w({type:"state",payload:e})}))},onCancel:function(){return m(!1)}}):null,O.submitted?c().createElement(z.Modal,{isOpen:!0,variant:z.ModalVariant.large,showClose:!1,className:"remediations",hasNoBodyWrapper:!0,"aria-describedby":"wiz-modal-description","aria-labelledby":"wiz-modal-title"},c().createElement(z.Wizard,{className:"remediations",title:"Remediate with Ansible",description:"Add actions to an Ansible Playbook",steps:[{name:"progress",component:c().createElement(Ae,{onClose:function(){w({type:"state",payload:{submitted:!1,id:void 0,failed:!1,formValues:void 0}})},title:"Adding items to the playbook",setOpen:m,submitRemediation:function(){return(0,q.ec)(O.formValues,d,p,(function(e){return w({type:"state",payload:e})}))},setState:function(e){return w({type:"state",payload:e})},state:O}),isFinishedStep:!0}],onClose:function(){w({type:"state",payload:{submitted:!1,id:void 0,failed:!1,formValues:void 0}}),m(!1)}})):null)};Le.propTypes={setOpen:m().func.isRequired,data:m().shape({issues:m().arrayOf(m().shape({description:m().string,id:m().string})),systems:m().arrayOf(m().string),onRemediationCreated:m().func}).isRequired,basePath:m().string,registry:m().shape({register:m().func}).isRequired};const Ge=function(e){var t=(0,l.useState)(),n=(0,o.Z)(t,2),a=n[0],i=n[1];return(0,l.useEffect)((function(){i((function(){return new P.ZP({},[T()])}))}),[]),null!=a&&a.store?c().createElement(k.Provider,{store:a.store},c().createElement(Le,(0,r.Z)({},e,{registry:a}))):null}},45467:()=>{},65088:()=>{},81754:()=>{},70347:()=>{},11452:()=>{},34946:()=>{},10108:()=>{},80897:()=>{},90479:()=>{},78752:()=>{},25238:()=>{},37739:()=>{},66822:()=>{},314:()=>{},49854:()=>{},40209:()=>{},87234:()=>{},11177:()=>{}}]);
//# sourceMappingURL=../sourcemaps/6632.e3e4110ea8045fe8e1f797c5854ff375.js.map