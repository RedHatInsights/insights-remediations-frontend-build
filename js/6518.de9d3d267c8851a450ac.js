(self.webpackChunkremediations=self.webpackChunkremediations||[]).push([[6518],{98901:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ze});var r=n(87462),a=n(29439),o=n(93433),i=n(4942),s=n(10756),l=n.n(s),c=n(45697),u=n.n(c),d=n(33366),m=new(n(68004).HostsApi)(void 0,"/api/inventory/v1",d.ZP);function p(e,t){var n=t.page,r=t.perPage;return m.apiHostGetHostById(e,void 0,r,n)}var f=n(58061),y=n(15861),b=n(64687),v=n.n(b),g=n(73725),h=n(68718),E=n.n(h),O=function(){var e=(0,y.Z)(v().mark((function e(t){var n,r,o,i,s;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.mY(t.map((function(e){return e.id})));case 3:return n=e.sent,r=E()(n,(function(e,t,n){var r=(0,a.Z)(e,2),o=r[0],i=r[1];return t?o.push(t):i.push("Issue ".concat(n," does not have Ansible support")),[o,i]}),[[],[]]),o=(0,a.Z)(r,2),i=o[0],s=o[1],e.abrupt("return",{resolutions:i,warnings:s});case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",{errors:["Error obtaining resolution information. Please try again later."]});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),w=n(28216),k=n(57283),S=n.n(k),j=n(18546);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Z={isLoading:!1,hosts:[]};const C=(0,i.Z)((0,i.Z)({},"".concat(f.mg,"_FULFILLED"),(function(e,t){var n=t.payload;return T(T({},e),{},{hosts:[].concat((0,o.Z)(e.hosts),(0,o.Z)(n.results||[])),isLoading:!1})})),"".concat(f.mg,"_PENDING"),(function(e){return T(T({},e),{},{isLoading:!0})}));var R=n(39133),x=n(24350),I=n.n(x),D=n(5502),F=n(67850),N=n(96354),A=n(64124),B=n(86507),_=[{name:B.mT,component:"select-playbook",validate:[{type:A.Z.PATTERN,pattern:/^$|^.*[\w\d]+.*$/},{type:A.Z.REQUIRED}]},{name:B.yu,component:N.Z.TEXT_FIELD,hideField:!0},{name:B.m0,component:N.Z.TEXT_FIELD,hideField:!0},{name:B.Vf,component:N.Z.TEXT_FIELD,hideField:!0}],q=[{name:B.BA,component:"review-actions"}];var V=n(26854),L=n(26318),z=n(9820),G=n(11395),Y=n(95762),H=n(48880),W=n(35664),U=n(42908),M=n(3428),X=function(e){var t=e.resolutionsCount;return(0,Y.Z)(e).input.valid=!1,l().createElement(L.EmptyState,{variant:L.EmptyStateVariant.sm,"data-component-ouia-id":"wizard-fetch-error"},l().createElement(L.EmptyStateHeader,{titleText:"Unexpected error",icon:l().createElement(L.EmptyStateIcon,{color:M.ZP.value,icon:U.ExclamationCircleIcon}),headingLevel:"h4"}),l().createElement(L.EmptyStateBody,null,"Please try again later."," ",0!==t&&l().createElement("div",null,"Hint: No resolutions for selected issues.")))};X.propTypes={resolutionsCount:u().number};const J=X;var Q=n(29521),$=n.n(Q),K=n(18446),ee=n.n(K),te=function(e){var t=e.issues,n=e.systems,r=e.allSystems,i=(0,Y.Z)(e).input,c=(0,H.default)(),u=c.getState().values,d=(0,s.useState)(),m=(0,a.Z)(d,2),p=m[0],f=m[1],b=(0,s.useState)(u[B.yu]),h=(0,a.Z)(b,2),E=h[0],O=h[1],k=(0,s.useState)(u[B.yu]?"":i.value),S=(0,a.Z)(k,2),j=S[0],P=S[1],T=(0,s.useState)(u[B.m0]),Z=(0,a.Z)(T,2),C=Z[0],R=Z[1],x=(0,s.useState)(!1),I=(0,a.Z)(x,2),D=I[0],F=I[1],N=(0,w.useSelector)((function(e){var t=e.resolutionsReducer;return(null==t?void 0:t.errors)||[]}),w.shallowEqual),A=(0,w.useSelector)((function(e){var t=e.resolutionsReducer;return(null==t?void 0:t.warnings)||[]}),w.shallowEqual),_=(0,w.useSelector)((function(e){var t=e.resolutionsReducer;return(null==t?void 0:t.resolutions)||[]}),w.shallowEqual),q=(0,w.useSelector)((function(e){var t=e.resolutionsReducer;return null==t?void 0:t.isLoading}));return(0,s.useEffect)((function(){function e(){return e=(0,y.Z)(v().mark((function e(){var t,n;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.lK();case 2:t=e.sent,n=t.data,f(n);case 5:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),(0,s.useEffect)((function(){var e;(null===(e=$()(_,u[B.Vf],ee()))||void 0===e?void 0:e.length)>0&&(c.change(B.Vf,_),c.change(B.ko,(0,B.W3)(t,n,_)))})),N.length<=0?l().createElement(L.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-select-playbook"},l().createElement(L.StackItem,null,0!==A.length&&l().createElement(L.StackItem,null,l().createElement(L.Alert,{variant:"warning",isInline:!0,title:l().createElement(L.Text,null,"There ",(0,B._6)(A.length,"was","were")," ",l().createElement(L.Popover,{"aria-label":"Resolution error popover",bodyContent:l().createElement(s.Fragment,null,A.map((function(e,t){return l().createElement("div",{key:t},e)})))},l().createElement("b",null,l().createElement(L.Button,{variant:"link",isInline:!0},A.length)," ",(0,B._6)(A.length,"error")))," ","while fetching resolutions for your issues!"," ")})),l().createElement(L.TextContent,null,l().createElement(L.Text,null,"You selected"," ",l().createElement("b",null,"".concat(r.length," ").concat((0,B._6)(r.length,"system"))," "),"to remediate with Ansible, which in total includes"," ",l().createElement("b",null,"".concat(null==t?void 0:t.length," ").concat((0,B._6)(null==t?void 0:t.length,"issue"))," "),(null==t?void 0:t.length)===_.length||q?"which":l().createElement(s.Fragment,null,"of which ",l().createElement("b",null,_.length," "))," ","can be remediated by Ansible."))),l().createElement(L.StackItem,null,l().createElement(L.Grid,{hasGutter:!0},l().createElement(L.GridItem,{sm:12,md:6,lg:4},l().createElement(L.Radio,{label:p?"Add to existing playbook (".concat(p.length,")"):"Add to existing playbook","aria-label":"Add to existing playbook",id:"existing",name:"radio",isDisabled:!p||!p.length,defaultChecked:E,onChange:function(){O(!0),c.change(B.yu,!0),i.onChange((null==C?void 0:C.name)||""),c.change(B.m0,C)}})),l().createElement(L.GridItem,{sm:12,md:6,lg:4},p&&!D?l().createElement(L.FormSelect,{onChange:function(e,t){F(!0),g.NH(t).then((function(e){R(e),F(!1),E&&i.onChange(e.name),E&&c.change(B.m0,e)}))},value:(null==C?void 0:C.id)||"","aria-label":"Select an existing playbook"},null!=p&&p.length?[l().createElement(L.FormSelectOption,{key:"select-playbook-placeholder","data-testid":"select-playbook-placeholder",value:"",label:"Select playbook",isDisabled:!0})].concat((0,o.Z)(p.map((function(e){var t=e.id,n=e.name;return l().createElement(L.FormSelectOption,{key:t,value:t,label:n})})))):l().createElement(L.FormSelectOption,{key:"empty",value:"empty",label:"No existing playbooks"})):l().createElement(W.Z,{size:W.i.lg,"data-testid":"skeleton-loader"})))),l().createElement(L.StackItem,null,l().createElement(L.Grid,{hasGutter:!0},l().createElement(L.GridItem,{sm:12,md:6,lg:4},l().createElement(L.Radio,{label:"Create new playbook","aria-label":"Create new playbook",id:"new",name:"radio",defaultChecked:!E,onChange:function(){O(!1),c.change(B.yu,!1),i.onChange(j),c.change(B.m0,void 0)}})),l().createElement(L.GridItem,{sm:12,md:6,lg:4},l().createElement(L.FormGroup,{fieldId:"remediation-name"},l().createElement(L.TextInput,{type:"text",value:j,onChange:function(e,t){P(t),E||i.onChange(t)},"aria-label":"Name your playbook",autoFocus:!0})))))):l().createElement(J,null)};te.propTypes={issues:u().arrayOf(u().shape({description:u().string,id:u().string})).isRequired,systems:u().arrayOf(u().string).isRequired,allSystems:u().arrayOf(u().string).isRequired};const ne=te;var re=n(45987),ae=n(47285),oe=["issues","systems","allSystems","registry"];function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var le=function(e){var t,n=e.issues,r=e.systems,a=e.allSystems,c=e.registry,u=(0,re.Z)(e,oe),d=(0,w.useDispatch)(),m=(0,Y.Z)(u).input,p=null===(t=(0,H.default)().getState().errors)||void 0===t?void 0:t.systems,f=(0,w.useSelector)((function(e){var t=e.entities;return((null==t?void 0:t.rows)||[]).length})),y=(0,w.useSelector)((function(e){var t=e.entities;return(null==t?void 0:t.selected)||[]})),b=(0,w.useSelector)((function(e){var t=e.entities;return null==t?void 0:t.loaded})),v=(0,w.useSelector)((function(e){var t=e.hostReducer.hosts;return(null==t?void 0:t.map((function(e){return{id:e.id,name:e.display_name}})))||[]}));(0,s.useEffect)((function(){var e=null==n?void 0:n.reduce((function(e,t){var n=(0,B.Y4)([].concat((0,o.Z)(r),(0,o.Z)(t.systems||[]))).filter((function(e){return null==y?void 0:y.includes(e)}));return se(se({},e),n.length>0?(0,i.Z)({},t.id,n):{})}),{});ee()(m.value,e)||m.onChange(e)}),[y]);var g=function(e){d({type:B.Zp,payload:e})};return l().createElement(L.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-review-systems","data-testid":"wizard-review-systems"},l().createElement(L.StackItem,null,l().createElement(L.TextContent,null,l().createElement(L.Text,null,"Review and optionally exclude systems from your selection."))),l().createElement(L.StackItem,null,l().createElement(ae.Z,{registry:c,allSystemsNamed:v,allSystems:a,hasCheckbox:!0,bulkSelect:{id:"select-systems",count:y.length,items:[{title:"Select none (0)",onClick:function(){return g(!1)}}].concat((0,o.Z)(b&&f>0?[{title:"Select page (".concat(f,")"),onClick:function(){return g(!0)}}]:[])),checked:y.length>0,onSelect:function(e){return g(e)}},onSelectRows:!0})),p&&b&&l().createElement(L.StackItem,null,l().createElement(U.ExclamationCircleIcon,{className:"ins-c-remediations-error pf-u-mr-sm"}),l().createElement("span",{className:"ins-c-remediations-error"},p)))};le.propTypes={issues:u().arrayOf(u().shape({description:u().string,id:u().string})).isRequired,systems:u().arrayOf(u().string).isRequired,allSystems:u().arrayOf(u().string).isRequired,registry:u().instanceOf(j.ZP).isRequired};const ce=le;var ue=n(2311),de=n(35981),me=n(49004),pe=n(58027);function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var be=function(e){var t=(0,H.default)().getState().values,n=e.issues.filter((function(e){return Object.keys(t[B.vF]).includes(e.id)})),r=(0,Y.Z)(e).input,o=(0,s.useState)({index:void 0,direction:void 0}),i=(0,a.Z)(o,2),c=i[0],u=i[1],d=(0,w.useSelector)((function(e){var t=e.hostReducer.hosts;return(null==t?void 0:t.map((function(e){return{id:e.id,name:e.display_name}})))||[]})),m=(t[B.yu]?t[B.ko].filter((function(e){return!t[B.m0].issues.some((function(t){return t.id===e.id}))})):t[B.ko]).map((function(e){return ye(ye({},e),{},{systems:t[B.vF][e.id]})})).filter((function(e){var t;return(null==e||null===(t=e.systems)||void 0===t?void 0:t.length)>0})),p=(0,s.useState)((0,B.TE)(m,c,!0,d)),f=(0,a.Z)(p,2),y=f[0],b=f[1];return(0,s.useEffect)((function(){b((0,B.TE)(m,c,!0,d))}),[c]),l().createElement(L.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-review-actions","data-testid":"wizard-review-actions"},l().createElement(L.StackItem,null,l().createElement(L.TextContent,null,l().createElement(L.Text,null,"You have selected"," ",l().createElement("b",null,"".concat(n.length," ").concat((0,B._6)(n.length,"item")))," to remediate."," ",l().createElement("b",null,m.length," of"," ","".concat(n.length," ").concat((0,B._6)(n.length,"item"))),1!==m.length?" allow":" allows"," for you to chose from multiple resolution steps."))),l().createElement(L.StackItem,null,l().createElement(L.Radio,{label:"Review and/or change the resolution steps for ".concat(1!==m.length?"these":"this","\n                         ").concat(m.length," ").concat((0,B._6)(m.length,"action"),"."),id:"change",name:"radio",isChecked:r.value,onChange:function(){return r.onChange(!0)}}),n.length-m.length>0&&l().createElement(L.Text,{className:"rem-c-choose-actions-description"},"The ".concat(n.length-m.length," other selected ").concat((0,B._6)(n.length-m.length,"issue")," \n                    ").concat(n.length-m.length!=1?"do":"does"," not have multiple resolution options."))),l().createElement(de.i,{"aria-label":"Actions",className:"ins-c-remediation-summary-table",variant:ue.TableVariant.compact,onCollapse:function(e,t,n){return(0,B.ar)(e,t,n,y,b)},cells:[{title:"Action",transforms:[ue.sortable]},{title:"Resolution",transforms:[ue.sortable]},{title:"Reboot required",transforms:[ue.sortable]},{title:"Systems",transforms:[ue.sortable],cellFormatters:[ue.expandable]}],rows:y,onSort:function(e,t,n){return u({index:t,direction:n})},sortBy:c},l().createElement(me.x,{noWrap:!0}),l().createElement(pe.R,null)),l().createElement(L.StackItem,null,l().createElement(L.Radio,{label:"Accept all recommended resolution steps for all actions",id:"accept",name:"radio",isChecked:!r.value,onChange:function(){return r.onChange(!1)}}),l().createElement(L.Text,{className:"rem-c-choose-actions-description"},"You may modify reboot status to manual reboot in the next step, or from the playbook.")))};be.propTypes={issues:u().arrayOf(u().shape({description:u().string,id:u().string})).isRequired};const ve=be;var ge=n(45578),he=n.n(ge);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var we=function(e){var t,n=e.issue,r=(0,H.default)(),a=r.getState().values[B.Vf],o=r.getState().values[B.vF][n.id]||[],c=(null===(t=a.find((function(e){return e.id===n.id})))||void 0===t?void 0:t.resolutions)||[],u=he()(c,"id"),d=$()(c,u,ee());return l().createElement(L.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-issue-resolution"},l().createElement(L.StackItem,null,l().createElement(L.Title,{headingLevel:"h2"},"Choose action: ".concat((0,B.u9)(n.id)))),l().createElement(L.StackItem,null,d.length>0&&l().createElement(L.StackItem,{className:"pf-u-mb-sm"},l().createElement(L.Alert,{variant:"warning",isInline:!0,title:l().createElement(L.Text,null,"There ",(0,B._6)(d.length,"was","were")," ",l().createElement(L.Popover,{"aria-label":"Resolution duplicates popover",bodyContent:l().createElement(s.Fragment,null,d.map((function(e,t){return l().createElement("div",{key:t},e.description)})))},l().createElement("b",null,l().createElement(L.Button,{variant:"link",isInline:!0},d.length)," ",(0,B._6)(d.length,"resolution")))," ","removed due to duplication")})),l().createElement(L.TextContent,null,l().createElement(L.Text,null,"Review the possible resolution steps and select which to add to your playbook."),l().createElement(L.Text,{className:"ins-c-remediations-action-description"},n.action),l().createElement(L.Text,{className:"ins-c-remediations-action-description"},"Resolution affects ".concat(o.length," ").concat((0,B._6)(o.length,"system"))))),l().createElement(L.StackItem,null,l().createElement("div",{className:"ins-c-resolution-container"},u.map((function(e,t){return l().createElement("div",{className:"ins-c-resolution-option",key:e.id},l().createElement(L.Tile,{onClick:function(){return r.change(B.Tx,Oe(Oe({},r.getState().values[B.Tx]),{},(0,i.Z)({},n.id,e.id)))},isSelected:r.getState().values[B.Tx][n.id]?r.getState().values[B.Tx][n.id]===e.id:0===t,title:e.description},l().createElement(L.TextContent,{className:"pf-u-pt-sm"},l().createElement(L.Text,{className:"pf-u-mb-sm ins-c-playbook-description"},'Resolution from "',n.id.split(/:|\|/)[1],'"'),l().createElement("div",{className:"ins-c-reboot-required"},l().createElement(L.Text,{component:"span"},e.needs_reboot?"Reboot required":l().createElement("span",null,"Reboot ",l().createElement("b",null,"not")," required"))))))})))))};we.propTypes={issue:u().shape({id:u().string,action:u().string,alternate:u().number,systems:u().arrayOf(u().string)}).isRequired};const ke=we;function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pe=function(e){var t=(0,H.default)(),n=t.getState().values[B.m0],r=t.getState().values[B.yu],o=t.getState().values[B.vF],i=je(je({},e),{},{data:je(je({},e.data),{},{issues:e.data.issues.filter((function(e){var t;return(null===(t=o[e.id])||void 0===t?void 0:t.length)>0}))})}),c=i.data,u=i.issuesById,d=(0,Y.Z)(e).input,m=(0,s.useState)({index:void 0,direction:void 0}),p=(0,a.Z)(m,2),f=p[0],y=p[1],b=(0,w.useSelector)((function(e){var t=e.hostReducer.hosts;return(null==t?void 0:t.map((function(e){return{id:e.id,name:e.display_name}})))||[]})),v=c.issues.map((function(e){var n=(0,B.uG)(e.id,t.getState().values),r=(null==n?void 0:n[0])||{},a=r.description,i=r.needs_reboot;return{action:u[e.id].description,resolution:a,needsReboot:i,systems:o[e.id]}}));(0,s.useEffect)((function(){d.onChange(""!==d.value?d.value:r&&n.auto_reboot||v.some((function(e){return e.needsReboot})))}),[]);var g=(0,s.useState)((0,B.TE)(v,f,!1,b)),h=(0,a.Z)(g,2),E=h[0],O=h[1];return(0,s.useEffect)((function(){O((0,B.TE)(v,f,!1,b))}),[f]),l().createElement(L.Stack,{hasGutter:!0,"data-component-ouia-id":"wizard-review","data-testid":"wizard-review"},l().createElement(L.StackItem,null,l().createElement(L.TextContent,null,l().createElement(L.Text,null,"Issues listed below will be added to the playbook"," ",l().createElement("b",null,t.getState().values[B.mT]),"."))),v.some((function(e){return e.needsReboot}))&&l().createElement(L.StackItem,null,l().createElement(L.TextContent,null,l().createElement(L.Text,{className:"ins-c-playbook-reboot-required"},l().createElement(U.ExclamationTriangleIcon,null)," A system reboot is required to remediate selected issues"))),l().createElement(L.StackItem,null,l().createElement(L.TextContent,null,l().createElement(L.Text,null,"The playbook ",l().createElement("b",null,t.getState().values[B.mT]),d.value?" does":l().createElement("span",{className:"ins-c-remediation-danger-text"}," does not")," ","auto reboot systems."))),l().createElement(L.StackItem,null,l().createElement(L.Button,{"data-testid":"autoreboot-button",variant:"link",isInline:!0,onClick:function(){return d.onChange(!d.value)}},"Turn ",d.value?"off":"on"," autoreboot")),l().createElement(de.i,{"aria-label":"Actions",className:"ins-c-remediation-summary-table",variant:ue.TableVariant.compact,cells:[{title:"Action",transforms:[ue.sortable]},{title:"Resolution",transforms:[ue.sortable]},{title:"Reboot required",transforms:[ue.sortable]},{title:"Systems",transforms:[ue.sortable],cellFormatters:[ue.expandable]}],rows:E,onSort:function(e,t,n){return y({index:t,direction:n})},onCollapse:function(e,t,n){return(0,B.ar)(e,t,n,E,O)},sortBy:f},l().createElement(me.x,{noWrap:!0}),l().createElement(pe.R,null)))};Pe.propTypes={data:u().shape({issues:u().array,systems:u().array,onRemediationCreated:u().func}).isRequired,issuesById:u().shape((0,i.Z)({},u().string,u().shape({id:u().string,description:u().string}))).isRequired};const Te=Pe;function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re={isLoading:!1,resolutions:void 0};const xe=(0,i.Z)((0,i.Z)({},"".concat(f.JY,"_FULFILLED"),(function(e,t){var n=t.payload;return Ce(Ce(Ce({},e),n),{},{isLoading:!1})})),"".concat(f.JY,"_PENDING"),(function(e){return Ce(Ce({},e),{},{isLoading:!0})}));var Ie=n(48273),De=function(e){var t,n,r=e.percent,a=e.failed;return 100===r?(n="Completed",t=Ie.ProgressVariant.success):a?(n="Error",t=Ie.ProgressVariant.danger):(n="In progress",t=Ie.ProgressVariant.info),l().createElement(Ie.Progress,{"data-testid":"finished-create-remediation",value:r,title:n,variant:t})};De.propTypes={percent:u().number,failed:u().bool};const Fe=De;var Ne=function(e){var t=e.onClose,n=e.setOpen,r=e.submitRemediation,a=e.setState,o=e.state,i={percent:o.percent,failed:o.failed,systems:(0,B.Y4)(Object.values(o.formValues[B.vF]).flat()),issues:Object.keys(o.formValues[B.vF]),playbook:{name:o.formValues[B.mT],id:o.id}},s=i.percent,c=i.failed,u=i.systems,d=i.issues,m=i.playbook;return l().createElement(L.EmptyState,{variant:L.EmptyStateVariant.lg,"data-testid":"wizard-progress","data-component-ouia-id":"wizard-progress"},l().createElement(L.EmptyStateHeader,{titleText:l().createElement(l().Fragment,null,c?"Error: Unable to add items to playbook":100===s?"Items added to playbook":"Adding items to the playbook"),icon:l().createElement(L.EmptyStateIcon,{className:"pf-u-mb-lg pf-u-mt-sm",color:c?"var(--pf-global--danger-color--100)":100===s?"var(--pf-global--success-color--100)":void 0,icon:c?U.ExclamationCircleIcon:100===s?U.CheckCircleIcon:U.InProgressIcon}),headingLevel:"h1"}),l().createElement(L.EmptyStateBody,{className:"pf-c-progress-bar pf-u-mt-md"},l().createElement(Fe,{percent:s,failed:c})),l().createElement(L.EmptyStateFooter,null,(c||100===s)&&l().createElement(L.EmptyStateBody,{className:"pf-c-progress-message"},c?"Please try again.":l().createElement("div",null,"".concat(d.length," ").concat((0,B._6)(d.length,"action")," affecting \n                        ").concat(u.length," ").concat((0,B._6)(u.length,"system")," \n                        ").concat(d.length>1?"were":"was"," added to the playbook "),l().createElement("a",{href:(0,B.B3)(m.id)},m.name),".")),100===s&&l().createElement(L.EmptyStateBody,{className:"pf-c-progress-message-description pf-u-mb-md"},"You can remediate these systems directly from Insights by enabling",l().createElement(L.Button,{className:"pf-u-py-0 pf-u-px-xs",variant:"link",ouiaId:"CloudConnectorButton",icon:l().createElement(U.ExternalLinkAltIcon,null),iconPosition:"right",size:"sm",onClick:function(){return window.location.href="".concat(window.location.origin,"/").concat((0,B.QU)(),"settings/connector")}},"Cloud Connector"),"on eligible systems."),c&&l().createElement(L.Button,{className:"pf-u-mt-md pf-u-mb-sm",variant:"primary",ouiaId:"TryAgainButton","data-testid":"TryAgainButton",onClick:function(){a({failed:!1,percent:0}),r(!1)}},"Try again"),100===s&&l().createElement(L.Button,{className:"pf-u-mt-md pf-u-mb-sm",variant:"primary",ouiaId:"ReturnToAppButton",onClick:function(){t(),n(!1)}},"Return to application"),l().createElement(L.EmptyStateActions,null,c&&l().createElement(L.Button,{variant:"secondary",ouiaId:"BackToWizardButton","data-testid":"BackToWizardButton",onClick:function(){t()}},"Go back to the wizard"),100===s&&l().createElement(L.Button,{variant:"link",component:"a",ouiaId:"OpenPlaybookButton","data-testid":"OpenPlaybookButton",href:(0,B.B3)(m.id),onClick:function(){t(),n(!1)}},"Open playbook ",m.name))))};Ne.propTypes={onClose:u().func,setOpen:u().func,submitRemediation:u().func,setState:u().func,state:u().shape({id:u().string,percent:u().number.isRequired,failed:u().bool.isRequired,formValues:u().shape((0,i.Z)((0,i.Z)({},B.mT,u().string),B.vF,u().objectOf(u().arrayOf(u().string))))})};const Ae=Ne;function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qe={submitted:!1,id:void 0,percent:0,failed:!1,formValues:void 0},Ve=function(e,t){switch(t.type){case"schema":return _e(_e({},e),{},{schema:t.payload});case"state":return _e(_e({},e),t.payload);default:throw new Error}},Le=function(e){var t,n=e.setOpen,c=e.data,u=e.basePath,d=e.registry,m=(0,s.useRef)((0,B.Y4)(null===(t=c.issues)||void 0===t?void 0:t.reduce((function(e,t){return[].concat((0,o.Z)(e),(0,o.Z)(t.systems||[]))}),(0,o.Z)(c.systems||[])))),y=(0,w.useDispatch)(),b=(0,s.useReducer)(Ve,qe),v=(0,a.Z)(b,2),g=v[0],h=v[1],E=I()(c.issues,(function(e){return e.id}));(0,s.useEffect)((function(){var e;h({type:"schema",payload:(e=c.issues,{fields:[{component:N.Z.WIZARD,name:"remediations-wizard",isDynamic:!0,inModal:!0,showTitles:!0,title:"Remediate with Ansible",description:"Add actions to an Ansible Playbook",fields:[{name:"playbook",title:"Select playbook",fields:_,nextStep:"systems"},{name:"systems",title:"Review systems",fields:[{name:B.vF,component:"review-systems",validate:[{type:"validate-systems"}]}],nextStep:function(e){return((t=e.values)[B.yu]?t[B.ko].filter((function(e){return!t[B.m0].issues.some((function(n){return n.id===e.id&&Object.keys(t[B.vF]).includes(e.id)}))})):t[B.ko].filter((function(e){return Object.keys(t[B.vF]).includes(e.id)}))).length>0?"actions":"review";var t}},{name:"actions",title:"Review and edit actions",fields:q,nextStep:function(e){return t=e.values,r=t[B.yu]?t[B.ko].filter((function(e){return!t[B.m0].issues.some((function(t){return t.id===e.id}))&&Object.keys(t[B.vF]).includes(e.id)})):t[B.ko].filter((function(e){return Object.keys(t[B.vF]).includes(e.id)})),t[B.BA]?null===(n=r[0])||void 0===n?void 0:n.id:"review";var t,n,r}}].concat((0,o.Z)((null==e?void 0:e.map((function(e){return{name:e.id,title:(0,B.u9)(e.id),showTitle:!1,fields:[{name:e.id,component:"issue-resolution",issue:e},{name:B.Tx,component:N.Z.TEXT_FIELD,hideField:!0}],nextStep:function(t){return function(e,t){var n,r=e[B.yu]?e[B.ko].filter((function(t){return!e[B.m0].issues.some((function(n){return n.id===t.id&&Object.keys(e[B.vF]).includes(t.id)}))})):e[B.ko].filter((function(t){return Object.keys(e[B.vF]).includes(t.id)}));return(null===(n=r.slice(r.findIndex((function(e){return e.id===t.id}))+1,r.length)[0])||void 0===n?void 0:n.id)||"review"}(t.values,e)},substepOf:"Choose actions"}})))||[]),[{name:"review",title:"Remediation review",fields:[{name:B.Ej,component:"review"}]}])}]})}),d.register({hostReducer:(0,R.applyReducerHash)(C,Z),resolutionsReducer:(0,R.applyReducerHash)(xe,Re)}),y(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:f.JY,payload:O(e)}}(c.issues)),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,B.C1)(e,50).forEach((function(e){y(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:f.mg,payload:p(e,t)}}(e,{page:1,perPage:50}))}))}(m.current)}),[]);var k={"select-playbook":{component:ne,issues:c.issues,systems:c.systems,allSystems:m.current},"review-systems":{component:ce,issues:c.issues,systems:c.systems||[],allSystems:m.current,registry:d},"review-actions":{component:ve,issues:c.issues},"issue-resolution":{component:ke},review:{component:Te,data:c,issuesById:E}},S={"validate-systems":function(){return function(e){return e&&Object.values(e).filter((function(e){return void 0!==e})).length?void 0:"At least one system must be selected. Actions must be associated to a system to be added to a playbook."}}};return l().createElement(s.Fragment,null,g.schema&&!g.submitted?l().createElement(D.Z,{schema:g.schema,subscription:{values:!0},FormTemplate:function(e){return l().createElement(F.ZP,(0,r.Z)({},e,{showFormControls:!1}))},initialValues:(0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({},B.Vf,[]),B.ko,[]),B.vF,{}),B.BA,!0),B.Tx,{}),B.yu,!1),componentMapper:_e((0,i.Z)((0,i.Z)({},N.Z.WIZARD,{component:V.Z,className:"remediations","data-ouia-component-id":"remediation-wizard"}),N.Z.TEXT_FIELD,G.Z),k),validatorMapper:S,onSubmit:function(e){h({type:"state",payload:{submitted:!0,formValues:e}}),(0,B.ec)(e,c,u,(function(e){return h({type:"state",payload:e})}))},onCancel:function(){return n(!1)}}):null,g.submitted?l().createElement(L.Modal,{isOpen:!0,variant:L.ModalVariant.large,showClose:!1,className:"remediations",hasNoBodyWrapper:!0,"aria-describedby":"wiz-modal-description","aria-labelledby":"wiz-modal-title"},l().createElement(z.e,{className:"remediations",title:"Remediate with Ansible",description:"Add actions to an Ansible Playbook",steps:[{name:"progress",component:l().createElement(Ae,{onClose:function(){h({type:"state",payload:{submitted:!1,id:void 0,failed:!1,formValues:void 0}})},title:"Adding items to the playbook",setOpen:n,submitRemediation:function(){return(0,B.ec)(g.formValues,c,u,(function(e){return h({type:"state",payload:e})}))},setState:function(e){return h({type:"state",payload:e})},state:g}),isFinishedStep:!0}],onClose:function(){h({type:"state",payload:{submitted:!1,id:void 0,failed:!1,formValues:void 0}}),n(!1)}})):null)};Le.propTypes={setOpen:u().func.isRequired,data:u().shape({issues:u().arrayOf(u().shape({description:u().string,id:u().string})),systems:u().arrayOf(u().string),onRemediationCreated:u().func}).isRequired,basePath:u().string,registry:u().shape({register:u().func}).isRequired};const ze=function(e){var t=(0,s.useState)(),n=(0,a.Z)(t,2),o=n[0],i=n[1];return(0,s.useEffect)((function(){i((function(){return new j.ZP({},[S()])}))}),[]),null!=o&&o.store?l().createElement(w.Provider,{store:o.store},l().createElement(Le,(0,r.Z)({},e,{registry:o}))):null}},65088:()=>{},70347:()=>{},80897:()=>{},78752:()=>{},71338:()=>{},25238:()=>{},37739:()=>{},40209:()=>{}}]);
//# sourceMappingURL=../sourcemaps/6518.91b293c6d42c76e456c911cb3dd167e9.js.map