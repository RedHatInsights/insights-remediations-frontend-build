"use strict";
(self["webpackChunkinsights_remediations_frontend"] = self["webpackChunkinsights_remediations_frontend"] || []).push([["src_modules_RemediationsButton_js-node_modules_data-driven-forms_pf4-component-mapper_esm_wiz-5ca910"],{

/***/ "./src/modules/RemediationsButton.js":
/*!*******************************************!*\
  !*** ./src/modules/RemediationsButton.js ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/defineProperty */ "./node_modules/@babel/runtime/helpers/esm/defineProperty.js");
/* harmony import */ var _babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/extends */ "./node_modules/@babel/runtime/helpers/esm/extends.js");
/* harmony import */ var _babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime/helpers/slicedToArray */ "./node_modules/@babel/runtime/helpers/esm/slicedToArray.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "webpack/sharing/consume/default/react/react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! prop-types */ "./node_modules/prop-types/index.js");
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var _RemediationsModal_validate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./RemediationsModal/validate */ "./src/modules/RemediationsModal/validate/index.js");
/* harmony import */ var _Utilities_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../Utilities/utils */ "./src/Utilities/utils.js");
/* harmony import */ var _patternfly_react_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @patternfly/react-core */ "webpack/sharing/consume/default/@patternfly/react-core/@patternfly/react-core");
/* harmony import */ var _patternfly_react_core__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_patternfly_react_core__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _RemediationsModal__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./RemediationsModal */ "./src/modules/RemediationsModal/index.js");
/* harmony import */ var _RemediationsModal_NoDataModal__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./RemediationsModal/NoDataModal */ "./src/modules/RemediationsModal/NoDataModal.js");




function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__["default"])(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }









var RemediationButton = function RemediationButton(_ref) {
  var isDisabled = _ref.isDisabled,
      children = _ref.children,
      dataProvider = _ref.dataProvider,
      onRemediationCreated = _ref.onRemediationCreated,
      buttonProps = _ref.buttonProps;

  var _useState = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false),
      _useState2 = (0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2__["default"])(_useState, 2),
      hasPermissions = _useState2[0],
      setHasPermissions = _useState2[1];

  var _useState3 = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(),
      _useState4 = (0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2__["default"])(_useState3, 2),
      remediationsData = _useState4[0],
      setRemediationsData = _useState4[1];

  var _useState5 = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(false),
      _useState6 = (0,_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_2__["default"])(_useState5, 2),
      isNoDataModalOpen = _useState6[0],
      setNoDataModalOpen = _useState6[1];

  (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(function () {
    insights.chrome.getUserPermissions('remediations').then(function (permissions) {
      setHasPermissions(permissions.some(function (_ref2) {
        var permission = _ref2.permission;
        return (0,_Utilities_utils__WEBPACK_IMPORTED_MODULE_5__.matchPermissions)(permission, _Utilities_utils__WEBPACK_IMPORTED_MODULE_5__.CAN_REMEDIATE);
      }));
    });
  }, []);

  if (!hasPermissions) {
    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default().createElement(_patternfly_react_core__WEBPACK_IMPORTED_MODULE_6__.Tooltip, {
      content: "You do not have correct permissions to remediate this entity."
    }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default().createElement("span", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default().createElement(_patternfly_react_core__WEBPACK_IMPORTED_MODULE_6__.Button, (0,_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_1__["default"])({
      isDisabled: true
    }, buttonProps), children)));
  }

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default().createElement((react__WEBPACK_IMPORTED_MODULE_3___default().Fragment), null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default().createElement(_patternfly_react_core__WEBPACK_IMPORTED_MODULE_6__.Button, (0,_babel_runtime_helpers_extends__WEBPACK_IMPORTED_MODULE_1__["default"])({
    isDisabled: isDisabled,
    onClick: function onClick() {
      Promise.resolve(dataProvider()).then(function (data) {
        if (!data) {
          setNoDataModalOpen(true);
          return;
        }

        (0,_RemediationsModal_validate__WEBPACK_IMPORTED_MODULE_4__["default"])(data);
        setRemediationsData(data);
      });
    }
  }, buttonProps), children), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default().createElement(_RemediationsModal_NoDataModal__WEBPACK_IMPORTED_MODULE_8__["default"], {
    isOpen: isNoDataModalOpen,
    setOpen: setNoDataModalOpen
  }), remediationsData && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_3___default().createElement(_RemediationsModal__WEBPACK_IMPORTED_MODULE_7__["default"], {
    setOpen: function setOpen(isOpen) {
      return setRemediationsData(function (prevData) {
        return isOpen === false ? null : prevData;
      });
    },
    data: _objectSpread({
      onRemediationCreated: onRemediationCreated
    }, remediationsData || {})
  }));
};

RemediationButton.propTypes = {
  isDisabled: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().bool),
  dataProvider: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().func.isRequired),
  onRemediationCreated: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().func),
  children: (prop_types__WEBPACK_IMPORTED_MODULE_9___default().node),
  buttonProps: prop_types__WEBPACK_IMPORTED_MODULE_9___default().shape((0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_0__["default"])({}, (prop_types__WEBPACK_IMPORTED_MODULE_9___default().string), (prop_types__WEBPACK_IMPORTED_MODULE_9___default().any)))
};
RemediationButton.defaultProps = {
  isDisabled: false,
  onRemediationCreated: function onRemediationCreated(f) {
    return f;
  },
  children: 'Remediate with Ansible'
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (RemediationButton);

/***/ }),

/***/ "./src/modules/RemediationsModal/NoDataModal.js":
/*!******************************************************!*\
  !*** ./src/modules/RemediationsModal/NoDataModal.js ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "NoDataModal": () => (/* binding */ NoDataModal),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "webpack/sharing/consume/default/react/react");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! prop-types */ "./node_modules/prop-types/index.js");
/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var _patternfly_react_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @patternfly/react-core */ "webpack/sharing/consume/default/@patternfly/react-core/@patternfly/react-core");
/* harmony import */ var _patternfly_react_core__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_patternfly_react_core__WEBPACK_IMPORTED_MODULE_1__);



var NoDataModal = function NoDataModal(_ref) {
  var isOpen = _ref.isOpen,
      setOpen = _ref.setOpen;
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_patternfly_react_core__WEBPACK_IMPORTED_MODULE_1__.Modal, {
    variant: _patternfly_react_core__WEBPACK_IMPORTED_MODULE_1__.ModalVariant.small,
    title: "Remediate with Ansible",
    isOpen: isOpen,
    onClose: function onClose() {
      return setOpen(false);
    },
    actions: [/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_patternfly_react_core__WEBPACK_IMPORTED_MODULE_1__.Button, {
      key: "confirm",
      variant: "primary",
      onClick: function onClick() {
        return setOpen(false);
      }
    }, "Back to Insights")]
  }, "None of the selected issues can be remediated with Ansible.", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("br", null), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement("br", null), "To remediate these issues, review the manual remediation steps associated with each.");
};
NoDataModal.propTypes = {
  isOpen: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().bool),
  setOpen: (prop_types__WEBPACK_IMPORTED_MODULE_2___default().func)
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (NoDataModal);

/***/ }),

/***/ "./src/modules/RemediationsModal/validate/index.js":
/*!*********************************************************!*\
  !*** ./src/modules/RemediationsModal/validate/index.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* reexport safe */ _validator__WEBPACK_IMPORTED_MODULE_0__["default"]),
/* harmony export */   "validate": () => (/* reexport safe */ _validator__WEBPACK_IMPORTED_MODULE_0__["default"])
/* harmony export */ });
/* harmony import */ var _validator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./validator */ "./src/modules/RemediationsModal/validate/validator.js");



/***/ }),

/***/ "./src/modules/RemediationsModal/validate/validator.js":
/*!*************************************************************!*\
  !*** ./src/modules/RemediationsModal/validate/validator.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ validate)
/* harmony export */ });
/* harmony import */ var _babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/helpers/typeof */ "./node_modules/@babel/runtime/helpers/esm/typeof.js");


function assert(test, msg) {
  if (!test) {
    throw new TypeError(msg);
  }
}

function checkAllowedKeys(reference) {
  for (var _len = arguments.length, keys = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    keys[_key - 1] = arguments[_key];
  }

  Object.keys(reference).forEach(function (key) {
    return assert(keys.includes(key), "Unexpected key: ".concat(key, " Expected one of: ").concat(keys));
  });
}

function checkRequiredKeys(reference) {
  for (var _len2 = arguments.length, keys = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {
    keys[_key2 - 1] = arguments[_key2];
  }

  keys.forEach(function (key) {
    return assert(Object.prototype.hasOwnProperty.call(reference, key), "Required key missing: ".concat(key));
  });
}

function checkSystems(systems) {
  assert(Array.isArray(systems), 'Systems must be an array');
  assert(systems.length, 'Systems array must not be empty');
  systems.forEach(function (system) {
    return assert(typeof system === 'string', 'System must be of type string');
  });
}

function validate(data) {
  assert((0,_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__["default"])(data) === 'object' && data !== null);
  checkAllowedKeys(data, 'issues', 'systems', 'onRemediationCreated');
  checkRequiredKeys(data, 'issues');
  assert(Array.isArray(data.issues), 'Issues must be an array');
  assert(data.issues.length, 'Issues array must not be empty');
  data.issues.forEach(function (issue) {
    assert((0,_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_0__["default"])(issue) === 'object' && issue !== null, 'Issue must be an object');
    checkAllowedKeys(issue, 'id', 'description', 'systems');
    checkRequiredKeys(issue, 'id', 'description');
    Object.prototype.hasOwnProperty.call(issue, 'systems') && checkSystems(issue.systems);
    assert(Object.prototype.hasOwnProperty.call(issue, 'systems') || Object.prototype.hasOwnProperty.call(data, 'systems'), "No systems defined for ".concat(issue.id));
  });
  Object.prototype.hasOwnProperty.call(data, 'systems') && checkSystems(data.systems);
}

/***/ })

}]);