"use strict";(self.webpackChunkinsights_remediations_frontend=self.webpackChunkinsights_remediations_frontend||[]).push([[2530],{76691:(e,t,n)=>{n.r(t),n.d(t,{default:()=>J});var a=n(4942),l=n(29439),r=n(92950),o=n.n(r),c=n(14494),s=n(45697),u=n.n(s),m=n(334),i=n(99166),d=n(81321),y=n(14748),p=n(80123),E=n(39173),b=n(62410),f=n(35664),g=n(18213),k=n(83237),S=n(14938),R=n(52017),_=n(81730),v=n(76200),I=n(50289),Z=n(73725),h=n(77431),P=n(22812),N=n(66650),C=n(78923),T=n(96184),O=function(e){var t=e.data;return o().createElement(C.n,{data:t,toolbar:o().createElement(S.Toolbar,null,o().createElement(S.ToolbarContent,null,o().createElement(S.ToolbarItem,null,o().createElement(T.Y,{placeholder:"Search"}))))})};O.propTypes={data:u().string};const D=O;P.Z.registerLanguage("yaml",N.Z);var x=function(e){var t=e.systemId,n=e.playbookRunSystemDetails;return o().createElement(o().Fragment,null,o().createElement(S.Title,{headingLevel:"h4",size:"xl",className:"rem-c-title-job-output"},"Playbook log"),t&&t===n.system_id?o().createElement(o().Fragment,null,o().createElement(D,{data:n.console}),"running"===n.status&&o().createElement("div",{className:"rem-l-playbook-running"},o().createElement(S.Spinner,{size:"lg","aria-valuetext":"playbook in progress",className:"ins-c-spinner__playbook-running"}))):o().createElement(f.Z,{size:"lg"}))};x.propTypes={systemId:u().string,status:u().string,console:u().string,playbookRunSystemDetails:u().shape({system_id:u().string,status:u().string,console:u().string})},x.defaultProps={playbookRunSystemDetails:{}};const B=(0,c.connect)((function(e){return{playbookRunSystemDetails:e.playbookRunSystemDetails}}))(x);var j=n(40742);const w=function(){return o().createElement(o().Fragment,null,o().createElement(p.Z,null,o().createElement(S.Breadcrumb,null,o().createElement(S.BreadcrumbItem,null,o().createElement(f.Z,{size:"lg"})),o().createElement(S.BreadcrumbItem,null,o().createElement(f.Z,{size:"lg"})),o().createElement(S.BreadcrumbItem,{isActive:!0},o().createElement(f.Z,{size:"lg"}))),o().createElement(S.Stack,{hasGutter:!0},o().createElement(S.StackItem,null,o().createElement(E.Z,{title:o().createElement(f.Z,{size:"lg"})})),o().createElement(S.StackItem,null,o().createElement(S.Split,{hasGutter:!0},o().createElement(S.SplitItem,null,o().createElement(v.Z,{className:"rem-c-playbookSummary__settings",title:"Run on"},o().createElement(f.Z,{size:"lg"}))),o().createElement(S.SplitItem,null,o().createElement(v.Z,{className:"rem-c-playbookSummary__settings",title:"Run by"},o().createElement(f.Z,{size:"lg"}))),o().createElement(S.SplitItem,null,o().createElement(v.Z,{className:"rem-c-playbookSummary__settings",title:"Run by"},o().createElement(f.Z,{size:"lg"}))))))),o().createElement(y.Z,null,o().createElement(S.Stack,{hasGutter:!0},o().createElement(S.Card,null,o().createElement(S.CardHeader,{className:"rem-m-card__header-bold"},o().createElement(S.Button,null,"Download playbook")),o().createElement(S.CardBody,null,o().createElement(j.Z,null))))))};var z=function(e){var t=e.name;return o().createElement(S.Bullseye,null,o().createElement(S.EmptyState,null,o().createElement(S.EmptyStateIcon,{className:"rem-c-failure",icon:R.ExclamationCircleIcon}),o().createElement(S.Title,{headingLevel:"h5",size:"lg"},"Run failed"),o().createElement(S.EmptyStateBody,null,"Playbook failed to run on ",t,". Connection was lost. Try executing the remediation again, and if the problem persist, constact your system administrator(s)."),o().createElement(S.Button,{variant:"link"},"Learn more")))};z.propTypes={name:u().string};const F=z;var L=n(57869),G=n(30319),A=n(7645),Y=(0,n(22163).T)({id:"default"});const V=[{key:"display_name",title:"Name",renderFunc:function(e,t,n){var a=n.fqdn;return o().createElement("div",null,o().createElement("a",{href:Y(t)},a||e||t))}},"tags",{key:"status",title:"Status",renderFunc:function(e){return o().createElement("div",{className:"rem-c-status-bar"},(0,h.Nv)((0,h.fb)(e)))}}];function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var q,W=function(e){var t=e.match.params,n=t.executor_id,c=t.run_id,s=t.id,u=e.remediation,I=e.playbookRun,P=e.playbookRunSystems,N=e.playbookRunSystemDetails,C=e.getPlaybookRun,T=e.getPlaybookRunSystems,O=e.getPlaybookRunSystemDetails,D=e.onCollapseInventory,x=e.loadRemediation,j=(0,r.useState)({}),z=(0,l.Z)(j,2),Y=z[0],W=z[1],J=(0,r.useState)([]),K=(0,l.Z)(J,2),M=K[0],Q=K[1],U=(0,r.useState)(""),X=(0,l.Z)(U,2),$=X[0],ee=X[1],te=(0,r.useState)(1),ne=(0,l.Z)(te,2),ae=ne[0],le=ne[1],re=(0,r.useState)(50),oe=(0,l.Z)(re,2),ce=oe[0],se=oe[1],ue=(0,r.useState)(),me=(0,l.Z)(ue,2),ie=me[0],de=me[1],ye=(0,r.useState)(!1),pe=(0,l.Z)(ye,2),Ee=pe[0],be=pe[1],fe=(0,r.useState)(),ge=(0,l.Z)(fe,2),ke=ge[0],Se=ge[1],Re=(0,r.useRef)(null),_e=function(e){Re&&Re.current&&(T(s,c,n,e.per_page,e.per_page*(e.page-1)),le(e.page),se(e.per_page),Re.current.onRefreshData(e))};(0,r.useEffect)((function(){return x(s),C(s,c),Se((function(){return(0,i.Z)(T,500)})),function(){q&&clearInterval(q)}}),[]),(0,r.useEffect)((function(){I&&I.data&&W(I.data.executors.find((function(e){return e.executor_id===n}))||{}),"pending"!==P.status&&T(s,c,n,ce,ce*(ae-1),$)}),[I]),(0,r.useEffect)((function(){Ee||C(s,c),"running"!==(0,h.fb)(N.status)&&q&&clearInterval(q),be(!1)}),[N.status]),(0,r.useEffect)((function(){Q((function(){return P.data.map((function(e){var t=e.system_id;return{id:t,display_name:e.system_name,status:e.status,isOpen:ie===t,children:o().createElement(B,{systemId:t})}}))}))}),[P]);var ve,Ie=function(e){return o().createElement(y.Z,null,o().createElement(S.Stack,{hasGutter:!0},o().createElement(S.Card,{className:"rem-c-card__playbook-log"},o().createElement(S.CardBody,null,o().createElement(d.Z,{ref:Re,columns:(0,A.VA)(V),onLoad:function(e){var t=e.INVENTORY_ACTION_TYPES,n=e.mergeWithEntities;return(0,G.z2)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n(_.Z.playbookActivityIntentory({INVENTORY_ACTION_TYPES:t})())))},items:"pending"!==P.status?M:[],isLoaded:"pending"!==P.status,onRefresh:_e,page:ae,total:P.meta.total,perPage:ce,hasCheckbox:!1,expandable:!0,showTags:!0,onExpandClick:"running"===e?function(e,t,n,a){var l=a.id;be(!0),n?(de(l),q&&clearInterval(q),O(u.id,c,l),q=setInterval((function(){return O(u.id,c,l)}),5e3)):(de(void 0),clearInterval(q)),D(n,l)}:function(e,t,n,a){var l=a.id;be(!0),n?(de(l),O(u.id,c,l)):de(void 0),clearInterval(q),D(n,l)}},o().createElement(S.Toolbar,null,o().createElement(S.ToolbarContent,null,o().createElement(S.ToolbarItem,null,o().createElement(g.Z,{items:[{value:"display_name",label:"Name",filterValues:{placeholder:"Filter by name",type:k.Y.text,value:$,onChange:function(e,t){ee(t),le(1),ke(s,c,n,ce,0,t)}}}]})),o().createElement(S.ToolbarItem,null,o().createElement(S.Button,{variant:"secondary",onClick:function(){return(0,Z.rN)(u.id)}},"Download playbook")))))))))},Ze=(0,r.useContext)(L.B);return u&&Y&&I&&I.data?o().createElement(o().Fragment,null,o().createElement(p.Z,null,o().createElement(S.Breadcrumb,null,o().createElement(S.BreadcrumbItem,null,o().createElement(m.Link,{to:"/"}," Remediations ")),o().createElement(S.BreadcrumbItem,null,o().createElement(m.Link,{to:"/".concat(u.id)}," ",u.name," ")),o().createElement(S.BreadcrumbItem,null,o().createElement(m.Link,{to:"/".concat(u.id,"/").concat(c)},o().createElement(b.Z,{type:"exact",date:I.data.created_at}))),o().createElement(S.BreadcrumbItem,{isActive:!0}," ",Y.executor_name," ")),o().createElement(S.Stack,{hasGutter:!0},o().createElement(S.StackItem,null,o().createElement(E.Z,{title:"Running"===(0,h.fb)(Y.status)?o().createElement(o().Fragment,null,o().createElement(R.InProgressIcon,{className:"rem-c-running","aria-label":"connection status"}),Y.executor_name):Y.executor_name})),o().createElement(S.StackItem,null,o().createElement(S.Split,{hasGutter:!0},o().createElement(S.SplitItem,null,o().createElement(v.Z,{className:"rem-c-playbookSummary__settings",title:"Run status"},Y.status?o().createElement(h.kf,{executorStatus:Y.status,counts:Y.counts,permission:Ze}):o().createElement(f.Z,{size:"lg"}))),o().createElement(S.SplitItem,null,o().createElement(v.Z,{className:"rem-c-playbookSummary__settings",title:"Run by"},"".concat(I.data.created_by.first_name," ").concat(I.data.created_by.last_name))),o().createElement(S.SplitItem,null,o().createElement(v.Z,{className:"rem-c-playbookSummary__settings",title:"Run on"},o().createElement(b.Z,{type:"exact",date:I.data.created_at}))))))),{running:Ie(ve=(0,h.fb)(Y.status)),success:Ie(ve),failure:Ie(ve),canceled:Ie(ve),epicFailure:o().createElement(y.Z,null,o().createElement(S.Stack,{hasGutter:!0},o().createElement(S.Card,null,o().createElement(S.CardHeader,{className:"rem-m-card__header-bold"},o().createElement(S.Button,{variant:"secondary",onClick:function(){return(0,Z.rN)(u.id)}},"Download playbook")),o().createElement(S.CardBody,null,o().createElement(F,{name:Y.executor_name})))))}[(0,h.fb)(ve)]):o().createElement(w,null)};W.propTypes={match:u().object,remediation:u().object,playbookRun:u().object,playbookRunSystems:u().object,playbookRunSystemDetails:u().object,getPlaybookRun:u().func,getPlaybookRunSystems:u().func,getPlaybookRunSystemDetails:u().func,onCollapseInventory:u().func,loadRemediation:u().func},W.defaultProps={remediation:{}};const J=(0,c.connect)((function(e){var t=e.playbookRuns,n=e.playbookRun,a=e.playbookRunSystems,l=e.playbookRunSystemDetails,r=e.selectedRemediation;return{playbookRuns:t.data,playbookRun:n,playbookRunSystemDetails:l,playbookRunSystems:a,remediation:r.remediation}}),(function(e){return{getPlaybookRuns:function(t){return e((0,I.getPlaybookRuns)(t))},getPlaybookRun:function(t,n){return e((0,I.getPlaybookRun)(t,n))},getPlaybookRunSystems:function(t,n,a,l,r,o){return e((0,I.getPlaybookRunSystems)(t,n,a,l,r,o))},getPlaybookRunSystemDetails:function(t,n,a){return e((0,I.getPlaybookRunSystemDetails)(t,n,a))},onCollapseInventory:function(t,n){return e((0,I.expandInventoryTable)(n,t))},loadRemediation:function(t){return e((0,I.loadRemediation)(t))}}}))(W)}}]);
//# sourceMappingURL=../sourcemaps/ExecutorDetails.0faccc799dac47ce66c5243e646cb1d9.js.map