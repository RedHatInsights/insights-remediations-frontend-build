"use strict";(self.webpackChunkremediations=self.webpackChunkremediations||[]).push([[1390],{77832:(e,t,n)=>{function a(e){return e.split(":")[0]}function s({id:e}){switch(a(e)){case"advisor":return"Advisor";case"ssg":return"Compliance";case"vulnerabilities":return"Vulnerability";case"patch-advisory":return"Patch";default:return"Unknown"}}function l({display_name:e,hostname:t,id:n}){return e||t||n}function i(e,t){return e.toLowerCase().includes(t.toLowerCase())}n.d(t,{PW:()=>i,Pz:()=>a,_f:()=>l,lN:()=>s})},18293:(e,t,n)=>{n.d(t,{Gd:()=>o,T:()=>i,Tj:()=>r});var a=n(54998),s=n.n(a),l=n(77832);function i(e){const t=function({id:e}){switch((0,l.Pz)(e)){case"advisor":return"advisor";case"vulnerabilities":return"vulnerabilities";case"ssg":return"compliance";case"patch-advisory":return"patch";default:return"general_information"}}(e),n=o("inventory").toString();return e=>`${n}/${e}?appName=${t}`}function r(e){const t=e.split(":");switch(t[0]){case"advisor":return o(t[0]).segment("recommendations").segment(t[1]).toString();case"vulnerabilities":return o(t[0]).segment("cves").segment(t[1]).toString();case"patch-advisory":return o(t[0]).segment("advisories").segment(t[1]+":"+t[2]).toString();default:return null}}function o(e){switch(e){case"advisor":return s()(document.baseURI).segment("insights").segment("advisor");case"vulnerabilities":return s()(document.baseURI).segment("insights").segment("vulnerability");case"compliance":case"ssg":return s()(document.baseURI).segment("insights").segment("compliance");case"inventory":return s()(document.baseURI).segment(function(){const e=window.location.pathname.split("/");return"preview"===e[1]?e[2]:e[1]}()).segment("inventory");case"patch-advisory":return s()(document.baseURI).segment("insights").segment("patch");default:throw new Error(`Unknown app: ${e}`)}}},79790:(e,t,n)=>{n.d(t,{Q:()=>i});var a=n(33366),s=n(10756);const{API_BASE:l}=n(93940),i=e=>{const t=(0,a.Vk)(),[n,i]=(0,s.useState)(),r=(0,s.useRef)(!1);return(0,s.useEffect)((()=>(r.current=!0,(async()=>{try{const e=await t.get(`${l}/remediations/?fields[data]=name`);r.current&&i(e.data)}catch(e){console.error(e)}})(),()=>{r.current=!1})),[e]),n}},76400:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(10756),s=n.n(a),l=n(45697),i=n.n(l),r=n(93967),o=n.n(r);const c=({title:e,className:t,children:n,isBold:a,hasGutter:l,needsPointer:i,...r})=>{const c=o()("rem-c-description-list__description",{"rem-c-description-list__description--bold":a},{"rem-c-description-list__description--withGutter":l},{"rem-c-description-list__description--needsPointer":i}),m=o()(t,"rem-c-description-list");return s().createElement("dl",{className:m,...r},s().createElement("dt",{className:"rem-c-description-list__title"},s().createElement("b",null,e)),s().createElement("dd",{className:c}," ",n," "))},m=c;c.propTypes={title:i().string,children:i().any,isBold:i().bool,className:i().string,hasGutter:i().bool,needsPointer:i().bool}},68175:(e,t,n)=>{n.d(t,{Gx:()=>l,M1:()=>s,VA:()=>i,um:()=>a});const a=(e=[],t)=>e.every((({id:e})=>t?.has(e)))?e.length>0:e.some((({id:e})=>t?.has(e)))&&null,s=e=>e?.issues?.reduce(((e,t)=>(t?.systems?.forEach((n=>{const a=e.find((({id:e})=>n.id===e)),s={id:t.id,resolution:t.resolution,description:t.description};a?(a.issues=[...a.issues,{...s,resolved:a.resolved}],a.rebootRequired=a.issues.some((({resolution:e})=>e?.needs_reboot))):e.push({...n,issues:[{...s,resolved:n.resolved}],rebootRequired:t?.resolution?.needs_reboot})})),e)),[])||[],l=async({page:e=0,...t}={},n,a,s)=>{const l=n.filter((({display_name:e})=>!t.filters?.hostnameOrId||e.includes(t.filters.hostnameOrId))),i=await a(l.slice((e-1)*t.per_page,e*t.per_page).map((({id:e})=>e)),{...t,hasItems:!0},!0),r=i.results.map((e=>{const t=e.id,n=403!==s&&s.find((e=>e.system_ids.includes(t)));return n?{...e,connection_status:n.connection_status,executor_type:n.executor_type}:e}));return{...i,page:e,results:r.map((e=>({...l.find((({id:t})=>t===e.id)),...e}))),total:l.length}},i=(e=[],t=[])=>t.map((t=>e.find((e=>e.key===t.key))||t))},75143:(e,t,n)=>{n.r(t),n.d(t,{default:()=>sn});var a=n(10756),s=n.n(a),l=n(92397),i=n(98773),r=n(88208),o=n(45697),c=n.n(o),m=n(28216),u=n(34413),d=n(33626),p=n(94654),E=n.n(p),g=n(75472),h=n.n(g),y=n(61869),b=n(75863),f=n(7732),v=n(43416),S=n(49004),R=n(58027),k=n(96087),_=n(15433),x=n(75998),C=n(77832),I=n(18293),T=n(31593),N=n(28685),w=n(79194),D=n(87282),Z=n(14832),B=n(29684),F=n(40667),q=n(24224),A=n(32819);class L extends a.Component{constructor(e){super(e),this.issue=e.issue,this.state={selected:e.issue.resolution,resolutions:!1}}onRadioChange=e=>{this.setState({selected:e})};async componentDidMount(){const e=await this.props.getResolutions(this.issue.id);this.setState({resolutions:e.value})}getSelectedResolution=()=>this.state.selected;render(){const{resolutions:e,selected:t}=this.state;let n;return n=e?s().createElement(s().Fragment,null,s().createElement(F.StackItem,null,s().createElement(w.Form,null,e.resolutions.map((e=>s().createElement("div",{className:"ins-c-resolution-option",key:e.id},s().createElement(Z.Radio,{label:s().createElement(F.Stack,{className:"ins-c-resolution-choice__details"},s().createElement(F.StackItem,null,e.description),e.needs_reboot&&s().createElement(F.StackItem,null,s().createElement(q.Z,{red:!0}))),"aria-label":e.description,id:e.id,name:"radio",defaultChecked:e.id===t.id,onChange:()=>this.onRadioChange(e)}))))))):s().createElement(s().Fragment,null,s().createElement(F.StackItem,null,s().createElement(A.Z,null)),s().createElement(F.StackItem,null,s().createElement(A.Z,null)),s().createElement(F.StackItem,null,s().createElement(A.Z,null))),s().createElement(F.Stack,{hasGutter:!0},s().createElement(F.StackItem,null,s().createElement("div",null,"Select resolution for this action.")),s().createElement(F.StackItem,null,s().createElement(B.Split,{hasGutter:!0},s().createElement(B.SplitItem,null,s().createElement(D.Label,null,"Action")),s().createElement(B.SplitItem,{isFilled:!0},s().createElement("h1",{className:"ins-m-text__bold"},this.issue.description)))),n)}}L.propTypes={issue:c().object.isRequired,getResolutions:c().func.isRequired};const P=L,$=({remediation:e,issue:t,onResolutionSelected:n,getResolutions:l})=>{const[i,r]=(0,a.useState)(!1),o=(0,a.useRef)();return s().createElement(s().Fragment,null,s().createElement("a",{onClick:()=>r(!0)},"Edit"),i&&s().createElement(N.Modal,{variant:N.ModalVariant.medium,className:"rem-c-resolution-modal",isOpen:i,onClose:()=>r(!1),title:"Edit resolution",actions:[s().createElement(T.Button,{key:"confirm",variant:"primary",onClick:a=>{r(!1);const s=o.current?.getSelectedResolution();a&&t.resolution.id!==s.id&&n(e.id,t.id,s.id)}},"Save"),s().createElement(T.Button,{key:"cancel",variant:"secondary",onClick:()=>r(!1)},"Cancel")]},s().createElement(P,{key:"ResolutionStep",issue:t,ref:o,getResolutions:l})))};$.propTypes={remediation:c().object.isRequired,issue:c().object.isRequired,onResolutionSelected:c().func.isRequired,getResolutions:c().func.isRequired};const O=$,z=(0,m.connect)((e=>e),(e=>({onResolutionSelected:async(t,n,a)=>{await e((0,u.ok)(t,n,a)),e((0,u.hU)(t))},getResolutions:t=>e((0,u.MR)(t))})))(O);var V=n(37903);class G extends a.Component{state={dialogOpen:!1};onButtonClicked=()=>{this.setState({dialogOpen:!0})};onDialogClose=e=>{this.setState({dialogOpen:!1}),e&&this.props.onDelete()};render(){const{dialogOpen:e}=this.state;return s().createElement(s().Fragment,null,s().createElement(T.Button,{onClick:this.onButtonClicked,isDisabled:this.props.isDisabled,variant:this.props.variant},this.props.label),e&&s().createElement(V.Z,{title:this.props.dialogTitle,confirmText:this.props.dialogConfirmationText,text:this.props.dialogMessage,onClose:this.onDialogClose}))}}G.propTypes={label:c().string,dialogTitle:c().string,dialogMessage:c().string,dialogConfirmationText:c().string,isDisabled:c().bool,onDelete:c().func.isRequired,variant:c().string},G.defaultProps={label:"Delete",variant:"link"};const j=G,M=((0,m.connect)(((e,{remediations:t})=>({dialogMessage:"You will not be able to recover "+(t.length>1?"these remediations":"this remediation")})),((e,{remediations:t})=>({onDelete:async()=>{await Promise.all(t.map((t=>e((0,u.YW)(t))))),e((0,u.ch)())}})))(j),(0,m.connect)(((e,{issues:t})=>({label:"Remove action"+(t.length>1?"s":""),dialogTitle:"Remove action"+(t.length>1?"s":""),dialogConfirmationText:"Remove action"+(t.length>1?"s":"")})),((e,{remediation:t,issues:n,afterDelete:a,isBeta:s})=>({onDelete:async()=>{await Promise.all(n.map((n=>e((0,u.Kn)(t.id,n))))),s&&e((0,u.uz)(t.id)),a()}})))(j));var W=n(42247),H=n.n(W),U=n(80212),Y=n.n(U),K=n(49231),J=n(67336),Q=n(63652),X=n(18213),ee=n(87123),te=n(881),ne=n(79332),ae=n(30120),se=n(41435);function le({remediation:e,issue:t,system:n,onDelete:l}){const[i,r]=(0,a.useState)(!1),[o,c]=(0,a.useState)(!1);return s().createElement(s().Fragment,null,s().createElement(V.Z,{isOpen:o,text:`This playbook will not address ${t.description} on ${(0,C._f)(n)}`,onClose:a=>{c(!1),a&&l(e.id,t.id,n.id),(0,x.q)({title:`Removed systems from ${e.name}`,description:"",variant:"success",dismissable:!0,autoDismiss:!0})}}),s().createElement(ne.L,{onSelect:e=>e,toggle:s().createElement(ae.a,{onToggle:()=>r((e=>!e))}),isOpen:i,position:se.ir.right,isPlain:!0},s().createElement(T.Button,{onClick:()=>c(!0),variant:"link"},"Remove system")))}le.propTypes={remediation:c().object.isRequired,issue:c().object.isRequired,system:c().object.isRequired,onDelete:c().func.isRequired};const ie=(0,m.connect)(null,(e=>({onDelete:(t,n,a)=>e((0,u.$A)(t,n,a))})))(le),re=({icon:e,text:t})=>s().createElement("div",{className:"rem-c-icon-inline"},e,s().createElement("span",{className:"rem-c-icon-inline__text"},t));re.propTypes={icon:c().node.isRequired,text:c().string.isRequired};const oe=({isOpen:e,onClose:t,issue:n,remediation:l,onDelete:i})=>{const[r,o]=(0,a.useState)(!1),[c,m]=(0,a.useState)({}),[u,d]=(0,a.useState)({}),[p,E]=(0,a.useState)(1),[g,y]=(0,a.useState)(50),[b,f]=(0,a.useState)(""),v=(0,a.useRef)(null),{current:S}=(0,a.useRef)((0,I.T)(n));(0,a.useEffect)((()=>{const e={};n.systems.map((t=>{e[t.id]=!0===t.resolved?s().createElement(re,{icon:s().createElement(H(),null),text:"Remediated"}):s().createElement(re,{icon:s().createElement(Y(),null),text:"Not remediated"})})),d(e)}),[]);const R=(e,t)=>n=>s().createElement(ie,{remediation:e,issue:t,system:n}),k=e=>u[e];return s().createElement(s().Fragment,null,s().createElement(N.Modal,{className:"remediations",variant:N.ModalVariant.large,title:`System${n.systems.length>1?"s":""} for action`,isOpen:e,onClose:t,isFooterLeftAligned:!0},s().createElement("b",null,"Action:")," ",n.description,s().createElement("div",{className:"rem-c-toolbar__filter"},s().createElement(Q.Z,{onLoad:({mergeWithEntities:e,INVENTORY_ACTION_TYPES:t})=>(0,J.JH)().register({...e(te.Z.inventoryEntitiesReducer({INVENTORY_ACTION_TYPES:t,detailDropdown:R(l,n),urlBuilder:S,generateStatus:k})())}),ref:v,items:h()(n.systems.filter((e=>(0,C._f)(e).includes(b))),[e=>(0,C._f)(e),e=>e.id]),onRefresh:e=>{v&&v.current&&(E(e.page),y(e.per_page),v.current.onRefreshData({timestamp:Date.now(),...e}))},page:p,total:n.systems.length,perPage:g,hasCheckbox:!1,actions:[{title:" Remove system",onClick:(e,t,n)=>{m(n),o(!0)}}]},s().createElement(_.Z,null,s().createElement(K.ToolbarGroup,null,s().createElement(K.ToolbarItem,null,s().createElement(X.Z,{items:[{value:"display_name",label:"Name",type:ee.Yu.text,filterValues:{placeholder:"Search by name",value:b,onChange:(e,t)=>f(t)}}]}))))))),s().createElement(V.Z,{isOpen:r,text:`Removing the system ${(0,C._f)(c)} from the action ${n.description}\n                    will remove this system’s remediation from the playbook.`,onClose:e=>{o(!1),e&&i(l.id,n.id,c.id)}}))};oe.propTypes={isOpen:c().bool,onClose:c().func,issue:c().object,remediation:c().object,onDelete:c().func};const ce=({issue:e,remediation:t,title:n})=>{const[l,i]=(0,a.useState)(!1),r=(0,m.useDispatch)();return s().createElement(s().Fragment,null,s().createElement("a",{onClick:()=>i(!0)},n),s().createElement(oe,{isOpen:l,onClose:()=>i(!1),issue:e,remediation:t,onDelete:(e,t,n)=>r((0,u.$A)(e,t,n))}))};ce.propTypes={issue:c().object.isRequired,remediation:c().object.isRequired,title:c().string.isRequired};var me=n(38318);const ue="true"===localStorage.getItem("remediations:debug")?{perPageOptions:[1,2,3,4,5,10,15,20,25,50,100,200].map((e=>({title:`${e}`,value:e})))}:{};var de=n(95726),pe=n(45791),Ee=n(4252),ge=n(13193);const he=e=>s().createElement(pe.Bullseye,{className:"pf-u-pt-2xl"},s().createElement(Ee.EmptyState,null,!0===e.filtered?s().createElement(ge.Title,{size:"lg",headingLevel:"h5"},"No actions found"):s().createElement(ge.Title,{size:"lg",headingLevel:"h5"},"This playbook is empty"),s().createElement(Ee.EmptyStateBody,null,"To add an action, select issues identified in",s().createElement("br",null),s().createElement("a",{href:(0,I.Gd)("advisor").toString()},"Recommendations"),", ",s().createElement("a",{href:(0,I.Gd)("compliance").toString()},"Compliance")," or ",s().createElement("a",{href:(0,I.Gd)("vulnerabilities").toString()},"Vulnerability"),"  and select",s().createElement("br",null),s().createElement("strong",null,"Remediate with Ansible."))));he.propTypes={filtered:c().bool.isRequired};var ye=n(55140),be=n(10621);function fe(e,t){const n=(0,I.Tj)(t.id);return t.resolutions_available<=1?n?s().createElement(s().Fragment,null,s().createElement("span",null,s().createElement("a",{href:n},t.description),s().createElement("br",null),t.resolution.description)):t.resolution.description:n?s().createElement(s().Fragment,null,s().createElement("span",null,s().createElement("a",{href:n},t.description),s().createElement("br",null),t.resolution.description,s().createElement("br",null),s().createElement(z,{issue:t,remediation:e}))):s().createElement(s().Fragment,null,t.resolution.description,s().createElement("br",null),s().createElement(z,{issue:t,remediation:e}))}function ve(e,t,n){return s().createElement(ce,{key:e.id,remediation:t,issue:e,title:n})}const Se=[null,e=>e.description,null,e=>e.resolution.needs_reboot,e=>e.systems.length,e=>(0,C.lN)(e)];function Re(e){const t=(0,me.h0)(),n=(0,me.sk)(1,"asc"),l=(0,me.L0)(),i=(0,me.v9)(),r=(0,a.useContext)(de.B),[o,c]=(0,a.useState)(""),[m,u]=(0,a.useState)(0),d=(0,ye.Z)();(0,a.useEffect)((()=>{l.setValue(o)}),[o]),n.onChange(t.reset),l.onChange(t.reset);const p=e.remediation.issues.filter((e=>(0,C.PW)(e.description,l.value.trim()))),g=h()(p,[Se[n.sortBy]],[n.sortDir]).slice(t.offset,t.offset+t.pageSize),I=E()(g,(T=e.remediation,e=>{var t;return[{isOpen:!1,id:e.id,cells:[{title:fe(T,e)},{title:(t=e.resolution.needs_reboot,s().createElement("span",null,t?"Required":"Not required"))},{title:ve(e,T,`${e.systems.length}`)},{title:(0,C.lN)(e),props:{className:"rem-m-nowrap"}},{title:ve(e,T,`${(0,be.BH)(e)}/${e.systems.length} remediated`)}]}]}));var T;i.register(I);const N=i.getSelectedIds(),w={filters:o.length?[{category:"Action",chips:[{name:o}]}]:[],onDelete:()=>{c(""),l.setValue("")}},D=e=>e?.filter((e=>!0===e.selected));return s().createElement("div",{className:"test"},s().createElement(k.Z,{filterConfig:{items:[{label:"Search actions",type:"text",filterValues:{id:"filter-by-string",key:"filter-by-string",placeholder:"Search",value:o,onChange:(e,t)=>{c(t)}}}]},bulkSelect:{isDisabled:!I,items:[{title:"Select none (0)",onClick:()=>{i.props.onSelect("none")}},I.length>0?{title:`Select page (${I?.length})`,onClick:()=>{0===D(I).length?i.props.onSelect("page",!0,0):I.length===D(I).length?i.props.onSelect("page",!1,0):i.props.onSelect("page",!0,0)}}:{},I.length>0?{title:`Select all (${e?.remediation?.issues.length})`,onClick:()=>{i.register(e?.remediation.issues),N?.length<e?.remediation?.issues.length?i.props.onSelect("page",!0,0):i.props.onSelect("page",!1,0)}}:{}],checked:N.length&&p.length>N.length?null:N.length,count:N.length,onSelect:()=>{0===D(I).length?i.props.onSelect("page",!0,0):i.props.onSelect("page",!1,0)}},actionsConfig:{actions:[s().createElement(M,{key:e.remediation.id,variant:"secondary",isDisabled:!N.length,remediation:e.remediation,issues:N,afterDelete:()=>{(0,x.q)({title:`Removed ${N.length} actions from ${e.remediation.name}`,description:"",variant:"success",dismissable:!0,autoDismiss:!0}),i.reset()},isBeta:d?.isBeta?.()})]},pagination:{...t.props,itemCount:p.length},activeFiltersConfig:w}),I.length>0?s().createElement(v.i,{variant:b.B.compact,"aria-label":"Actions",canSelectAll:!1,className:"ins-c-remediation-details-table",cells:[{title:"Actions",transforms:[f.p]},{title:"Reboot required",transforms:[f.p]},{title:"Systems",transforms:[f.p]},{title:"Type",transforms:[f.p]},{title:"Status",transforms:[f.p]}],rows:I,...n.props,...r.permissions.write&&{...i.props}},s().createElement(S.x,null),s().createElement(R.R,{...i.tbodyProps})):l.value?s().createElement(he,{filtered:!0}):s().createElement(he,{filtered:!1}),I.length>0&&s().createElement(_.Z,{isFooter:!0},s().createElement(y.Pagination,{variant:"bottom",dropDirection:"up",itemCount:p.length,...t.props,...ue})))}Re.propTypes={remediation:c().object.isRequired,status:c().object.isRequired};const ke=Re;var _e=n(57283),xe=n.n(_e),Ce=n(18546),Ie=n(62703),Te=n(29738),Ne=n.n(Te),we=n(15848);const De=({isOpen:e,selected:t,onConfirm:n,onClose:a,remediationName:l})=>s().createElement(N.Modal,{variant:N.ModalVariant.medium,title:`Remove selected systems from ${l}`,isOpen:e,onClose:a,appendTo:document.getElementsByClassName("remediations")[0],actions:[s().createElement(T.Button,{key:"remove-confirm",variant:"danger",onClick:n,ouiaId:"confirm-delete"},"Remove"),s().createElement(T.Button,{key:"remove-cancel",variant:"link",onClick:a},"Cancel")]},s().createElement(B.Split,{hasGutter:!0},s().createElement(B.SplitItem,null,s().createElement(Ie.Icon,{size:"xl",className:"ins-m-alert",status:"warning"},s().createElement(Ne(),null))),s().createElement(B.SplitItem,{isFilled:!0},s().createElement(F.Stack,{hasGutter:!0},s().createElement(F.StackItem,null,"This action will remove"," ",1===t.length?s().createElement("span",null,s().createElement("b",null," ",t[0]?.display_name," ")," system"):s().createElement("span",null,s().createElement("b",null," ",t.length," ")," systems")," ","from ",s().createElement("b",null,l)," Remediation."),s().createElement(F.StackItem,null,"Removing ",(0,we._6)(t.length,"system")," from this Remediation will remove it from all associated issues in"," ",s().createElement("b",null,l)," Remediation. Be careful as you can end up with Remediation without any systems.")))));De.propTypes={selected:c().arrayOf(c().shape({id:c().string,display_name:c().string})).isRequired,remediationName:c().string.isRequired,isOpen:c().bool.isRequired,onConfirm:c().func.isRequired,onClose:c().func.isRequired};const Ze=De;var Be=n(68175),Fe=n(1082);const qe=({rebootRequired:e})=>s().createElement(a.Fragment,null,s().createElement("span",null,e?"Required":"Not required"));qe.propTypes={rebootRequired:c().bool};const Ae=qe;var Le=n(89734),Pe=n.n(Le);const $e={advisor:"Advisor recommendation",vulnerabilities:"Vulnerability","patch-advisory":"Patch advisory"},Oe=({issues:e,display_name:t})=>{const[n,l]=(0,a.useState)({index:0,direction:"asc"}),[i,r]=(0,a.useState)(),o=Pe()(e,(e=>{return(t=e,[t.description,t.resolution.needs_reboot,$e?.[t.id.split(":")[0]],t.resolved])[n.index];var t}));return s().createElement(a.Fragment,null,s().createElement(T.Button,{variant:"link",isInline:!0,onClick:()=>r(!0)},e.length),s().createElement(N.Modal,{variant:N.ModalVariant.medium,title:`Actions for system ${t}`,isOpen:i,onClose:()=>r(!1)},s().createElement(v.i,{variant:"compact","aria-label":`Issues table for ${t}`,rows:("asc"===n.direction?o:o.reverse()).map((e=>[{title:s().createElement(a.Fragment,null,s().createElement("div",null,s().createElement("a",{href:(0,I.Tj)(e.id)},e.description)),s().createElement("div",null,e.resolution.description))},{title:s().createElement(a.Fragment,null,s().createElement(Ae,{rebootRequired:e.resolution.needs_reboot}))},$e?.[e.id.split(":")[0]]||"Unknown",{title:s().createElement(a.Fragment,null,e.resolved?s().createElement(H(),null):s().createElement(Y(),null)," ",e.resolved?"Remediated":"Not remediated")}])),cells:[{title:"Action",transforms:[f.p]},{title:"Reboot required",transforms:[f.p,(0,Fe.d)(20)]},{title:"Type",transforms:[f.p,(0,Fe.d)(15)]},{title:"Status",transforms:[f.p,(0,Fe.d)(20)]}],sortBy:n,onSort:(e,t,n)=>l({index:t,direction:n})},s().createElement(S.x,null),s().createElement(R.R,null))))};Oe.propTypes={issues:c().arrayOf(c().shape()),display_name:c().string};const ze=Oe;var Ve=n(21624),Ge=n.n(Ve),je=n(10241),Me=n.n(je),We=n(36309),He=n.n(We),Ue=n(77457),Ye=n(59671);const Ke=({connection_status:e,executor_type:t})=>{let n=e,a=t;return"string"==typeof e&&(n=e.toLowerCase()),"string"==typeof t&&(a=t.toLowerCase()),"connected"===n?s().createElement("span",null,s().createElement(Ge(),{className:"pf-u-mr-xs"})," Connected"):"none"===a?s().createElement(Ye.Popover,{triggerAction:"hover",headerContent:s().createElement(ge.Title,{headingLevel:"h4"},s().createElement(Me(),{className:"pf-u-mr-xs"}),"Connection not configured"),position:"left",bodyContent:s().createElement(Ue.Flex,{direction:{default:"column"},spaceItems:{default:"spaceItemsNone"}},s().createElement("span",null,s().createElement(Y(),{className:"pf-u-mr-xs"}),"Connect your system or the Red Hat Satellite instance to which your system is registered to Red Hat Insights."),s().createElement("a",{href:"https://access.redhat.com/documentation/en-us/red_hat_insights/1-latest/html/red_hat_insights_remediations_guide/host-communication-with-insights_red-hat-insights-remediation-guide",style:{textDecoration:"underline"}},"Please review this documentation"))},s().createElement(Ue.Flex,null,s().createElement(Me(),{className:"pf-u-mr-xs"}),s().createElement("p",{style:{borderBottomStyle:"dotted",maxWidth:"fit-content"}},"Not configured"))):"disconnected"!==n?s().createElement(Ye.Popover,{triggerAction:"hover",headerContent:s().createElement(ge.Title,{headingLevel:"h4"},s().createElement(He(),{className:"pf-u-mr-xs"}),"Connection status unknown"),position:"left",bodyContent:s().createElement(Ue.Flex,{direction:{default:"column"},spaceItems:{default:"spaceItemsNone"}},s().createElement("span",null,s().createElement(He(),{className:"pf-u-mr-xs"}),"To view connection status, contact your administrator to request the"," ",s().createElement("p",{className:"pf-v5-u-font-weight-bold"},"remediations:remediation:execute"," "),"permission within RBAC, and the"," ",s().createElement("p",{className:"pf-v5-u-font-weight-bold"},"\"Allow Insights users to use 'Remediations' to send Ansible Playbooks to fix issues on your systems\"")," ","permission within Remote Host Configuration Manager.",s().createElement("a",{href:"https://access.redhat.com/documentation/en-us/red_hat_insights/1-latest/html/red_hat_insights_remediations_guide/host-communication-with-insights_red-hat-insights-remediation-guide",style:{textDecoration:"underline"},className:"pf-u-ml-xs"},"Remote Host Configuration Manager.")))},s().createElement(Ue.Flex,null,s().createElement(He(),{className:"pf-u-mr-xs"}),s().createElement("p",{style:{borderBottomStyle:"dotted",maxWidth:"fit-content"}},"Unknown"))):"rhc"===a?s().createElement(Ye.Popover,{triggerAction:"hover",headerContent:s().createElement(ge.Title,{headingLevel:"h4"},s().createElement(Me(),{className:"pf-u-mr-xs"}),"System is disconnected"),position:"left",bodyContent:s().createElement(Ue.Flex,{direction:{default:"column"},spaceItems:{default:"spaceItemsNone"}},s().createElement("span",null,s().createElement(Y(),{className:"pf-u-mr-xs"}),"Red Hat Insights has been disconnected from this system"),s().createElement("a",{href:"https://access.redhat.com/documentation/en-us/red_hat_insights/1-latest/html/red_hat_insights_remediations_guide/host-communication-with-insights_red-hat-insights-remediation-guide",style:{textDecoration:"underline"}},"Please review this documentation"))},s().createElement(Ue.Flex,null,s().createElement(Me(),{className:"pf-u-mr-xs"}),s().createElement("p",{style:{borderBottomStyle:"dotted",maxWidth:"fit-content"}},"Disconnected"))):"rhc-satellite"===a?s().createElement(Ye.Popover,{triggerAction:"hover",headerContent:s().createElement(ge.Title,{headingLevel:"h4"},s().createElement(Me(),{className:"pf-u-mr-xs"}),"System is disconnected"),position:"left",bodyContent:s().createElement(Ue.Flex,{direction:{default:"column"},spaceItems:{default:"spaceItemsNone"}},s().createElement("span",null,s().createElement(Y(),{className:"pf-u-mr-xs"})," Red Hat Insights has been disconnected from the Red Hat Satellite instance that this system is registered to."),s().createElement("a",{href:"https://access.redhat.com/documentation/en-us/red_hat_insights/1-latest/html/red_hat_insights_remediations_guide/host-communication-with-insights_red-hat-insights-remediation-guide",style:{textDecoration:"underline"}},"Please review this documentation"))},s().createElement(Ue.Flex,null,s().createElement(Me(),{className:"pf-u-mr-xs"}),s().createElement("p",{style:{borderBottomStyle:"dotted",maxWidth:"fit-content"}},"Disconnected"))):void 0};Ke.propTypes={connection_status:c().string,executor_type:c().string};const Je=Ke,Qe=[{key:"display_name"},{key:"tags"},{key:"system_profile"},{key:"issues",title:"Issues",renderFunc:(e,t,{display_name:n})=>s().createElement(ze,{issues:e,display_name:n}),props:{width:15,isStatic:!0}},{key:"rebootRequired",title:"Reboot required",renderFunc:e=>s().createElement(Ae,{rebootRequired:e}),props:{width:15,isStatic:!0}},{key:"connection_status",title:"Connection Status",renderFunc:(e,t,{executor_type:n})=>s().createElement(Je,{connection_status:e,executor_type:n}),props:{width:15,isStatic:!0}}],Xe=({remediation:e,registry:t,refreshRemediation:n,connectedData:l,areDetailsLoading:i})=>{const[r,o]=(0,a.useState)(!1),c=(0,a.useRef)(),d=(0,a.useRef)((()=>{})),p=(0,a.useRef)(void 0),E=(0,m.useDispatch)(),g=(0,m.useSelector)((({entities:e})=>e?.selected||new Map)),h=(0,m.useSelector)((({entities:e})=>e?.loaded)),y=(0,m.useSelector)((({entities:e})=>e?.rows)),b=e=>e?.filter((e=>!0===e.selected)),f=e=>{switch(e){case"none":case"deselect all":c.current.map((e=>E((0,u.CL)(e.id,!1))));break;case"page":E((0,u.CL)(0,!0));break;case"deselect page":y.map((()=>E((0,u.CL)(0,!1))));break;case"all":c.current.map((e=>E((0,u.CL)(e.id,!0))))}};return(0,a.useEffect)((()=>{c.current=(0,Be.M1)(e)}),[e.id]),!i&&s().createElement(Q.Z,{variant:"compact",showTags:!0,noDetail:!0,hideFilters:{all:!0,name:!1},tableProps:{canSelectAll:!1},columns:e=>(0,Be.VA)(e,Qe),bulkSelect:{isDisabled:!y,count:g?g.size:0,items:[{title:"Select none (0)",onClick:()=>f("none")},{...h&&y&&y.length>0?{title:`Select page (${y.length})`,onClick:()=>{g?b(y).length===y.length?f("deselect page"):c.current.length>g.size?f("page"):f("deselect page"):f("page")}}:{}},{...h&&y&&y.length>0?{title:`Select all (${c.current.length})`,onClick:()=>{(0,Be.um)(c.current,g)?f("deselect all"):f("all")}}:{}}],checked:(0,Be.um)(c.current,g),onSelect:()=>{b(y).length===y.length?f("deselect page"):f("page")}},getEntities:async(e,t)=>(0,Be.Gx)(t,c.current,d.current,l),onLoad:({INVENTORY_ACTION_TYPES:e,mergeWithEntities:n,api:a})=>{d.current=a?.getEntities,t?.register?.({...n((0,te.L)(e))})},actions:[{title:"Remove system",onClick:(t,n,{id:a,display_name:s})=>{p.current={id:a,display_name:s,issues:e.issues.filter((e=>e.systems.find((({id:e})=>e===a))))},o(!0)}}]},h&&s().createElement(T.Button,{variant:"secondary",onClick:()=>o(!0),isDisabled:0===g.size},"Remove system"),s().createElement(Ze,{isOpen:r,onConfirm:()=>{(async()=>{const t=g.size>0?Array.from(g,(([,e])=>e)):[{...p.current}],a=(0,u.Ph)(t,e);E(a),await a.payload,n()})(),p.current=void 0,(0,x.q)({title:`Removed ${g.size} ${g.size>1?"systems":"system"} from playbook`,description:"",variant:"success",dismissable:!0,autoDismiss:!0}),o(!1)},selected:g.size>0?Array.from(g,(([,e])=>e)):[p.current],onClose:()=>{p.current=void 0,o(!1)},remediationName:e.name}))},et=e=>{const t=(0,m.useDispatch)(),[n,l]=(0,a.useState)();return(0,a.useEffect)((()=>{l(new Ce.ZP({selected:new Map},[xe()]))}),[]),n?s().createElement(m.Provider,{store:n.store},s().createElement(Xe,{registry:n,refreshRemediation:()=>t((0,u.d5)(e.remediation.id)),...e})):s().createElement(a.Fragment,null)};et.propTypes={remediation:c().shape({id:c().string,issues:c().arrayOf(c().shape({systems:c().arrayOf(c().shape({id:c().string,display_name:c().string,resolved:c().bool}))}))})},Xe.propTypes={...et.propTypes,registry:c().shape({register:c().func}),refreshRemediation:c().func};const tt=et;var nt=n(5756),at=n(62410);const st=({remediation:e,playbookRuns:t})=>{const[n,i]=(0,a.useState)([]),r=(0,a.useContext)(de.B);return(0,a.useEffect)((()=>{t&&t.length&&i((()=>(t=>t.reduce(((t,n,a)=>[...t,{isOpen:!1,cells:[{title:s().createElement(l.Z,{to:`/${e.id}/${n.id}`},s().createElement(at.Z,{type:"exact",date:n.created_at})),cellFormatters:[nt.zW]},n.created_by.last_name?`${n.created_by.first_name} ${n.created_by.last_name}`:`${n.created_by.username}`,{title:s().createElement(we.kf,{executorStatus:(0,we.fb)(n.status),counts:n.executors.reduce(((e,t)=>({pending:e.pending+t.counts.pending,running:e.running+t.counts.running,success:e.success+t.counts.success,failure:e.failure+t.counts.failure,canceled:e.canceled+t.counts.canceled,acked:e.acked+t.counts.acked})),{pending:0,running:0,success:0,failure:0,canceled:0,acked:0}),hasCancel:!0,remediationName:e.name,remediationId:e.id,playbookId:n.id,permission:r})}]},{parent:2*a,fullWidth:!0,cells:[{title:s().createElement(v.i,{"aria-label":"Compact expandable table",cells:["Connection","Systems","Playbook run status"],rows:n.executors.map((t=>({cells:[{title:s().createElement(l.Z,{to:`/${e.id}/${n.id}/${t.executor_id}`},t.executor_name)},t.system_count,{title:s().createElement(we.kf,{executorStatus:(0,we.fb)(t.status),counts:t.counts,permission:r})}]})))},s().createElement(S.x,null),s().createElement(R.R,null))}]}]),[]))(t)))}),[t]),s().createElement(v.i,{className:"rem-c-activity-table","aria-label":"Collapsible table",onCollapse:(e,t,a)=>{const s=[...n];s[t]={...s[t],isOpen:a},i(s)},rows:n,cells:["Run on","Run by","Status"]},s().createElement(S.x,null),s().createElement(R.R,null))};st.propTypes={remediation:c().object,playbookRuns:c().array};const lt=st;var it=n(26438),rt=n(75796),ot=n(73363);const ct=(e,t)=>{const[n,s]=(0,a.useState)(!1),[l,i]=(0,a.useState)(!1),r=(0,a.useRef)(!1),o=(0,a.useRef)(null),c=/^(?!\s).+(?<!\s)$/;return(0,a.useEffect)((()=>(r.current=!0,s(!0),o.current&&clearTimeout(o.current),o.current=setTimeout((()=>{r.current&&(async()=>{const n=e.trim(),a={};t&&t.forEach((e=>{a[e.name]=!0})),a[n]&&c.test(n)?i(!0):i(!1)})(),s(!1)}),500),()=>{r.current=!1,o.current&&clearTimeout(o.current)})),[e,t]),[n,l]};function mt(e){const[t,n]=(0,a.useState)(e.value||""),{title:l,onCancel:i,onSubmit:r,ariaLabel:o,className:c}=e,[m,u]=ct(t,e.remediationsList);return s().createElement(N.Modal,{title:l,isOpen:!0,onClose:e=>i(e),actions:[m?s().createElement(rt.Spinner,{size:"lg",className:"pf-u-mr-sm"}):s().createElement(T.Button,{key:"confirm",variant:"primary",onClick:()=>r(t),isDisabled:u||""===t.trim(),ouiaId:"save"},"Save"),s().createElement(T.Button,{key:"cancel",variant:"secondary",onClick:i,ouiaId:"cancel"},"Cancel")],variant:N.ModalVariant.small,className:c},s().createElement(w.FormGroup,{fieldId:"remediation-name",helperTextInvalid:"Playbook name has to contain alphanumeric characters",isValid:u},s().createElement(it.TextInput,{value:t,type:"text",onChange:(e,t)=>n(t),"aria-label":o||"input text",autoFocus:!0,isValid:!u,validated:t===e.value&&u?ot.ValidatedOptions.default:(""===t.trim()||u)&&ot.ValidatedOptions.error}),u&&t!==e.value&&s().createElement("p",{className:"pf-v5-u-font-size-sm pf-v5-u-danger-color-100"},"A playbook with the same name already exists within your organization. Try a different name."),""===t.trim()&&s().createElement("p",{className:"pf-v5-u-font-size-sm pf-v5-u-danger-color-100"},"Playbook name cannot be empty.")))}function ut({remediation:e,onRename:t,onDelete:n,remediationsList:l}){const[r,o]=(0,a.useState)(!1),[c,m]=(0,a.useState)(!1),[u,d]=(0,a.useState)(!1),p=(0,a.useContext)(de.B),E=(0,i.Z)();return s().createElement(s().Fragment,null,c&&s().createElement(mt,{title:"Edit playbook name",ariaLabel:"Playbook name",value:e.name,onCancel:()=>m(!1),onSubmit:n=>{m(!1),t(e.id,n),(0,x.q)({title:`Updated playbook name to ${n}`,description:"",variant:"success",dismissable:!0,autoDismiss:!0})},remediationsList:l}),s().createElement(V.Z,{isOpen:u,title:"Remove playbook?",text:"You will not be able to recover this Playbook",confirmText:"Remove playbook",onClose:t=>{d(!1),t&&(n(e.id),(0,x.q)({title:`Deleted playbook ${e.name}`,variant:"success",dismissable:!0,autoDismiss:!0}),E("/"))}}),p.permissions.write&&s().createElement(ne.L,{onSelect:e=>e,toggle:s().createElement(ae.a,{onToggle:()=>o((e=>!e))}),isOpen:r,position:se.ir.right,isPlain:!0},s().createElement(T.Button,{onClick:()=>m(!0),variant:"link"},"Rename"),s().createElement(T.Button,{className:"rem-c-button__danger-link",onClick:()=>d(!0),variant:"link",isDanger:!0},"Delete")))}mt.propTypes={title:c().string.isRequired,onCancel:c().func,onSubmit:c().func,ariaLabel:c().string,value:c().string,className:c().string,pattern:c().instanceOf(RegExp),remediationsList:c().array},ut.propTypes={remediation:c().object.isRequired,onRename:c().func.isRequired,onDelete:c().func.isRequired,remediationsList:c().array};const dt=(0,m.connect)(null,(e=>({onRename:(t,n)=>{n||(n="Unnamed Playbook");const a=n.trim();e((0,u.o6)(t,{name:a}))},onDelete:t=>e((0,u.YW)(t))})))(ut);var pt=n(80595),Et=n(60278);const gt=({isLoading:e,isDisabled:t,data:n,getConnectionStatus:l,issueCount:i,runRemediation:r,etag:o,remediationStatus:c,setEtag:m,areDetailsLoading:u,detailsError:d,permissions:p,remediation:E,connectedSystems:g,totalSystems:h})=>{const[y,b]=(0,a.useState)(!1),[f,v]=(0,a.useState)(!1);return(0,a.useEffect)((()=>{"changed"===c?(l(E.id),v(!0)):"fulfilled"===c&&b(!1)}),[c]),u?u?s().createElement(rt.Spinner,{size:"lg"}):null:s().createElement(s().Fragment,null,s().createElement(pt.Tooltip,{minWidth:"400px","aria-label":"details Tooltip",content:s().createElement(s().Fragment,null,s().createElement(Ue.Flex,{className:"pf-v5-u-ml-md",direction:{default:"column"},spaceItems:{default:"spaceItemsNone"},alignItems:{default:"alignItemsFlexStart"}},s().createElement(ge.Title,{headingLevel:"h6",className:"pf-v5-u-mb-md"},"Remediations Readiness Check"),s().createElement("span",{className:"pf-v5-u-font-size-sm"},0===g?s().createElement(Y(),{className:"pf-v5-u-mr-sm"}):s().createElement(H(),{className:"pf-v5-u-mr-sm"}),"Connected Systems (",g+"/"+h,"). See systems tab."),s().createElement("span",{className:"pf-v5-u-font-size-sm"},403===d?s().createElement(Y(),{className:"pf-v5-u-mr-sm"}):s().createElement(H(),{className:"pf-v5-u-mr-sm"}),s().createElement("a",{href:"https://console.redhat.com/insights/connector",style:{textDecoration:"underline",color:"white"},className:"pf-v5-u-mr-xs"},"RHC manager"),"is ",403===d?"disabled":"enabled","."),s().createElement("span",{className:"pf-v5-u-font-size-sm pf-v5-u-mb-sm"},p?s().createElement(H(),{className:"pf-v5-u-mr-sm"}):s().createElement(Y(),{className:"pf-v5-u-mr-sm"}),s().createElement("a",{href:"https://console.redhat.com/iam/user-access/overview",style:{textDecoration:"underline",color:"white"},className:"pf-v5-u-mr-xs"},"User access permissions"),"are ",p?"":"not"," granted.")))},s().createElement(T.Button,{isAriaDisabled:t,"data-testid":"execute-button-enabled",onClick:()=>{b(!0),l(E.id)}},"Execute playbook")),y&&s().createElement(Et.l,{isOpen:y,onClose:()=>{v(!1),b(!1)},showRefresh:f,remediationId:E.id,remediationName:E.name,data:n,etag:o,isLoading:e,issueCount:i,runRemediation:r,setEtag:m}))};gt.propTypes={isLoading:c().bool,data:c().array,getConnectionStatus:c().func,runRemediation:c().func,remediation:c().string,remediationStatus:c().string,issueCount:c().number,etag:c().string,setEtag:c().func,isDisabled:c().bool,disabledStateText:c().string,connectedSystems:c().number,areDetailsLoading:c().bool,detailsError:c().any,permissions:c().bool,totalSystems:c().number},gt.defaultProps={data:[],isDisabled:!1};const ht=gt,yt=(0,m.connect)((({connectionStatus:{data:e,status:t,etag:n},selectedRemediation:a,runRemediation:s,sources:l,executable:i})=>({data:e,isLoading:"fulfilled"!==t,issueCount:a.remediation.issues.length,etag:n,remediationStatus:s.status,sources:l,executable:i})),(e=>({getConnectionStatus:t=>{e((0,u.Zp)(t))},runRemediation:(t,n,a)=>{e((0,u.JW)(t,n,a)).then((()=>e((0,u.Is)(t))))},setEtag:t=>{e((0,u.Fo)(t))},getEndpoint:t=>{e((0,u.O3)(t))},checkExecutable:t=>{e((0,u.lh)(t))}})))(ht);var bt=n(83215),ft=n(13996);const vt=({onClose:e,...t})=>s().createElement(ft.Alert,{variant:"info",isInline:!0,title:"Put Insights into action",actionClose:s().createElement(ft.AlertActionCloseButton,{onClose:e,"data-testid":"upselBanner-close"}),...t},s().createElement(F.Stack,{hasGutter:!0},s().createElement(F.StackItem,null,"Enable push-button remediation across your hybrid cloud environment with Red Hat Satellite."),s().createElement(F.StackItem,null,s().createElement("a",{href:"https://www.redhat.com/en/technologies/management/satellite"},"Learn more")))),St=vt;vt.propTypes={onClose:c().func},vt.defaultProps={onClose:()=>{}};var Rt=n(98871),kt=n.n(Rt);const _t=()=>s().createElement(pe.Bullseye,null,s().createElement(Ee.EmptyState,null,s().createElement(Ee.EmptyStateHeader,{titleText:"Get more with Find it Fix it capabilities",icon:s().createElement(Ee.EmptyStateIcon,{icon:kt()}),headingLevel:"h5"}),s().createElement(Ee.EmptyStateBody,null,"Upgrade to Red Hat Satellite to remediate all your systems, across regions and geographies directly from Red Hat Insights."),s().createElement(Ee.EmptyStateFooter,null,s().createElement(T.Button,{variant:"link",component:"a",ouiaId:"learn_more",href:"https://www.redhat.com/en/technologies/management/satellite"},"Learn more"))));var xt=n(76744),Ct=n(2648),It=n(63456),Tt=n(39173),Nt=n(99087),wt=n(39467),Dt=n(64596),Zt=n(53774),Bt=n(48211),Ft=n(69409),qt=n(85998),At=n(65146),Lt=n(71070);const Pt=()=>{const e=s().createElement(a.Fragment,null,s().createElement(K.ToolbarItem,null,s().createElement(ne.L,{toggle:s().createElement(qt.Z,{isDisabled:!0,splitButtonItems:[s().createElement(At.o,{id:"skeleton-dropdown",key:"skeleton-dropdown","aria-label":"Loading Select all"})],id:"skeleton-dropdown-toggle"})})),s().createElement(K.ToolbarItem,null,s().createElement(Ft.InputGroup,null,s().createElement(Ft.InputGroupItem,{isFill:!0},s().createElement(it.TextInput,{value:"Search",isDisabled:!0,name:"skeleton-search",id:"skeleton-search",type:"search","aria-label":"search loading"})),s().createElement(Ft.InputGroupItem,null,s().createElement(T.Button,{isDisabled:!0,variant:"control","aria-label":"search button for search input"},s().createElement(Lt.ZP,null))))),s().createElement(K.ToolbarItem,null,s().createElement(T.Button,{isDisabled:!0,variant:"primary"},"Remove action")));return s().createElement(K.Toolbar,{id:"skeleton-toolbar"},s().createElement(K.ToolbarContent,null," ",e," "))},$t=()=>s().createElement(Bt.Tabs,{activeKey:0,className:"ins-s-tabs"},s().createElement(Bt.Tab,{eventKey:0,title:s().createElement(Bt.TabTitleText,null,"Actions")}),s().createElement(Bt.Tab,{eventKey:1,title:s().createElement(Bt.TabTitleText,null,"Systems")}),s().createElement(Bt.Tab,{eventKey:2,title:s().createElement(Bt.TabTitleText,null,"Activity")}));var Ot=n(9677),zt=n(10310),Vt=n(76400);const Gt=()=>s().createElement(s().Fragment,null,s().createElement(It.Z,{className:"rem-c-page-details__header"},s().createElement(Zt.Breadcrumb,null,s().createElement(Zt.BreadcrumbItem,null,s().createElement(l.Z,{to:"/"}," Remediations ")),s().createElement(Zt.BreadcrumbItem,{isActive:!0},s().createElement(A.Z,{size:"lg"}))),s().createElement(Dt.Level,{className:"rem-l-level"},s().createElement(Dt.LevelItem,null,s().createElement(Tt.Z,{className:"rem-s-page-header",title:s().createElement(s().Fragment,null,s().createElement(A.Z,{size:"md"}))})),s().createElement(Dt.LevelItem,null,s().createElement(B.Split,{hasGutter:!0},s().createElement(B.SplitItem,null,s().createElement(T.Button,{isDisabled:!0,variant:"link"},"Download playbook")),s().createElement(B.SplitItem,null,s().createElement(ne.L,{toggle:s().createElement(ae.a,{isDisabled:!0}),isOpen:!1,isPlain:!0}))))),s().createElement(jt,null)),s().createElement(Nt.ZP,null,s().createElement(F.Stack,{hasGutter:!0},s().createElement(F.StackItem,{className:"ins-c-playbookSummary__tabs"},s().createElement($t,null),s().createElement(Pt,null),s().createElement(Ct.Z,null))))),jt=()=>s().createElement(B.Split,null,s().createElement(B.SplitItem,null,s().createElement(Ot.z,{ariaDesc:"Resolved issues count",ariaTitle:"Resolved issues chart",constrainToVisibleArea:!0,data:{x:"Resolved",y:1},labels:({datum:e})=>e.x?`${e.x}: ${e.y}%`:null,title:"Loading",subTitle:"Issues resolved",subTitleComponent:s().createElement(zt.D,{y:102}),thresholds:[{value:100,color:"#3E8635"}],height:175,width:175,padding:{bottom:20,left:0,right:20,top:20}})),s().createElement(B.SplitItem,{className:"ins-c-remediation-summary__body"},s().createElement(F.Stack,{hasGutter:!0},s().createElement(F.StackItem,null,s().createElement(B.Split,null,s().createElement(B.SplitItem,null,s().createElement(Ue.Flex,null,s().createElement(Ue.FlexItem,{spacer:{default:"spacer-lg"}},s().createElement(Vt.Z,{title:"Total systems"},s().createElement(A.Z,{size:"md"}))))),s().createElement(B.SplitItem,null,s().createElement(Ue.Flex,null,s().createElement(Ue.FlexItem,{spacer:{default:"spacer-lg"}},s().createElement(Vt.Z,{title:"Latest activity"},s().createElement(A.Z,{size:"md"}))))))),s().createElement(F.StackItem,null,s().createElement(Ue.Flex,null,s().createElement(Ue.FlexItem,{spacer:{default:"spacer-lg"}},s().createElement(Vt.Z,{title:"Autoreboot"},s().createElement(A.Z,{size:"md"})))))))),Mt=()=>s().createElement(v.i,{"aria-label":"No activity",cells:["Run on","Run by","Status"],ouiaId:"activity-table",rows:[{cells:[{title:s().createElement(Ee.EmptyState,{className:"rem-c-activity-table__empty"},s().createElement(Ee.EmptyStateHeader,{titleText:"No activity",headingLevel:"h5"}),s().createElement(Ee.EmptyStateBody,null,"Execute this playbook to see a history and summary of the activity.")),props:{colSpan:3}}]}]},s().createElement(S.x,null),s().createElement(R.R,null));var Wt=n(82494),Ht=n(44278),Ut=n.n(Ht),Yt=n(71916),Kt=n.n(Yt),Jt=n(93967),Qt=n.n(Jt);const Xt=({remediation:e,playbookRuns:t,switchAutoReboot:n,context:a})=>{const i=t=>{n(e.id,t)},r=(t,n)=>{return t?s().createElement("div",null,s().createElement(Ut(),{className:"rem-c-success"}),s().createElement("b",{className:"ins-c-remediation-summary__reboot--enabled"}," Enabled "),a.permissions.write&&s().createElement(T.Button,{variant:"link",onClick:()=>i(!e.auto_reboot)},"Turn off")):(l=n,s().createElement("div",null,s().createElement(Kt(),null),s().createElement("b",{className:"ins-c-remediation-summary__reboot--disabled"+(l?"--warning":"")},"Off"),l&&s().createElement(s().Fragment,null,s().createElement(Ne(),{className:"ins-c-remediation-summary__reboot--required--icon"}),s().createElement("b",{className:"ins-c-remediation-summary__reboot--required"},`${r=(()=>{let t=0;for(const n of e.issues)n.resolution.needs_reboot&&t++;return t})()} issue${1===r?"":"s"} require${1===r?"s":""} reboot to remediate`)),a.permissions.write&&s().createElement(T.Button,{variant:"link",onClick:()=>i(!e.auto_reboot)},"Turn on")));var l,r},{stats:o}=e,c=o.systemsWithReboot+o.systemsWithoutReboot,m=(e=>{let t=0;return e.map((e=>e.systems.every((e=>e.resolved))&&t++)),t})(e.issues);return s().createElement(B.Split,null,s().createElement(B.SplitItem,null,s().createElement(Ot.z,{ariaDesc:"Resolved issues count",ariaTitle:"Resolved issues chart",constrainToVisibleArea:!0,data:{x:"Resolved",y:m/e.issues.length*100},labels:({data:e})=>e.x?`${e.x}: ${e.y}%`:null,title:`${m}/${e.issues.length}`,subTitle:"Issues resolved",subTitleComponent:s().createElement(zt.D,{y:102}),thresholds:[{value:100,color:"#3E8635"}],height:175,width:175,padding:{bottom:20,left:0,right:20,top:20}})),s().createElement(B.SplitItem,{className:"ins-c-remediation-summary__body"},s().createElement(F.Stack,{hasGutter:!0},s().createElement(F.StackItem,null,s().createElement(B.Split,null,s().createElement(B.SplitItem,null,s().createElement(Ue.Flex,null,s().createElement(Ue.FlexItem,{spacer:{default:"spacer-lg"}},s().createElement(Vt.Z,{title:"Total systems"},(d="system",1===(u=c)?`${u} ${d}`:`${u} ${d}s`))))),s().createElement(B.SplitItem,null,s().createElement(Ue.Flex,null,t&&(e=>{if(e.length){const t=e[0];return s().createElement(Ue.FlexItem,{spacer:{default:"spacer-xl"}},s().createElement(Vt.Z,{needsPointer:!0,className:"rem-c-description-list-latest-activity",title:"Latest activity"},s().createElement(we.kf,{executorStatus:t.status,counts:t.executors.reduce(((e,t)=>({pending:e.pending+t.counts.pending,running:e.running+t.counts.running,success:e.success+t.counts.success,failure:e.failure+t.counts.failure,canceled:e.canceled+t.counts.canceled,acked:e.acked+t.counts.acked})),{pending:0,running:0,success:0,failure:0,canceled:0,acked:0}),permission:{}}),s().createElement("span",{className:"rem-c-description-list-latest-activity__date"},s().createElement(at.Z,{type:"relative",date:t.updated_at})),s().createElement(l.Z,{to:`/${t.remediation_id}/${t.id}`},"View")))}})(t))))),s().createElement(F.StackItem,null,(e=>s().createElement(Vt.Z,{className:"rem-c-playbookSummary__settings",title:"Autoreboot"},s().createElement(Ue.Flex,null,s().createElement(Ue.FlexItem,{className:Qt()("ins-c-reboot-status",{"ins-c-reboot-status__enabled":e.auto_reboot&&e.needs_reboot},{"ins-c-reboot-status__disabled":!e.auto_reboot}),spacer:{default:"spacer-xl"}},r(e.auto_reboot,e.needs_reboot)))))(e)))));var u,d};Xt.propTypes={remediation:c().object.isRequired,playbookRuns:c().array,switchAutoReboot:c().func.isRequired,context:c().object.isRequired};var en=n(33366);const{API_BASE:tn}=n(93940);var nn=n(79790);const an=({selectedRemediation:e,selectedRemediationStatus:t,loadRemediation:n,loadRemediationStatus:o,switchAutoReboot:c,playbookRuns:m,getPlaybookRuns:u,checkExecutable:p,executable:E})=>{const g=(0,ye.Z)(),h=(0,i.Z)(),{id:y}=(0,r.useParams)(),[b,f]=(0,r.useSearchParams)(),{isFedramp:v,isBeta:S}=g,R=(0,a.useContext)(de.B),[k,_]=(0,a.useState)("dismissed"!==localStorage.getItem("remediations:bannerStatus")),[C,I]=(0,a.useState)("dismissed"!==localStorage.getItem("remediations:receptorBannerStatus"));(0,a.useEffect)((()=>{n(y).catch((e=>{if(!e||!e.response||404!==e.response.status)throw e;h("/")})),S?.()&&o(y),p(y)}),[]),(0,a.useEffect)((()=>{u(y)}),[u]),(0,a.useEffect)((()=>{if(m&&m.length&&"running"===(0,we.fb)(m[0].status)){const e=setInterval((()=>u(y)),1e4);return()=>{clearInterval(e)}}}),[m]);const{status:N,remediation:w}=e,[D,Z,q,A,L]=(e=>{const t=(0,en.Vk)(),[n,s]=(0,a.useState)(0),[l,i]=(0,a.useState)(0),[r,o]=(0,a.useState)(!0),[c,m]=(0,a.useState)(),[u,d]=(0,a.useState)([]),p=(0,a.useRef)(!1);let E=0,g=0;return(0,a.useEffect)((()=>(p.current=!0,e&&(async()=>{try{const n=await t.get(`${tn}/remediations/${e.id}/connection_status`);p.current&&(n.data.forEach((e=>{g+=e.system_count,"connected"===e.connection_status&&(E=e.system_count)})),s(E)),i(g),d(n.data)}catch(e){console.error(e),m(e?.errors[0].status||""),d(e?.errors[0].status),o(!1)}o(!1)})(),()=>{p.current=!1})),[e]),[n,l,r,c,u]})(w),P=(0,nn.Q)(w);return(0,a.useEffect)((()=>{w&&g.updateDocumentTitle(`${w.name} - Remediations - Automation`)}),[g,w]),"fulfilled"!==N&&"rejected"!==N?s().createElement(Gt,null):"rejected"===N?s().createElement(wt.Z,null):"fulfilled"===N?!1===R.permissions.read?s().createElement(xt.Z,null):s().createElement("div",{className:"page__remediation-details"},s().createElement(It.Z,null,s().createElement(Zt.Breadcrumb,null,s().createElement(Zt.BreadcrumbItem,null,s().createElement(l.Z,{to:"/"}," Remediations ")),s().createElement(Zt.BreadcrumbItem,{isActive:!0}," ",w.name," ")),s().createElement(Dt.Level,{className:"rem-l-level"},s().createElement(Dt.LevelItem,null,s().createElement(Tt.Z,{title:w.name})),s().createElement(Dt.LevelItem,null,s().createElement(B.Split,{hasGutter:!0},s().createElement(B.SplitItem,null,s().createElement(yt,{isDisabled:0===D||!R.permissions.execute||!E||v,connectedSystems:D,totalSystems:Z,areDetailsLoading:q,detailsError:A,permissions:R.permissions.execute,remediation:w})),s().createElement(B.SplitItem,null,s().createElement(T.Button,{isDisabled:!w.issues.length,variant:"secondary",onClick:()=>{(0,d.rN)(w.id),(0,x.q)({title:"Preparing playbook for download.",description:"Once complete, your download will start automatically.",variant:"info",dismissable:!0,autoDismiss:!0})}},"Download playbook")),s().createElement(B.SplitItem,null,s().createElement(dt,{remediation:w,remediationsList:P}))))),s().createElement(Xt,{remediation:w,playbookRuns:m,switchAutoReboot:c,context:R})),s().createElement(Nt.ZP,null,s().createElement(F.Stack,{hasGutter:!0},!E&&k&&s().createElement(F.StackItem,null,s().createElement(St,{onClose:()=>(_(!1),void localStorage.setItem("remediations:bannerStatus","dismissed"))})),E&&C&&s().createElement(F.StackItem,null,s().createElement(Wt.Z,{onClose:()=>(I(!1),void localStorage.setItem("remediations:receptorBannerStatus","dismissed"))})),s().createElement(F.StackItem,{className:"ins-c-playbookSummary__tabs"},s().createElement(Bt.Tabs,{activeKey:b.get("activeTab")||"issues",onSelect:(e,t)=>f({...Object.fromEntries(b),activeTab:t})},s().createElement(Bt.Tab,{eventKey:"issues",title:"Actions"},s().createElement(ke,{remediation:w,status:t})),s().createElement(Bt.Tab,{eventKey:"systems",title:"Systems"},s().createElement(tt,{remediation:w,connectedData:L,areDetailsLoading:q})),s().createElement(Bt.Tab,{eventKey:"activity",title:"Activity"},((e,t,n)=>e?Array.isArray(t)&&t.length?s().createElement(lt,{remediation:n,playbookRuns:t}):Array.isArray(t)&&!t.length?s().createElement(Mt,null):s().createElement(Ct.Z,null):s().createElement(_t,null))(E,m,w))))))):void 0};an.propTypes={selectedRemediation:c().object,selectedRemediationStatus:c().object,loadRemediation:c().func.isRequired,loadRemediationStatus:c().func.isRequired,switchAutoReboot:c().func.isRequired,deleteRemediation:c().func.isRequired,executePlaybookBanner:c().shape({isVisible:c().bool}),addNotification:c().func.isRequired,playbookRuns:c().array,getPlaybookRuns:c().func,checkExecutable:c().func,executable:c().object};const sn=(0,m.connect)((({selectedRemediation:e,selectedRemediationStatus:t,executePlaybookBanner:n,playbookRuns:a,executable:s})=>({selectedRemediation:e,selectedRemediationStatus:t,executePlaybookBanner:n,playbookRuns:a.data,remediation:e.remediation,executable:s})),(e=>({loadRemediation:t=>e(u.d5(t)),loadRemediationStatus:t=>e(u.uz(t)),switchAutoReboot:(t,n)=>e(u.o6(t,{auto_reboot:n})),deleteRemediation:t=>e(u.YW(t)),addNotification:t=>e((0,bt.wN)(t)),getPlaybookRuns:t=>e(u.Is(t)),checkExecutable:t=>e(u.lh(t))})))(an)},2648:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(10756),s=n.n(a),l=n(75863),i=n(43416),r=n(49004),o=n(32819),c=n(15433),m=n(87694),u=n(82814);class d extends s().Component{constructor(e){super(e),this.state={columns:[{title:s().createElement(o.Z,{size:"xs"})},{title:s().createElement(o.Z,{size:"sm"})},{title:s().createElement(o.Z,{size:"sm"})},{title:s().createElement(o.Z,{size:"md"})},{title:s().createElement(o.Z,{size:"sm"})}],rows:[[{title:s().createElement(o.Z,{size:"md"})},{title:s().createElement(o.Z,{size:"xs"})},{title:s().createElement(o.Z,{size:"xs"})},{title:s().createElement(o.Z,{size:"md"})},{title:s().createElement(o.Z,{size:"md"})}]]}}render(){const{columns:e,rows:t}=this.state;return s().createElement(a.Fragment,null,s().createElement(i.i,{cells:e,rows:t,"aria-label":"Loading",variant:l.B.compact,...this.props},s().createElement(r.x,null)),s().createElement(u.Z,{centered:!0},s().createElement(m.Z,null)),s().createElement(c.Z,{isFooter:!0,className:"rem-c-skeleton-table__footer rem-m-align-right"},s().createElement(o.Z,{size:"sm"})))}}const p=d}}]);
//# sourceMappingURL=../sourcemaps/RemediationDetails.25a9362e41109d013970b1003db13916.js.map