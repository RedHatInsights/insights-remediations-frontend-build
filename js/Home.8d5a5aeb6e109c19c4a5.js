"use strict";(self.webpackChunkremediations=self.webpackChunkremediations||[]).push([[5268],{80041:(e,t,s)=>{s.r(t),s.d(t,{default:()=>v});var i=s(10756),o=s.n(i),a=s(45697),n=s.n(a),r=s(55140);function l(e,t){if(!e)throw new TypeError(t)}function d(e,...t){Object.keys(e).forEach((e=>l(t.includes(e),`Unexpected key: ${e} Expected one of: ${t}`)))}function c(e,...t){t.forEach((t=>l(Object.prototype.hasOwnProperty.call(e,t),`Required key missing: ${t}`)))}function u(e){l(Array.isArray(e),"Systems must be an array"),l(e.length,"Systems array must not be empty"),e.forEach((e=>l("string"==typeof e,"System must be of type string")))}var p=s(10621),m=s(31593),h=s(80595),y=s(76910),E=s(86451);const b=({isDisabled:e,children:t,dataProvider:s,onRemediationCreated:a,buttonProps:n,patchNoAdvisoryText:b})=>{const[v,g]=(0,i.useState)(!1),[f,C]=(0,i.useState)(),[k,w]=(0,i.useState)(!1),S=(0,r.Z)();return(0,i.useEffect)((()=>{S.getUserPermissions("remediations").then((e=>{g(e.some((({permission:e})=>(0,p.P9)(e,p.FH))))}))}),[]),v?o().createElement(o().Fragment,null,o().createElement(m.Button,{isDisabled:e,"data-testid":"remediationButton-with-permissions",onClick:()=>{Promise.resolve(s()).then((e=>{e?(function(e){l("object"==typeof e&&null!==e),d(e,"issues","systems","onRemediationCreated"),c(e,"issues"),l(Array.isArray(e.issues),"Issues must be an array"),l(e.issues.length,"Issues array must not be empty"),e.issues.forEach((t=>{l("object"==typeof t&&null!==t,"Issue must be an object"),d(t,"id","description","systems"),c(t,"id","description"),Object.prototype.hasOwnProperty.call(t,"systems")&&u(t.systems),l(Object.prototype.hasOwnProperty.call(t,"systems")||Object.prototype.hasOwnProperty.call(e,"systems"),`No systems defined for ${t.id}`)})),Object.prototype.hasOwnProperty.call(e,"systems")&&u(e.systems)}(e),C(e)):w(!0)}))},...n},t),o().createElement(E.default,{isOpen:k,setOpen:w,patchNoAdvisoryText:b}),f&&o().createElement(y.default,{setOpen:e=>C((t=>!1===e?null:t)),data:{onRemediationCreated:a,...f||{}}})):o().createElement(h.Tooltip,{content:"You do not have correct permissions to remediate this entity."},o().createElement("span",null,o().createElement(m.Button,{isDisabled:!0,...n,"data-testid":"remediationButton-no-permissions"},t)))};b.propTypes={isDisabled:n().bool,dataProvider:n().func.isRequired,onRemediationCreated:n().func,children:n().node,buttonProps:n().shape({[n().string]:n().any}),patchNoAdvisoryText:n().string},b.defaultProps={isDisabled:!1,onRemediationCreated:e=>e,children:"Remediate with Ansible"};const v=b},86451:(e,t,s)=>{s.r(t),s.d(t,{NoDataModal:()=>d,default:()=>c});var i=s(10756),o=s.n(i),a=s(45697),n=s.n(a),r=s(31593),l=s(28685);const d=({isOpen:e,setOpen:t,patchNoAdvisoryText:s})=>o().createElement(l.Modal,{variant:l.ModalVariant.small,title:"Remediate with Ansible",isOpen:e,onClose:()=>t(!1),actions:[o().createElement(r.Button,{key:"confirm",variant:"primary",onClick:()=>t(!1)},"Back to Insights")]},s||o().createElement(o().Fragment,null,"None of the selected issues can be remediated with Ansible.",o().createElement("br",null),o().createElement("br",null),"To remediate these issues, review the manual remediation steps associated with each."));d.propTypes={isOpen:n().bool,setOpen:n().func,patchNoAdvisoryText:n().string};const c=d},87820:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ce});var i=s(10756),o=s.n(i),a=s(28216),n=s(40667),r=s(34413),l=s(33626),d=s(63456),c=s(39173),u=s(99087),p=s(96087),m=s(45697),h=s.n(m),y=s(39480),E=s(87694),b=s(95726),v=s(60278),g=s(76491),f=s(4799),C=s(29684),k=s(87282),w=s(65353),S=s(38296),_=s(41435),P=s(1774),R=s(80164),N=s(35224),D=s(73699);class I extends i.Component{constructor(){super(...arguments),this.ref=i.createRef(),this.additionalRef=i.createRef(),this.getInnerNode=e=>e&&e.childNodes&&e.childNodes.length?e.childNodes[0]:e,this.onKeyDown=e=>{var t,s,i,o,a,n,r,l,d,c;const u=e.target===this.ref.current?0:1;this.props.customChild||e.preventDefault(),"ArrowUp"===e.key?(null===(s=null===(t=this.props.context)||void 0===t?void 0:t.keyHandler)||void 0===s||s.call(t,this.props.index,u,P.KEYHANDLER_DIRECTION.UP),e.stopPropagation()):"ArrowDown"===e.key?(null===(o=null===(i=this.props.context)||void 0===i?void 0:i.keyHandler)||void 0===o||o.call(i,this.props.index,u,P.KEYHANDLER_DIRECTION.DOWN),e.stopPropagation()):"ArrowRight"===e.key?(null===(n=null===(a=this.props.context)||void 0===a?void 0:a.keyHandler)||void 0===n||n.call(a,this.props.index,u,P.KEYHANDLER_DIRECTION.RIGHT),e.stopPropagation()):"ArrowLeft"===e.key?(null===(l=null===(r=this.props.context)||void 0===r?void 0:r.keyHandler)||void 0===l||l.call(r,this.props.index,u,P.KEYHANDLER_DIRECTION.LEFT),e.stopPropagation()):"Enter"!==e.key&&" "!==e.key||(e.target.click(),this.props.enterTriggersArrowDown&&(null===(c=null===(d=this.props.context)||void 0===d?void 0:d.keyHandler)||void 0===c||c.call(d,this.props.index,u,P.KEYHANDLER_DIRECTION.DOWN)))},this.componentRef=e=>{this.ref.current=e;const{component:t}=this.props,s=t.ref;s&&("function"==typeof s?s(e):s.current=e)}}componentDidMount(){var e;const{context:t,index:s,isDisabled:i,role:o,customChild:a,autoFocus:n}=this.props,r=a?this.getInnerNode(this.ref.current):this.ref.current;null===(e=null==t?void 0:t.sendRef)||void 0===e||e.call(t,s,[r,a?r:this.additionalRef.current],i,"separator"===o),n&&setTimeout((()=>r.focus()))}componentDidUpdate(){var e;const{context:t,index:s,isDisabled:i,role:o,customChild:a}=this.props,n=a?this.getInnerNode(this.ref.current):this.ref.current;null===(e=null==t?void 0:t.sendRef)||void 0===e||e.call(t,s,[n,a?n:this.additionalRef.current],i,"separator"===o)}extendAdditionalChildRef(){const{additionalChild:e}=this.props;return i.cloneElement(e,{ref:this.additionalRef})}render(){const e=this.props,{className:t,children:s,context:o,onClick:a,component:n,role:r,isDisabled:l,isAriaDisabled:d,isPlainText:c,index:u,href:p,tooltip:m,tooltipProps:h,id:y,componentID:E,listItemClassName:b,additionalChild:v,customChild:g,enterTriggersArrowDown:f,icon:C,autoFocus:k,styleChildren:P,description:I,inoperableEvents:T}=e,O=(0,w.__rest)(e,["className","children","context","onClick","component","role","isDisabled","isAriaDisabled","isPlainText","index","href","tooltip","tooltipProps","id","componentID","listItemClassName","additionalChild","customChild","enterTriggersArrowDown","icon","autoFocus","styleChildren","description","inoperableEvents"]);let x=(0,S.css)(C&&D.Z.modifiers.icon,d&&D.Z.modifiers.ariaDisabled,t);"a"===n?O["aria-disabled"]=l||d:"button"===n&&(O["aria-disabled"]=l||d,O.type=O.type||"button");const A=e=>i.cloneElement(e,Object.assign(Object.assign({},P&&{className:(0,S.css)(e.props.className,x)}),"separator"!==this.props.role&&{role:r,ref:this.componentRef})),q=e=>{const t=e,o=I?i.createElement(i.Fragment,null,i.createElement("div",{className:D.Z.dropdownMenuItemMain},C&&i.createElement("span",{className:(0,S.css)(D.Z.dropdownMenuItemIcon)},C),s),i.createElement("div",{className:D.Z.dropdownMenuItemDescription},I)):i.createElement(i.Fragment,null,C&&i.createElement("span",{className:(0,S.css)(D.Z.dropdownMenuItemIcon)},C),s);return i.createElement(t,Object.assign({},O,l||d?(0,R.KG)(T):null,{href:p,ref:this.ref,className:x,id:E,role:r}),o)};return i.createElement(_.Dl.Consumer,null,(({onSelect:e,itemClass:t,disabledClass:s,plainTextClass:o})=>{return"separator"!==this.props.role&&(x=(0,S.css)(x,l&&s,c&&o,t,I&&D.Z.modifiers.description)),g?i.cloneElement(g,{ref:this.ref,onKeyDown:this.onKeyDown}):i.createElement("li",Object.assign({},b&&{className:b},{role:"none",onKeyDown:this.onKeyDown,onClick:t=>{l||d||(null==a||a(t),null==e||e(t))},id:y}),(r=i.isValidElement(n)?A(n):q(n),m?i.createElement(N.u,Object.assign({content:m},h),r):r),v&&this.extendAdditionalChildRef());var r}))}}I.displayName="InternalDropdownItem",I.defaultProps={className:"",component:"a",role:"none",isDisabled:!1,isPlainText:!1,tooltipProps:{},onClick:e=>{},index:-1,context:{keyHandler:()=>{},sendRef:()=>{}},enterTriggersArrowDown:!1,icon:null,styleChildren:!0,description:null,inoperableEvents:["onClick","onKeyPress"]};var T=s(62472);const O=e=>{var{children:t,className:s,component:o="a",isDisabled:a=!1,isAriaDisabled:n=!1,isPlainText:r=!1,href:l,tooltip:d,tooltipProps:c={},listItemClassName:u,onClick:p,ref:m,additionalChild:h,customChild:y,tabIndex:E=-1,icon:b=null,autoFocus:v,description:g=null,styleChildren:f,ouiaId:C,ouiaSafe:k}=e,S=(0,w.__rest)(e,["children","className","component","isDisabled","isAriaDisabled","isPlainText","href","tooltip","tooltipProps","listItemClassName","onClick","ref","additionalChild","customChild","tabIndex","icon","autoFocus","description","styleChildren","ouiaId","ouiaSafe"]);const P=(0,T.useOUIAProps)(O.displayName,C,k);return i.createElement(_.e4.Consumer,null,(e=>i.createElement(I,Object.assign({context:e,role:"menuitem",tabIndex:E,className:s,component:o,isDisabled:a,isAriaDisabled:n,isPlainText:r,href:l,tooltip:d,tooltipProps:c,listItemClassName:u,onClick:p,additionalChild:h,customChild:y,icon:b,autoFocus:v,styleChildren:f,description:g},P,S),t)))};O.displayName="DropdownItem";var x=s(79332),A=s(30120),q=s(44278),H=s.n(q),B=s(62410),L=s(83215),j=s(92397),V=s(75998);function U(e,t,s){Promise.all(e.map((e=>(s(e),e.payload)))).then(t)}const G=({remediation:e,remediationIdx:t,archived:s,selector:l,setExecuteOpen:d,update:c,loadRemediation:u,getConnectionStatus:p,downloadPlaybook:m,permission:h,showArchived:y})=>{const[E,b]=(0,i.useState)(!1),[v,f]=(0,i.useState)(s),C=(0,a.useDispatch)(),w=[],S=()=>{U([(0,r.o6)(e.id,{archived:!v})],(()=>{l.getSelectedIds().includes(e.id)&&!y&&l.props.onSelect(void 0,!1,t),f(!v),c(!0)}),C)};return w.push(o().createElement(O,{key:"execute",id:"execute",isDisabled:!h.isReceptorConfigured||v,className:`${!h.permissions.execute&&"ins-m-not-entitled"}`,onClick:()=>{d(!1),U([u(e.id),p(e.id)],(()=>{d(!0),b(!1)}),C)}},"Execute playbook")),w.push(o().createElement(O,{key:"download",onClick:()=>{m([e.id]),b(!1),(0,V.q)({title:"Preparing playbook for download",description:"Once complete, your download will start automatically.",variant:"info",dismissable:!0,autoDismiss:!0})}},"Download playbook")),v?w.push(o().createElement(O,{key:"restore",onClick:()=>{S(),b(!1),C((0,L.wN)({variant:"info",title:`Restored playbook ${e.name}`}))}},"Restore playbook")):w.push(o().createElement(O,{key:"archive",onClick:()=>{S(),b(!1),C((0,L.wN)({variant:"info",title:`Archived playbook ${e.name}`}))}},"Archive playbook")),o().createElement(g.CardHeader,{actions:{actions:o().createElement(o().Fragment,null,o().createElement(x.L,{key:"dropdown",id:`${e.id}-dropdown`,isOpen:E,isPlain:!0,onSelect:e=>e,toggle:o().createElement(A.a,{id:`${e.id}-toggle`,onToggle:(e,t)=>b(t)}),dropdownItems:w,position:"right"}),o().createElement("input",{type:"checkbox",name:`${e.id}-checkbox`,checked:l.getSelectedIds().includes(e.id),onChange:e=>{l.props.onSelect(e,e.target.checked,t)},"aria-label":`${e.id}-checkbox`})),hasNoOffset:!1,className:void 0},className:"rem-c-playbook-card__header"},o().createElement(g.CardTitle,null,o().createElement(n.Stack,{hasGutter:!0},o().createElement(n.StackItem,{className:"rem-c-playbook-card__header--title"},o().createElement("span",{className:"pf-u-mr-sm"},(_=e.name,P=e.id,o().createElement(j.Z,{to:`/${P}`,className:"rem-c-playbook-card__header--name"},_))),v&&o().createElement(k.Label,null,"Archived")),o().createElement(n.StackItem,{className:"rem-c-playbook-card__header--last-modified"},"Last modified: ",o().createElement(B.Z,{date:e.updated_at})))));var _,P};G.propTypes={remediation:m.PropTypes.object.isRequired,remediationIdx:m.PropTypes.number.isRequired,archived:m.PropTypes.bool.isRequired,selector:m.PropTypes.object.isRequired,setExecuteOpen:m.PropTypes.func.isRequired,update:m.PropTypes.func.isRequired,loadRemediation:m.PropTypes.func.isRequired,getConnectionStatus:m.PropTypes.func.isRequired,downloadPlaybook:m.PropTypes.func.isRequired,permission:m.PropTypes.object.isRequired,showArchived:m.PropTypes.bool.isRequired};const Z=({remediation:e,remediationIdx:t,archived:s,selector:i,setExecuteOpen:a,update:r,loadRemediation:l,getConnectionStatus:d,downloadPlaybook:c,permission:u,showArchived:p})=>{return o().createElement(g.Card,{className:"rem-c-playbook-card",isCompact:!0},o().createElement(G,{remediation:e,remediationIdx:t,archived:s,selector:i,setExecuteOpen:a,update:r,loadRemediation:l,getConnectionStatus:d,downloadPlaybook:c,permission:u,showArchived:p}),o().createElement(g.CardBody,{className:"rem-c-playbook-card__body"},o().createElement(C.Split,{hasGutter:!0,className:"rem-c-playbook-card__body--split"},o().createElement(C.SplitItem,null,o().createElement(n.Stack,null,o().createElement(n.StackItem,{className:"rem-c-playbook-card__body--titles"},"Systems"),o().createElement(n.StackItem,{className:"rem-c-playbook-card__body--values"},e.system_count))),o().createElement(C.SplitItem,null,o().createElement(n.Stack,null,o().createElement(n.StackItem,{className:"rem-c-playbook-card__body--titles"},"Complete actions"),o().createElement(n.StackItem,{className:"rem-c-playbook-card__body--values"},(m=e.resolved_count)===(h=e.issue_count)&&0!==m?o().createElement("div",null,o().createElement(H(),{className:"rem-c-success"})," ",m," of  ",h):`${m} of ${h}`))))),((e,t,s)=>s?o().createElement(f.Progress,{className:"rem-c-playbook-card__progress rem-c-playbook-card__progress--archived",value:100,measureLocation:f.ProgressMeasureLocation.none}):e===t&&0!==e?o().createElement(f.Progress,{className:"rem-c-playbook-card__progress rem-c-playbook-card__progress--success",value:100,measureLocation:f.ProgressMeasureLocation.none,variant:f.ProgressVariant.success}):o().createElement(f.Progress,{className:"rem-c-playbook-card__progress  rem-c-playbook-card__progress--archived",value:e/t*100,measureLocation:f.ProgressMeasureLocation.none}))(e.resolved_count,e.issue_count,s));var m,h};Z.propTypes={remediation:m.PropTypes.object.isRequired,remediationIdx:m.PropTypes.number.isRequired,archived:m.PropTypes.bool.isRequired,selector:m.PropTypes.object.isRequired,setExecuteOpen:m.PropTypes.func.isRequired,update:m.PropTypes.func.isRequired,loadRemediation:m.PropTypes.func.isRequired,getConnectionStatus:m.PropTypes.func.isRequired,downloadPlaybook:m.PropTypes.func.isRequired,permission:m.PropTypes.object.isRequired,showArchived:m.PropTypes.bool.isRequired};var F=s(45791),K=s(31593),$=s(4252),M=s(86929),W=s.n(M);const Y=({archivedCount:e,setShowArchived:t})=>o().createElement(F.Bullseye,{className:"rem-c-no-remediations pf-u-pt-2xl"},o().createElement($.EmptyState,null,o().createElement($.EmptyStateHeader,{titleText:"No remediation playbooks yet",icon:o().createElement($.EmptyStateIcon,{icon:W(),size:"sm"}),headingLevel:"h5"}),o().createElement($.EmptyStateBody,null,"Insights uses Ansible Playbooks to remediate or mitigate configuration problems on your systems, and apply patches.",o().createElement("br",null),o().createElement("br",null),"To create a remediation playbook, select issues identified in Insights applications, then select",o().createElement("strong",null," Remediate"),"."),o().createElement($.EmptyStateFooter,null,o().createElement("br",null),e>0&&o().createElement(K.Button,{variant:"link",onClick:()=>t(!0),ouiaId:"show-archived-playbooks"},"Show ",e," archived playbooks"))));Y.propTypes={archivedCount:h().number.isRequired,setShowArchived:h().func.isRequired};const z=[null,"name","system_count","issue_count","updated_at"];function Q({remediations:e,loadRemediations:t,sorter:s,filter:d,selector:c,pagination:p,shouldUpdateGrid:m,setShouldUpdateGrid:h,setRemediationCount:g,showArchived:f,setShowArchived:C}){const{value:k,status:w}=e;let S=[];const _=(0,i.useContext)(b.B),[P,R]=(0,i.useState)(!1),[N,D]=(0,i.useState)(!1),I=(0,a.useSelector)((e=>e.selectedRemediation)),T=(0,a.useSelector)((e=>e.connectionStatus)),O=(0,a.useSelector)((e=>e.runRemediation)),x=(0,a.useDispatch)();return(0,i.useEffect)((()=>{!0===m&&(h(!1),function(){const e=z[s.sortBy];if(f)t(e,s.sortDir,d.value,p.pageSize,p.offset);else{const i=!0;t(e,s.sortDir,d.value,p.pageSize,p.offset,void 0,i)}}())}),[m]),(0,i.useEffect)((()=>{"changed"===O.status?((0,r.Zp)(I.remediation.id),D(!0)):"fulfilled"===O.status&&R(!1)}),[O.status]),(0,i.useEffect)((()=>{e.value&&g(k.meta.total)}),[e]),"fulfilled"!==w?o().createElement(o().Fragment,null,o().createElement(u.ZP,null,o().createElement(E.Z,{centered:!0}))):(S=f?k?.data?.map((e=>e)):k?.data?.reduce(((e,t)=>(!0!==t.archived&&e.push(t),e)),[]),0===S.length?o().createElement(Y,{archivedCount:k.data.length,setShowArchived:C}):(c.register(S),o().createElement(o().Fragment,null,o().createElement(n.Stack,{hasGutter:!0},o().createElement(n.StackItem,null,P&&o().createElement(v.l,{isOpen:P,onClose:()=>{D(!1),R(!1)},showRefresh:N,remediationId:I.remediation.id,data:T.data,etag:T.etag,isLoading:"fulfilled"!==T.status,issueCount:I.remediation.issues.length,remediationStatus:O.status,runRemediation:(e,t)=>{x((0,r.JW)(e,t)).then((()=>x((0,r.Is)(e))))},setEtag:e=>{x((0,r.Fo)(e))}})),o().createElement(n.StackItem,null,o().createElement(y.Grid,{sm:12,md:6,lg:4,hasGutter:!0},S.map(((e,t)=>o().createElement(y.GridItem,{key:e.id},o().createElement(Z,{remediation:e,remediationIdx:t,archived:e.archived,selector:c,setExecuteOpen:R,executeOpen:P,update:h,loadRemediation:r.d5,getConnectionStatus:r.Zp,downloadPlaybook:l.rN,permission:_,showArchived:f}))))))))))}Q.propTypes={remediations:h().object.isRequired,loadRemediations:h().func.isRequired,sorter:h().object.isRequired,filter:h().object.isRequired,selector:h().object.isRequired,pagination:h().object.isRequired,shouldUpdateGrid:h().bool.isRequired,setShouldUpdateGrid:h().func.isRequired,setRemediationCount:h().func.isRequired,showArchived:h().bool.isRequired,setShowArchived:h().func.isRequired};const J=Q;var X=s(80041);class ee extends o().Component{constructor(e){super(e),this.state={allHosts:!1}}isEnabled=()=>"true"===localStorage.getItem("remediations:debug");dataProviderPing=()=>({issues:[{id:"test:ping",description:"Ansible ping"}],systems:this.state.allHosts});dataProviderA1=()=>({issues:[{id:"vulnerabilities:CVE-2019-3815",description:"CVE-2019-3815"}],systems:this.state.allHosts});dataProviderA2=()=>({issues:[{id:"advisor:network_bond_opts_config_issue|NETWORK_BONDING_OPTS_DOUBLE_QUOTES_ISSUE",description:"Bonding will not fail over to the backup link when bonding options are partially read",systems:this.state.allHosts.slice(0,5)}]});dataProviderC1=()=>({issues:[{id:"vulnerabilities:CVE-2019-3815",description:"CVE-2019-3815"},{id:"vulnerabilities:CVE-2018-16865",description:"CVE-2018-16865"},{id:"vulnerabilities:CVE-2017-17712",description:"CVE-2017-17712"}],systems:this.state.allHosts.slice(-1)});dataProviderC2=()=>({issues:[{id:"advisor:network_bond_opts_config_issue|NETWORK_BONDING_OPTS_DOUBLE_QUOTES_ISSUE",description:"Bonding will not fail over to the backup link when bonding options are partially read"},{id:"advisor:rhnsd_pid_world_write|RHNSD_PID_WORLD_WRITABLE",description:"Code injection risk or wrong pid altering when rhnsd daemon file rhnsd.pid is world writable, due to a bug in rhnsd"}],systems:this.state.allHosts.slice(-1)});dataProviderC3=()=>({issues:[...this.dataProviderC1().issues,...this.dataProviderC2().issues],systems:this.state.allHosts.slice(-1)});dataProviderC4=()=>({issues:[{id:"advisor:network_bond_opts_config_issue|NETWORK_BONDING_OPTS_DOUBLE_QUOTES_ISSUE",description:"Bonding will not fail over to the backup link when bonding options are partially read"},{id:"advisor:corosync_enable_rt_schedule|COROSYNC_NOT_ENABLE_RT",description:"Cluster nodes are frequently fenced as realtime is not enabled in corosync"},{id:"advisor:CVE_2017_6074_kernel|KERNEL_CVE_2017_6074",description:"Kernel vulnerable to local privilege escalation via DCCP module (CVE-2017-6074)"}],systems:this.state.allHosts.slice(-1)});dataProviderC5=()=>({issues:[{id:"advisor:unsupported",description:"Unsupported issue"},{id:"vulnerabilities:CVE-2019-999999",description:"Unsupported issue"},{id:"advisor:CVE_2017_6074_kernel|KERNEL_CVE_2017_6074",description:"Kernel vulnerable to local privilege escalation via DCCP module (CVE-2017-6074)"}],systems:this.state.allHosts.slice(-1)});dataProviderD1=()=>({issues:[{id:"vulnerabilities:CVE-2019-3815",description:"CVE-2019-3815",systems:this.state.allHosts.slice(0,1)},{id:"vulnerabilities:CVE-2018-16865",description:"CVE-2018-16865",systems:this.state.allHosts.length>1?this.state.allHosts.slice(1,2):this.state.allHosts.slice(0,1)},{id:"vulnerabilities:CVE-2017-17712",description:"CVE-2017-17712"}],systems:this.state.allHosts});dataProviderD2=()=>({issues:[{id:"advisor:network_bond_opts_config_issue|NETWORK_BONDING_OPTS_DOUBLE_QUOTES_ISSUE",description:"Bonding will not fail over to the backup link when bonding options are partially read",systems:this.state.allHosts.slice(0,1)},{id:"advisor:rhnsd_pid_world_write|RHNSD_PID_WORLD_WRITABLE",description:"Code injection risk or wrong pid altering when rhnsd daemon file rhnsd.pid is world writable, due to a bug in rhnsd",systems:this.state.allHosts.slice(1)}]});async componentDidMount(){this.isEnabled()&&(0,l.yY)().then((e=>this.setState({allHosts:e.results.map((e=>e.id))})))}render(){if(!this.isEnabled())return null;const{allHosts:e}=this.state,t=({dataProvider:t,children:s,...i})=>o().createElement(C.SplitItem,null,o().createElement(X.default,{dataProvider:t,isDisabled:!e||!e.length,onRemediationCreated:this.props.onRemediationCreated,...i},s));return o().createElement(o().Fragment,null,o().createElement(n.Stack,{hasGutter:!0},o().createElement(n.StackItem,null,o().createElement(C.Split,{hasGutter:!0},["ping","alwaysFail","failHalfTheTime","pause1m","pause5m","pause15m","pauseRandom15m","pause1h","pause6h"].map((e=>o().createElement(t,{key:e,dataProvider:()=>({issues:[{id:`test:${e}`,description:`Ansible ${e} test playbook`}],systems:this.state.allHosts})},e))))),o().createElement(n.StackItem,null,o().createElement(C.Split,{hasGutter:!0},o().createElement(t,{dataProvider:this.dataProviderA1},"A1"),o().createElement(t,{dataProvider:this.dataProviderA2},"A2"),o().createElement(t,{dataProvider:this.dataProviderC1},"C1"),o().createElement(t,{dataProvider:this.dataProviderC2},"C2"),o().createElement(t,{dataProvider:this.dataProviderC3},"C3"),o().createElement(t,{dataProvider:this.dataProviderC4},"C4 (multires)"),o().createElement(t,{dataProvider:this.dataProviderC5},"C5 (unsupported)"),o().createElement(t,{dataProvider:this.dataProviderD1},"D1"),o().createElement(t,{dataProvider:this.dataProviderD2},"D2")))))}}ee.propTypes={onRemediationCreated:h().func,dataProvider:h().func,children:h().node},ee.defaultProps={onRemediationCreated:e=>e};const te=ee;var se=s(76744),ie=s(82494),oe=s(38318),ae=s(37903),ne=s(24350),re=s.n(ne),le=s(55140);const de=[null,"name","system_count","issue_count","updated_at"],ce=()=>{const e=(0,le.Z)();(0,i.useEffect)((()=>{e.updateDocumentTitle("Remediations - Automation")}),[e]);const[t,s]=(0,i.useState)("dismissed"!==localStorage.getItem("remediations:receptorBannerStatus")),m=(0,oe.sk)(4,"desc"),h=(0,oe.L0)(),y=(0,oe.v9)(),E=(0,oe.h0)(),[v,g]=(0,i.useState)(0),[f,C]=(0,i.useState)(""),[k,w]=(0,i.useState)(!1),[S,_]=(0,i.useState)("true"===localStorage.getItem("remediations:showArchived")),[P,R]=(0,i.useState)(!1),N=(0,a.useSelector)((e=>e.remediations)),D=(0,a.useDispatch)(),I=(...e)=>D(r.ch(...e)),T=N?.value?.data.length||0;(0,i.useEffect)((function(){const e=de[m.sortBy];if(S)I(e,m.sortDir,h.value,E.pageSize,E.offset);else{const t=!0;I(e,m.sortDir,h.value,E.pageSize,E.offset,void 0,t)}}),[]),(0,i.useEffect)((()=>{"fulfilled"===N.status&&h.value===f&&R(!0)}),[m.sortBy,m.sortDir,h.value,E.pageSize,E.pageDebounced,S]),(0,i.useEffect)((()=>{h.setValue(f)}),[f]),h.onChange(E.reset),m.onChange(E.reset);const O=y.getSelectedIds(),x=e=>{var t;t=e.getNotification(),D((0,L.wN)(t)),D(r.ch())},A={filters:f.length?[{category:"Name",chips:[{name:f}]}]:[],onDelete:()=>{C(""),h.setValue("")}};return o().createElement("div",{className:"page__remediations"},o().createElement(b.B.Consumer,null,(e=>!1===e.permissions.read?o().createElement(se.Z,null):o().createElement(o().Fragment,null,o().createElement(d.Z,null,o().createElement(c.Z,{title:"Remediations"}),o().createElement(te,{onRemediationCreated:x})),o().createElement(p.Z,{filterConfig:{items:[{label:"Search playbooks",type:"text",filterValues:{id:"filter-by-string",key:"filter-by-string",placeholder:"Search playbooks",value:f,onChange:(e,t)=>{C(t)}}}]},bulkSelect:{items:[{title:"Select none",onClick:()=>y.props.onSelect("none",!0)},{title:`Select page (${T})`,onClick:()=>y.props.onSelect("page",!0)}],checked:O.length&&v>O.length?null:O.length,count:O.length,isDisabled:!T,onSelect:e=>y.props.onSelect(O.length?"none":"page",e)},actionsConfig:{actions:[{label:O.length>1?"Download playbooks":"Download playbook",props:{variant:"secondary",isDisabled:!O.length},onClick:()=>function(e,t,s){const i=function(e,t){let s=[];const i=re()(t,(e=>e.id));return s=e.reduce(((e,t)=>{const s=i[t];return s&&s.issue_count>0&&e.push(s.id),e}),[]),s}(e,t);0===i.length?s((0,L.wN)({variant:"danger",title:"No playbooks downloaded.",description:e.length>1?"Selected remediations do not contain any issues to remediate.":"Selected remediation does not contain any issues to remediate."})):i.length<e.length?((0,l.rN)(i),s((0,L.wN)({variant:"success",title:i.length>1?"Downloading playbooks":"Downloading playbook",description:e.length-i.length>1?e.length-i.length+" remediations with no issues were not downloaded.":"1 remediation with no issues was not downloaded."}))):((0,l.rN)(i),s((0,L.wN)({variant:"success",title:i.length>1?"Downloading playbooks":"Downloading playbook"})))}(O,N.value.data,D)},{label:"Delete playbooks",props:{isDisabled:!e.permissions.write||!O.length},onClick:()=>w(!0)},{label:S?"Hide archived playbooks":"Show archived playbooks",onClick:S?()=>{_(!1),y.reset(),localStorage.setItem("remediations:showArchived","false")}:()=>{_(!0),y.reset(),localStorage.setItem("remediations:showArchived","true")}}]},pagination:{...E.props,itemCount:v},activeFiltersConfig:A}),o().createElement(u.ZP,null,o().createElement(n.Stack,{hasGutter:!0},e.hasSmartManagement&&!e.isReceptorConfigured&&t&&o().createElement(n.StackItem,null,o().createElement(ie.Z,{onClose:()=>(s(!1),void localStorage.setItem("remediations:receptorBannerStatus","dismissed"))})),k&&o().createElement(ae.Z,{title:1===O.length?"Remove playbook":"Remove playbooks",text:`${O.length} ${O.length>1?"playbooks":"playbook"}\n                                            will be removed from Remediations. This is permanent and cannot be undone.`,confirmText:"Remove",onClose:async e=>{var t;w(!1),e&&(await(t=O,D(r.w8({remediation_ids:t}))),I(),y.reset())}}),o().createElement(n.StackItem,null,o().createElement(J,{remediations:N,loadRemediations:I,sorter:m,filter:h,selector:y,pagination:E,shouldUpdateGrid:P,setShouldUpdateGrid:R,setRemediationCount:g,showArchived:S,setShowArchived:_}))))))))}}}]);
//# sourceMappingURL=../sourcemaps/Home.af99caa96ef561714fb1cac829dfded5.js.map