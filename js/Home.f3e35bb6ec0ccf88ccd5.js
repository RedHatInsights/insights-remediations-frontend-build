"use strict";(self.webpackChunkremediations=self.webpackChunkremediations||[]).push([[5268],{2793:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var r=n(4942),o=n(87462),i=n(29439),a=n(92950),s=n.n(a),l=n(45697),c=n.n(l),d=n(55140),u=n(71002);function p(e,t){if(!e)throw new TypeError(t)}function m(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Object.keys(e).forEach((function(e){return p(n.includes(e),"Unexpected key: ".concat(e," Expected one of: ").concat(n))}))}function f(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach((function(t){return p(Object.prototype.hasOwnProperty.call(e,t),"Required key missing: ".concat(t))}))}function h(e){p(Array.isArray(e),"Systems must be an array"),p(e.length,"Systems array must not be empty"),e.forEach((function(e){return p("string"==typeof e,"System must be of type string")}))}var y=n(86507),b=n(14938),v=n(98901),E=n(51662);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=function(e){var t=e.isDisabled,n=e.children,r=e.dataProvider,l=e.onRemediationCreated,c=e.buttonProps,g=(0,a.useState)(!1),S=(0,i.Z)(g,2),P=S[0],w=S[1],C=(0,a.useState)(),_=(0,i.Z)(C,2),R=_[0],O=_[1],D=(0,a.useState)(!1),Z=(0,i.Z)(D,2),I=Z[0],T=Z[1],N=(0,d.Z)();return(0,a.useEffect)((function(){N.getUserPermissions("remediations").then((function(e){w(e.some((function(e){var t=e.permission;return(0,y.P9)(t,y.FH)})))}))}),[]),P?s().createElement(s().Fragment,null,s().createElement(b.Button,(0,o.Z)({isDisabled:t,onClick:function(){Promise.resolve(r()).then((function(e){e?(function(e){p("object"===(0,u.Z)(e)&&null!==e),m(e,"issues","systems","onRemediationCreated"),f(e,"issues"),p(Array.isArray(e.issues),"Issues must be an array"),p(e.issues.length,"Issues array must not be empty"),e.issues.forEach((function(t){p("object"===(0,u.Z)(t)&&null!==t,"Issue must be an object"),m(t,"id","description","systems"),f(t,"id","description"),Object.prototype.hasOwnProperty.call(t,"systems")&&h(t.systems),p(Object.prototype.hasOwnProperty.call(t,"systems")||Object.prototype.hasOwnProperty.call(e,"systems"),"No systems defined for ".concat(t.id))})),Object.prototype.hasOwnProperty.call(e,"systems")&&h(e.systems)}(e),O(e)):T(!0)}))}},c),n),s().createElement(E.default,{isOpen:I,setOpen:T}),R&&s().createElement(v.default,{setOpen:function(e){return O((function(t){return!1===e?null:t}))},data:k({onRemediationCreated:l},R||{})})):s().createElement(b.Tooltip,{content:"You do not have correct permissions to remediate this entity."},s().createElement("span",null,s().createElement(b.Button,(0,o.Z)({isDisabled:!0},c),n)))};S.propTypes={isDisabled:c().bool,dataProvider:c().func.isRequired,onRemediationCreated:c().func,children:c().node,buttonProps:c().shape((0,r.Z)({},c().string,c().any))},S.defaultProps={isDisabled:!1,onRemediationCreated:function(e){return e},children:"Remediate with Ansible"};const P=S},51662:(e,t,n)=>{n.r(t),n.d(t,{NoDataModal:()=>l,default:()=>c});var r=n(92950),o=n.n(r),i=n(45697),a=n.n(i),s=n(14938),l=function(e){var t=e.isOpen,n=e.setOpen;return o().createElement(s.Modal,{variant:s.ModalVariant.small,title:"Remediate with Ansible",isOpen:t,onClose:function(){return n(!1)},actions:[o().createElement(s.Button,{key:"confirm",variant:"primary",onClick:function(){return n(!1)}},"Back to Insights")]},"None of the selected issues can be remediated with Ansible.",o().createElement("br",null),o().createElement("br",null),"To remediate these issues, review the manual remediation steps associated with each.")};l.propTypes={isOpen:a().bool,setOpen:a().func};const c=l},37269:(e,t,n)=>{n.r(t),n.d(t,{default:()=>oe});var r=n(15861),o=n(4942),i=n(29439),a=n(64687),s=n.n(a),l=n(92950),c=n.n(l),d=n(28216),u=n(14938),p=n(50289),m=n(73725),f=n(89376),h=n(39173),y=n(14748),b=n(83045),v=n(45697),E=n.n(v),g=n(97481),k=n(66655),S=n(95274),P=n(52017),w=n(62410),C=n(83215),_=n(92397),R=n(29144);function O(e,t,n){Promise.all(e.map((function(e){return n(e),e.payload}))).then(t)}var D=function(e){var t,n,r=e.remediation,o=e.remediationIdx,a=e.archived,s=e.selector,m=e.setExecuteOpen,f=e.update,h=e.loadRemediation,y=e.getConnectionStatus,b=e.downloadPlaybook,v=e.permission,E=(0,l.useState)(!1),g=(0,i.Z)(E,2),k=g[0],S=g[1],P=(0,l.useState)(a),D=(0,i.Z)(P,2),Z=D[0],I=D[1],T=(0,d.useDispatch)(),N=[],j=function(){O([(0,p.patchRemediation)(r.id,{archived:!Z})],(function(){I(!Z),f(!0)}),T)};return N.push(c().createElement(u.DropdownItem,{key:"execute",id:"execute",isDisabled:!v.isReceptorConfigured||Z,className:"".concat(!v.permissions.execute&&"ins-m-not-entitled"),onClick:function(){m(!1),O([h(r.id),y(r.id)],(function(){m(!0),S(!1)}),T)}},"Execute playbook")),N.push(c().createElement(u.DropdownItem,{key:"download",onClick:function(){b([r.id]),S(!1),(0,R.q)({title:"Preparing playbook for download",description:"Once complete, your download will start automatically.",variant:"info",dismissable:!0,autoDismiss:!0})}},"Download playbook")),Z?N.push(c().createElement(u.DropdownItem,{key:"restore",onClick:function(){j(),S(!1),T((0,C.wN)({variant:"info",title:"Restored playbook ".concat(r.name)}))}},"Restore playbook")):N.push(c().createElement(u.DropdownItem,{key:"archive",onClick:function(){j(),S(!1),T((0,C.wN)({variant:"info",title:"Archived playbook ".concat(r.name)}))}},"Archive playbook")),c().createElement(u.CardHeader,{className:"rem-c-playbook-card__header"},c().createElement(u.CardActions,null,c().createElement(u.Dropdown,{key:"dropdown",id:"".concat(r.id,"-dropdown"),isOpen:k,isPlain:!0,onSelect:function(e){return e},toggle:c().createElement(u.KebabToggle,{id:"".concat(r.id,"-toggle"),onToggle:function(e){return S(e)}}),dropdownItems:N,position:"right"}),c().createElement("input",{type:"checkbox",name:"".concat(r.id,"-checkbox"),checked:s.getSelectedIds().includes(r.id),onChange:function(e){s.props.onSelect(e,e.target.checked,o)},"aria-label":"".concat(r.id,"-checkbox")})),c().createElement(u.CardTitle,null,c().createElement(u.Stack,{hasGutter:!0},c().createElement(u.StackItem,{className:"rem-c-playbook-card__header--title"},c().createElement("span",{className:"pf-u-mr-sm"},(t=r.name,n=r.id,c().createElement(_.Z,{to:"/".concat(n),className:"rem-c-playbook-card__header--name"},t))),Z&&c().createElement(u.Label,null,"Archived")),c().createElement(u.StackItem,{className:"rem-c-playbook-card__header--last-modified"},"Last modified: ",c().createElement(w.Z,{date:r.updated_at})))))};D.propTypes={remediation:v.PropTypes.object.isRequired,remediationIdx:v.PropTypes.number.isRequired,archived:v.PropTypes.bool.isRequired,selector:v.PropTypes.object.isRequired,setExecuteOpen:v.PropTypes.func.isRequired,update:v.PropTypes.func.isRequired,loadRemediation:v.PropTypes.func.isRequired,getConnectionStatus:v.PropTypes.func.isRequired,downloadPlaybook:v.PropTypes.func.isRequired,permission:v.PropTypes.object.isRequired};var Z=function(e){var t,n,r=e.remediation,o=e.remediationIdx,i=e.archived,a=e.selector,s=e.setExecuteOpen,l=e.update,d=e.loadRemediation,p=e.getConnectionStatus,m=e.downloadPlaybook,f=e.permission;return c().createElement(u.Card,{className:"rem-c-playbook-card",isCompact:!0},c().createElement(D,{remediation:r,remediationIdx:o,archived:i,selector:a,setExecuteOpen:s,update:l,loadRemediation:d,getConnectionStatus:p,downloadPlaybook:m,permission:f}),c().createElement(u.CardBody,{className:"rem-c-playbook-card__body"},c().createElement(u.Split,{hasGutter:!0,className:"rem-c-playbook-card__body--split"},c().createElement(u.SplitItem,null,c().createElement(u.Stack,null,c().createElement(u.StackItem,{className:"rem-c-playbook-card__body--titles"},"Systems"),c().createElement(u.StackItem,{className:"rem-c-playbook-card__body--values"},r.system_count))),c().createElement(u.SplitItem,null,c().createElement(u.Stack,null,c().createElement(u.StackItem,{className:"rem-c-playbook-card__body--titles"},"Complete actions"),c().createElement(u.StackItem,{className:"rem-c-playbook-card__body--values"},(t=r.resolved_count)===(n=r.issue_count)&&0!==t?c().createElement("div",null,c().createElement(P.CheckCircleIcon,{className:"rem-c-success"})," ",t," of Â ",n):"".concat(t," of ").concat(n)))))),function(e,t,n){return n?c().createElement(u.Progress,{className:"rem-c-playbook-card__progress rem-c-playbook-card__progress--archived",value:100,measureLocation:u.ProgressMeasureLocation.none}):e===t&&0!==e?c().createElement(u.Progress,{className:"rem-c-playbook-card__progress rem-c-playbook-card__progress--success",value:100,measureLocation:u.ProgressMeasureLocation.none}):c().createElement(u.Progress,{className:"rem-c-playbook-card__progress",value:e/t*100,measureLocation:u.ProgressMeasureLocation.none})}(r.resolved_count,r.issue_count,i))};Z.propTypes={remediation:v.PropTypes.object.isRequired,remediationIdx:v.PropTypes.number.isRequired,archived:v.PropTypes.bool.isRequired,selector:v.PropTypes.object.isRequired,setExecuteOpen:v.PropTypes.func.isRequired,executeOpen:v.PropTypes.bool.isRequired,update:v.PropTypes.func.isRequired,loadRemediation:v.PropTypes.func.isRequired,getConnectionStatus:v.PropTypes.func.isRequired,downloadPlaybook:v.PropTypes.func.isRequired,permission:v.PropTypes.object.isRequired};var I=function(e){var t=e.archivedCount,n=e.setShowArchived;return c().createElement(u.Bullseye,{className:"rem-c-no-remediations pf-u-pt-2xl"},c().createElement(u.EmptyState,null,c().createElement(u.EmptyStateIcon,{icon:P.WrenchIcon,size:"sm"}),c().createElement(u.Title,{size:"lg",headingLevel:"h5"},"No remediation playbooks yet"),c().createElement(u.EmptyStateBody,null,"Insights uses Ansible Playbooks to remediate or mitigate configuration problems on your systems, and apply patches.",c().createElement("br",null),c().createElement("br",null),"To create a remediation playbook, select issues identified in Insights applications, then select",c().createElement("strong",null," Remediate"),"."),c().createElement("br",null),t>0&&c().createElement(u.Button,{variant:"link",onClick:function(){return n(!0)},ouiaId:"show-archived-playbooks"},"Show ",t," archived playbooks")))};I.propTypes={archivedCount:E().number.isRequired,setShowArchived:E().func.isRequired};var T=[null,"name","system_count","issue_count","updated_at"];function N(e){var t,n,r=e.remediations,o=e.loadRemediations,a=e.sorter,s=e.filter,f=e.selector,h=e.pagination,b=e.shouldUpdateGrid,v=e.setShouldUpdateGrid,E=e.setRemediationCount,P=e.showArchived,w=e.setShowArchived,C=r.value,_=r.status,R=[],O=(0,l.useContext)(k.B),D=(0,l.useState)(!1),N=(0,i.Z)(D,2),j=N[0],q=N[1],A=(0,l.useState)(!1),x=(0,i.Z)(A,2),B=x[0],H=x[1],V=(0,d.useSelector)((function(e){return e.selectedRemediation})),L=(0,d.useSelector)((function(e){return e.connectionStatus})),U=(0,d.useSelector)((function(e){return e.runRemediation})),G=(0,d.useDispatch)();return(0,l.useEffect)((function(){var e;!0===b&&(v(!1),e=T[a.sortBy],P?o(e,a.sortDir,s.value,h.pageSize,h.offset):o(e,a.sortDir,s.value,h.pageSize,h.offset,void 0,!0))}),[b]),(0,l.useEffect)((function(){"changed"===U.status?((0,p.getConnectionStatus)(V.remediation.id),H(!0)):"fulfilled"===U.status&&q(!1)}),[U.status]),(0,l.useEffect)((function(){r.value&&E(C.meta.total)}),[r]),"fulfilled"!==_?c().createElement(c().Fragment,null,c().createElement(y.ZP,null,c().createElement(g.Z,{centered:!0}))):0===(R=P?null==C||null===(t=C.data)||void 0===t?void 0:t.map((function(e){return e})):null==C||null===(n=C.data)||void 0===n?void 0:n.reduce((function(e,t){return!0!==t.archived&&e.push(t),e}),[])).length?c().createElement(I,{archivedCount:C.data.length,setShowArchived:w}):(f.register(R),c().createElement(c().Fragment,null,c().createElement(u.Stack,{hasGutter:!0},c().createElement(u.StackItem,null,j&&c().createElement(S.l,{isOpen:j,onClose:function(){H(!1),q(!1)},showRefresh:B,remediationId:V.remediation.id,data:L.data,etag:L.etag,isLoading:"fulfilled"!==L.status,issueCount:V.remediation.issues.length,remediationStatus:U.status,runRemediation:function(e,t){G((0,p.runRemediation)(e,t)).then((function(){return G((0,p.getPlaybookRuns)(e))}))},setEtag:function(e){G((0,p.setEtag)(e))}})),c().createElement(u.StackItem,null,c().createElement(u.Grid,{sm:12,md:6,lg:4,hasGutter:!0},R.map((function(e,t){return c().createElement(u.GridItem,{key:e.id},c().createElement(Z,{remediation:e,remediationIdx:t,archived:e.archived,selector:f,setExecuteOpen:q,executeOpen:j,update:v,loadRemediation:p.loadRemediation,getConnectionStatus:p.getConnectionStatus,downloadPlaybook:m.rN,permission:O}))})))))))}N.propTypes={remediations:E().object.isRequired,loadRemediations:E().func.isRequired,sorter:E().object.isRequired,filter:E().object.isRequired,selector:E().object.isRequired,pagination:E().object.isRequired,shouldUpdateGrid:E().bool.isRequired,setShouldUpdateGrid:E().func.isRequired,setRemediationCount:E().func.isRequired,showArchived:E().bool.isRequired,setShowArchived:E().func.isRequired};const j=N;var q=n(87462),A=n(45987),x=n(93433),B=n(15671),H=n(43144),V=n(97326),L=n(60136),U=n(82963),G=n(61120),K=n(2793),W=["dataProvider","children"];var F=function(e){(0,L.Z)(l,e);var t,n,i,a=(n=l,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,G.Z)(n);if(i){var r=(0,G.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,U.Z)(this,e)});function l(e){var t;return(0,B.Z)(this,l),t=a.call(this,e),(0,o.Z)((0,V.Z)(t),"isEnabled",(function(){return"true"===localStorage.getItem("remediations:debug")})),(0,o.Z)((0,V.Z)(t),"dataProviderPing",(function(){return{issues:[{id:"test:ping",description:"Ansible ping"}],systems:t.state.allHosts}})),(0,o.Z)((0,V.Z)(t),"dataProviderA1",(function(){return{issues:[{id:"vulnerabilities:CVE-2019-3815",description:"CVE-2019-3815"}],systems:t.state.allHosts}})),(0,o.Z)((0,V.Z)(t),"dataProviderA2",(function(){return{issues:[{id:"advisor:network_bond_opts_config_issue|NETWORK_BONDING_OPTS_DOUBLE_QUOTES_ISSUE",description:"Bonding will not fail over to the backup link when bonding options are partially read",systems:t.state.allHosts.slice(0,5)}]}})),(0,o.Z)((0,V.Z)(t),"dataProviderC1",(function(){return{issues:[{id:"vulnerabilities:CVE-2019-3815",description:"CVE-2019-3815"},{id:"vulnerabilities:CVE-2018-16865",description:"CVE-2018-16865"},{id:"vulnerabilities:CVE-2017-17712",description:"CVE-2017-17712"}],systems:t.state.allHosts.slice(-1)}})),(0,o.Z)((0,V.Z)(t),"dataProviderC2",(function(){return{issues:[{id:"advisor:network_bond_opts_config_issue|NETWORK_BONDING_OPTS_DOUBLE_QUOTES_ISSUE",description:"Bonding will not fail over to the backup link when bonding options are partially read"},{id:"advisor:rhnsd_pid_world_write|RHNSD_PID_WORLD_WRITABLE",description:"Code injection risk or wrong pid altering when rhnsd daemon file rhnsd.pid is world writable, due to a bug in rhnsd"}],systems:t.state.allHosts.slice(-1)}})),(0,o.Z)((0,V.Z)(t),"dataProviderC3",(function(){return{issues:[].concat((0,x.Z)(t.dataProviderC1().issues),(0,x.Z)(t.dataProviderC2().issues)),systems:t.state.allHosts.slice(-1)}})),(0,o.Z)((0,V.Z)(t),"dataProviderC4",(function(){return{issues:[{id:"advisor:network_bond_opts_config_issue|NETWORK_BONDING_OPTS_DOUBLE_QUOTES_ISSUE",description:"Bonding will not fail over to the backup link when bonding options are partially read"},{id:"advisor:corosync_enable_rt_schedule|COROSYNC_NOT_ENABLE_RT",description:"Cluster nodes are frequently fenced as realtime is not enabled in corosync"},{id:"advisor:CVE_2017_6074_kernel|KERNEL_CVE_2017_6074",description:"Kernel vulnerable to local privilege escalation via DCCP module (CVE-2017-6074)"}],systems:t.state.allHosts.slice(-1)}})),(0,o.Z)((0,V.Z)(t),"dataProviderC5",(function(){return{issues:[{id:"advisor:unsupported",description:"Unsupported issue"},{id:"vulnerabilities:CVE-2019-999999",description:"Unsupported issue"},{id:"advisor:CVE_2017_6074_kernel|KERNEL_CVE_2017_6074",description:"Kernel vulnerable to local privilege escalation via DCCP module (CVE-2017-6074)"}],systems:t.state.allHosts.slice(-1)}})),(0,o.Z)((0,V.Z)(t),"dataProviderD1",(function(){return{issues:[{id:"vulnerabilities:CVE-2019-3815",description:"CVE-2019-3815",systems:t.state.allHosts.slice(0,1)},{id:"vulnerabilities:CVE-2018-16865",description:"CVE-2018-16865",systems:t.state.allHosts.length>1?t.state.allHosts.slice(1,2):t.state.allHosts.slice(0,1)},{id:"vulnerabilities:CVE-2017-17712",description:"CVE-2017-17712"}],systems:t.state.allHosts}})),(0,o.Z)((0,V.Z)(t),"dataProviderD2",(function(){return{issues:[{id:"advisor:network_bond_opts_config_issue|NETWORK_BONDING_OPTS_DOUBLE_QUOTES_ISSUE",description:"Bonding will not fail over to the backup link when bonding options are partially read",systems:t.state.allHosts.slice(0,1)},{id:"advisor:rhnsd_pid_world_write|RHNSD_PID_WORLD_WRITABLE",description:"Code injection risk or wrong pid altering when rhnsd daemon file rhnsd.pid is world writable, due to a bug in rhnsd",systems:t.state.allHosts.slice(1)}]}})),t.state={allHosts:!1},t}return(0,H.Z)(l,[{key:"componentDidMount",value:(t=(0,r.Z)(s().mark((function e(){var t=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isEnabled()&&(0,m.yY)().then((function(e){return t.setState({allHosts:e.results.map((function(e){return e.id}))})}));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this;if(!this.isEnabled())return null;var t=this.state.allHosts,n=function(n){var r=n.dataProvider,o=n.children,i=(0,A.Z)(n,W);return c().createElement(u.SplitItem,null,c().createElement(K.default,(0,q.Z)({dataProvider:r,isDisabled:!t||!t.length,onRemediationCreated:e.props.onRemediationCreated},i),o))};return c().createElement(c().Fragment,null,c().createElement(u.Stack,{hasGutter:!0},c().createElement(u.StackItem,null,c().createElement(u.Split,{hasGutter:!0},["ping","alwaysFail","failHalfTheTime","pause1m","pause5m","pause15m","pauseRandom15m","pause1h","pause6h"].map((function(t){return c().createElement(n,{key:t,dataProvider:function(){return{issues:[{id:"test:".concat(t),description:"Ansible ".concat(t," test playbook")}],systems:e.state.allHosts}}},t)})))),c().createElement(u.StackItem,null,c().createElement(u.Split,{hasGutter:!0},c().createElement(n,{dataProvider:this.dataProviderA1},"A1"),c().createElement(n,{dataProvider:this.dataProviderA2},"A2"),c().createElement(n,{dataProvider:this.dataProviderC1},"C1"),c().createElement(n,{dataProvider:this.dataProviderC2},"C2"),c().createElement(n,{dataProvider:this.dataProviderC3},"C3"),c().createElement(n,{dataProvider:this.dataProviderC4},"C4 (multires)"),c().createElement(n,{dataProvider:this.dataProviderC5},"C5 (unsupported)"),c().createElement(n,{dataProvider:this.dataProviderD1},"D1"),c().createElement(n,{dataProvider:this.dataProviderD2},"D2")))))}}]),l}(c().Component);F.propTypes={onRemediationCreated:E().func},F.defaultProps={onRemediationCreated:function(e){return e}};const M=F;var z=n(78762),Q=n(10170),Y=n(11178),J=n(58610),X=n(24350),$=n.n(X),ee=n(55140);function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){(0,o.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var re=[null,"name","system_count","issue_count","updated_at"];const oe=function(){var e,t=(0,ee.Z)();(0,l.useEffect)((function(){t.updateDocumentTitle("Remediations | Red Hat Insights")}),[t]);var n=(0,l.useState)("dismissed"!==localStorage.getItem("remediations:receptorBannerStatus")),o=(0,i.Z)(n,2),a=o[0],v=o[1],E=(0,Y.sk)(4,"desc"),g=(0,Y.L0)(),S=(0,Y.v9)(),P=(0,Y.h0)(),w=(0,l.useState)(0),_=(0,i.Z)(w,2),R=_[0],O=_[1],D=(0,l.useState)(""),Z=(0,i.Z)(D,2),I=Z[0],T=Z[1],N=(0,l.useState)(!1),q=(0,i.Z)(N,2),A=q[0],x=q[1],B=(0,l.useState)("true"===localStorage.getItem("remediations:showArchived")),H=(0,i.Z)(B,2),V=H[0],L=H[1],U=(0,l.useState)(!1),G=(0,i.Z)(U,2),K=G[0],W=G[1],F=(0,d.useSelector)((function(e){return e.remediations})),X=(0,d.useDispatch)(),te=function(){return X(p.loadRemediations.apply(p,arguments))},oe=(null==F||null===(e=F.value)||void 0===e?void 0:e.data.length)||0;(0,l.useEffect)((function(){var e=re[E.sortBy];V?te(e,E.sortDir,g.value,P.pageSize,P.offset):te(e,E.sortDir,g.value,P.pageSize,P.offset,void 0,!0)}),[]),(0,l.useEffect)((function(){"fulfilled"===F.status&&g.value===I&&W(!0)}),[E.sortBy,E.sortDir,g.value,P.pageSize,P.pageDebounced,V]),(0,l.useEffect)((function(){g.setValue(I)}),[I]),g.onChange(P.reset),E.onChange(P.reset);var ie=S.getSelectedIds(),ae=function(e){var t;t=e.getNotification(),X((0,C.wN)(t)),X(p.loadRemediations())},se={filters:I.length?[{category:"Name",chips:[{name:I}]}]:[],onDelete:function(){T(""),g.setValue("")}};return c().createElement("div",{className:"page__remediations"},c().createElement(k.B.Consumer,null,(function(e){return!1===e.permissions.read?c().createElement(z.Z,null):c().createElement(c().Fragment,null,c().createElement(f.Z,null,c().createElement(h.Z,{title:"Remediations"}),c().createElement(M,{onRemediationCreated:ae})),c().createElement(b.Z,{filterConfig:{items:[{label:"Search playbooks",type:"text",filterValues:{id:"filter-by-string",key:"filter-by-string",placeholder:"Search playbooks",value:I,onChange:function(e,t){T(t)}}}]},bulkSelect:{items:[{title:"Select none",onClick:function(){return S.props.onSelect("none",!0)}},{title:"Select page (".concat(oe,")"),onClick:function(){return S.props.onSelect("page",!0)}}],checked:ie.length&&R>ie.length?null:ie.length,count:ie.length,isDisabled:!oe,onSelect:function(e){return S.props.onSelect(ie.length?"none":"page",e)}},actionsConfig:{actions:[{label:ie.length>1?"Download playbooks":"Download playbook",props:{variant:"secondary",isDisabled:!ie.length},onClick:function(){return function(e,t,n){var r=function(e,t){var n=$()(t,(function(e){return e.id}));return e.reduce((function(e,t){var r=n[t];return r&&r.issue_count>0&&e.push(r.id),e}),[])}(e,t);0===r.length?n((0,C.wN)({variant:"danger",title:"No playbooks downloaded.",description:e.length>1?"Selected remediations do not contain any issues to remediate.":"Selected remediation does not contain any issues to remediate."})):r.length<e.length?((0,m.rN)(r),n((0,C.wN)({variant:"success",title:r.length>1?"Downloading playbooks":"Downloading playbook",description:e.length-r.length>1?"".concat(e.length-r.length," remediations with no issues were not downloaded."):"1 remediation with no issues was not downloaded."}))):((0,m.rN)(r),n((0,C.wN)({variant:"success",title:r.length>1?"Downloading playbooks":"Downloading playbook"})))}(ie,F.value.data,X)}},{label:"Delete playbooks",props:{isDisabled:!e.permissions.write||!ie.length},onClick:function(){return x(!0)}},{label:V?"Hide archived playbooks":"Show archived playbooks",onClick:V?function(){L(!1),S.reset(),localStorage.setItem("remediations:showArchived","false")}:function(){L(!0),S.reset(),localStorage.setItem("remediations:showArchived","true")}}]},pagination:ne(ne({},P.props),{},{itemCount:R}),activeFiltersConfig:se}),c().createElement(y.ZP,null,c().createElement(u.Stack,{hasGutter:!0},e.hasSmartManagement&&!e.isReceptorConfigured&&a&&c().createElement(u.StackItem,null,c().createElement(Q.Z,{onClose:function(){return v(!1),void localStorage.setItem("remediations:receptorBannerStatus","dismissed")}})),A&&c().createElement(J.Z,{title:1===ie.length?"Remove playbook":"Remove playbooks",text:"".concat(ie.length," ").concat(ie.length>1?"playbooks":"playbook","\n                                            will be removed from Remediations. This is permanent and cannot be undone."),confirmText:"Remove",onClose:function(){var e=(0,r.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x(!1),!t){e.next=6;break}return e.next=4,n=ie,X(p.deleteRemediations({remediation_ids:n}));case 4:te(),S.reset();case 6:case"end":return e.stop()}var n}),e)})));return function(t){return e.apply(this,arguments)}}()}),c().createElement(u.StackItem,null,c().createElement(j,{remediations:F,loadRemediations:te,sorter:E,filter:g,selector:S,pagination:P,shouldUpdateGrid:K,setShouldUpdateGrid:W,setRemediationCount:O,showArchived:V,setShowArchived:L})))))})))}}}]);
//# sourceMappingURL=../sourcemaps/Home.b0a93c9935f97490f1d0a6b94f32e64a.js.map