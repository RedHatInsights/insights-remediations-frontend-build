(self.webpackChunkremediations=self.webpackChunkremediations||[]).push([[2530],{77832:(e,t,n)=>{"use strict";function a(e){return e.split(":")[0]}function r({id:e}){switch(a(e)){case"advisor":return"Advisor";case"ssg":return"Compliance";case"vulnerabilities":return"Vulnerability";case"patch-advisory":return"Patch";default:return"Unknown"}}function l({display_name:e,hostname:t,id:n}){return e||t||n}function s(e,t){return e.toLowerCase().includes(t.toLowerCase())}n.d(t,{PW:()=>s,Pz:()=>a,_f:()=>l,lN:()=>r})},18293:(e,t,n)=>{"use strict";n.d(t,{Gd:()=>i,T:()=>s,Tj:()=>c});var a=n(54998),r=n.n(a),l=n(77832);function s(e){const t=function({id:e}){switch((0,l.Pz)(e)){case"advisor":return"advisor";case"vulnerabilities":return"vulnerabilities";case"ssg":return"compliance";case"patch-advisory":return"patch";default:return"general_information"}}(e),n=i("inventory").toString();return e=>`${n}/${e}?appName=${t}`}function c(e){const t=e.split(":");switch(t[0]){case"advisor":return i(t[0]).segment("recommendations").segment(t[1]).toString();case"vulnerabilities":return i(t[0]).segment("cves").segment(t[1]).toString();case"patch-advisory":return i(t[0]).segment("advisories").segment(t[1]+":"+t[2]).toString();default:return null}}function i(e){switch(e){case"advisor":return r()(document.baseURI).segment("insights").segment("advisor");case"vulnerabilities":return r()(document.baseURI).segment("insights").segment("vulnerability");case"compliance":case"ssg":return r()(document.baseURI).segment("insights").segment("compliance");case"inventory":return r()(document.baseURI).segment(function(){const e=window.location.pathname.split("/");return"preview"===e[1]?e[2]:e[1]}()).segment("inventory");case"patch-advisory":return r()(document.baseURI).segment("insights").segment("patch");default:throw new Error(`Unknown app: ${e}`)}}},75593:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>X});var a=n(10756),r=n.n(a),l=n(28216),s=n(92397),c=n(88208),i=n(63652),o=n(99087),m=n(63456),u=n(39173),d=n(62410),p=n(32819),E=n(31593),y=n(76491),g=n(40667),b=n(53774),_=n(29684),h=n(37248),v=n.n(h),f=n(881),S=n(76400),k=n(34413),I=n(33626),Z=n(15848),N=n(75796),R=n(45791);const w=()=>r().createElement(r().Fragment,null,r().createElement(m.Z,null,r().createElement(b.Breadcrumb,null,r().createElement(b.BreadcrumbItem,null,r().createElement(p.Z,{size:"lg"})),r().createElement(b.BreadcrumbItem,null,r().createElement(p.Z,{size:"lg"})),r().createElement(b.BreadcrumbItem,{isActive:!0},r().createElement(p.Z,{size:"lg"}))),r().createElement(g.Stack,{hasGutter:!0},r().createElement(g.StackItem,null,r().createElement(u.Z,{title:r().createElement(p.Z,{size:"lg"})})),r().createElement(g.StackItem,null,r().createElement(_.Split,{hasGutter:!0},r().createElement(_.SplitItem,null,r().createElement(S.Z,{className:"rem-c-playbookSummary__settings",title:"Run on"},r().createElement(p.Z,{size:"lg"}))),r().createElement(_.SplitItem,null,r().createElement(S.Z,{className:"rem-c-playbookSummary__settings",title:"Run by"},r().createElement(p.Z,{size:"lg"}))),r().createElement(_.SplitItem,null,r().createElement(S.Z,{className:"rem-c-playbookSummary__settings",title:"Run by"},r().createElement(p.Z,{size:"lg"}))))))),r().createElement(o.ZP,null,r().createElement(g.Stack,{hasGutter:!0},r().createElement(y.Card,null,r().createElement(y.CardBody,null,r().createElement(R.Bullseye,null,r().createElement(N.Spinner,null)))))));var x=n(45697),C=n.n(x),B=n(4252),T=n(20211),P=n.n(T);const z=({name:e})=>r().createElement(R.Bullseye,null,r().createElement(B.EmptyState,null,r().createElement(B.EmptyStateHeader,{titleText:"Run failed",icon:r().createElement(B.EmptyStateIcon,{className:"rem-c-failure",icon:P()}),headingLevel:"h5"}),r().createElement(B.EmptyStateBody,null,"Playbook failed to run on ",e,". Connection was lost. Try executing the remediation again, and if the problem persist, constact your system administrator(s)."),r().createElement(B.EmptyStateFooter,null,r().createElement(E.Button,{variant:"link"},"Learn more"))));z.propTypes={name:C().string};const G=z;var F=n(95726),D=n(92223),$=n(68175);const A=(0,n(18293).T)({id:"default"}),L=[{key:"display_name",title:"Name",renderFunc:(e,t,{fqdn:n})=>r().createElement("div",null,r().createElement("a",{href:A(t)},n||e||t))},{key:"tags"},{key:"status",title:"Status",renderFunc:e=>r().createElement("div",{className:"rem-c-status-bar"},(0,Z.Nv)((0,Z.fb)(e)))}];var O=n(22812),U=n(66650),Y=n(19158),V=n(49231);const q=({data:e})=>r().createElement(Y.nU,{data:e,toolbar:r().createElement(V.Toolbar,null,r().createElement(V.ToolbarContent,null,r().createElement(V.ToolbarItem,null,r().createElement(Y.Yt,{placeholder:"Search"}))))});q.propTypes={data:C().string};const j=q;var H=n(13193);O.Z.registerLanguage("yaml",U.Z);const W=({systemId:e,playbookRunSystemDetails:t})=>r().createElement(r().Fragment,null,r().createElement(H.Title,{headingLevel:"h4",size:"xl",className:"rem-c-title-job-output"},"Playbook log"),e&&e===t.system_id?r().createElement(r().Fragment,null,r().createElement(j,{data:t.console}),"running"===t.status&&r().createElement("div",{className:"rem-l-playbook-running"},r().createElement(N.Spinner,{size:"lg","aria-valuetext":"playbook in progress",className:"ins-c-spinner__playbook-running"}))):r().createElement(p.Z,{size:"lg"}));W.propTypes={systemId:C().string,status:C().string,console:C().string,playbookRunSystemDetails:C().shape({system_id:C().string,status:C().string,console:C().string})},W.defaultProps={playbookRunSystemDetails:{}};const K=(0,l.connect)((({playbookRunSystemDetails:e})=>({playbookRunSystemDetails:e})))(W);var M=n(41609),J=n.n(M);let Q;const X=()=>{const{executor_id:e,run_id:t,id:n}=(0,c.useParams)(),[h,N]=(0,a.useState)({}),[R,x]=(0,a.useState)(),[C,B]=(0,a.useState)(!1),T=(0,a.useRef)(null),P=(0,l.useDispatch)(),z=(0,l.useSelector)((({selectedRemediation:e})=>e.remediation)),A=(0,l.useSelector)((({playbookRun:e})=>e)),O=(0,l.useSelector)((({playbookRunSystemDetails:e})=>e));(0,a.useEffect)((()=>(P((0,k.K4)()),z||P((0,k.d5)(n)),J()(A)&&P((0,k.zy)(n,t)),()=>{Q&&clearInterval(Q)})),[]),(0,a.useEffect)((()=>{A&&A.data&&N(A.data.executors.find((t=>t.executor_id===e))||{})}),[A]),(0,a.useEffect)((()=>{C||P((0,k.zy)(n,t)),"running"!==(0,Z.fb)(O.status)&&Q&&clearInterval(Q),B(!1)}),[O.status]);const U=(e=>{const{id:t,run_id:n,executor_id:a,openId:l}=e||{};return async(e,{page:s,per_page:c,filters:{hostnameOrId:i}})=>{const o=await I.V_.getPlaybookRunSystems(t,n,a,c,c*(s-1),i);return{results:o.data.map((({system_id:e,system_name:t,status:n})=>({id:e,display_name:t,status:n,isOpen:l===e,children:r().createElement(K,{systemId:e})}))),total:o.meta?.total}}})({id:n,run_id:t,executor_id:e,openId:R}),Y=e=>r().createElement(o.ZP,null,r().createElement(g.Stack,{hasGutter:!0},r().createElement(y.Card,{className:"rem-c-card__playbook-log"},r().createElement(y.CardBody,null,r().createElement(i.Z,{initialLoading:!0,ref:T,columns:e=>(0,$.VA)(e,L),onLoad:({INVENTORY_ACTION_TYPES:e,mergeWithEntities:t})=>(0,D.z2)({...t(f.Z.playbookActivityIntentory({INVENTORY_ACTION_TYPES:e})())}),getEntities:U,hasCheckbox:!1,expandable:!0,showTags:!0,onExpandClick:"running"===e?(e,n,a,{id:r})=>{B(!0),a?(x(r),Q&&clearInterval(Q),P((0,k.gE)(z.id,t,r)),Q=setInterval((()=>P((0,k.gE)(z.id,t,r))),5e3)):(x(void 0),clearInterval(Q)),P((0,k.wY)(a,r))}:(e,n,a,{id:r})=>{B(!0),a?(x(r),P((0,k.gE)(z.id,t,r))):x(void 0),clearInterval(Q),P((0,k.wY)(r,a))},actionsConfig:{actions:[r().createElement(E.Button,{key:"download-playbook",variant:"secondary",onClick:()=>(0,I.rN)([z.id])},"Download playbook")]},hideFilters:{all:!0,name:!1}}))))),V=(0,a.useContext)(F.B);return z&&h&&A&&A.data?r().createElement(r().Fragment,null,r().createElement(m.Z,null,r().createElement(b.Breadcrumb,null,r().createElement(b.BreadcrumbItem,null,r().createElement(s.Z,{to:"/"}," Remediations ")),r().createElement(b.BreadcrumbItem,null,r().createElement(s.Z,{to:`/${z.id}`}," ",z.name," ")),r().createElement(b.BreadcrumbItem,null,r().createElement(s.Z,{to:`/${z.id}/${t}`},r().createElement(d.Z,{type:"exact",date:A.data.created_at}))),r().createElement(b.BreadcrumbItem,{isActive:!0}," ",h.executor_name," ")),r().createElement(g.Stack,{hasGutter:!0},r().createElement(g.StackItem,null,r().createElement(u.Z,{title:"Running"===(0,Z.fb)(h.status)?r().createElement(r().Fragment,null,r().createElement(v(),{className:"rem-c-running","aria-label":"connection status"}),h.executor_name):h.executor_name})),r().createElement(g.StackItem,null,r().createElement(_.Split,{hasGutter:!0},r().createElement(_.SplitItem,null,r().createElement(S.Z,{className:"rem-c-playbookSummary__settings",title:"Run status"},h.status?r().createElement(Z.kf,{executorStatus:h.status,counts:h.counts,permission:V}):r().createElement(p.Z,{size:"lg"}))),r().createElement(_.SplitItem,null,r().createElement(S.Z,{className:"rem-c-playbookSummary__settings",title:"Run by"},`${A.data.created_by.first_name} ${A.data.created_by.last_name}`)),r().createElement(_.SplitItem,null,r().createElement(S.Z,{className:"rem-c-playbookSummary__settings",title:"Run on"},r().createElement(d.Z,{type:"exact",date:A.data.created_at}))))))),{running:Y(q=(0,Z.fb)(h.status)),success:Y(q),failure:Y(q),canceled:Y(q),epicFailure:r().createElement(o.ZP,null,r().createElement(g.Stack,{hasGutter:!0},r().createElement(y.Card,null,r().createElement(y.CardHeader,{className:"rem-m-card__header-bold"},r().createElement(E.Button,{variant:"secondary",onClick:()=>(0,I.rN)(z.id)},"Download playbook")),r().createElement(y.CardBody,null,r().createElement(G,{name:h.executor_name})))))}[(0,Z.fb)(q)]):r().createElement(w,null);var q}},76400:(e,t,n)=>{"use strict";n.d(t,{Z:()=>m});var a=n(10756),r=n.n(a),l=n(45697),s=n.n(l),c=n(93967),i=n.n(c);const o=({title:e,className:t,children:n,isBold:a,hasGutter:l,needsPointer:s,...c})=>{const o=i()("rem-c-description-list__description",{"rem-c-description-list__description--bold":a},{"rem-c-description-list__description--withGutter":l},{"rem-c-description-list__description--needsPointer":s}),m=i()(t,"rem-c-description-list");return r().createElement("dl",{className:m,...c},r().createElement("dt",{className:"rem-c-description-list__title"},r().createElement("b",null,e)),r().createElement("dd",{className:o}," ",n," "))},m=o;o.propTypes={title:s().string,children:s().any,isBold:s().bool,className:s().string,hasGutter:s().bool,needsPointer:s().bool}},68175:(e,t,n)=>{"use strict";n.d(t,{Gx:()=>l,M1:()=>r,VA:()=>s,um:()=>a});const a=(e=[],t)=>e.every((({id:e})=>t?.has(e)))?e.length>0:e.some((({id:e})=>t?.has(e)))&&null,r=e=>e?.issues?.reduce(((e,t)=>(t?.systems?.forEach((n=>{const a=e.find((({id:e})=>n.id===e)),r={id:t.id,resolution:t.resolution,description:t.description};a?(a.issues=[...a.issues,{...r,resolved:a.resolved}],a.rebootRequired=a.issues.some((({resolution:e})=>e?.needs_reboot))):e.push({...n,issues:[{...r,resolved:n.resolved}],rebootRequired:t?.resolution?.needs_reboot})})),e)),[])||[],l=async({page:e=0,...t}={},n,a,r)=>{const l=n.filter((({display_name:e})=>!t.filters?.hostnameOrId||e.includes(t.filters.hostnameOrId))),s=await a(l.slice((e-1)*t.per_page,e*t.per_page).map((({id:e})=>e)),{...t,hasItems:!0},!0),c=s.results.map((e=>{const t=e.id,n=403!==r&&r.find((e=>e.system_ids.includes(t)));return n?{...e,connection_status:n.connection_status,executor_type:n.executor_type}:e}));return{...s,page:e,results:c.map((e=>({...l.find((({id:t})=>t===e.id)),...e}))),total:l.length}},s=(e=[],t=[])=>t.map((t=>e.find((e=>e.key===t.key))||t))},42655:()=>{}}]);
//# sourceMappingURL=../sourcemaps/ExecutorDetails.c2f482c98f2eab9f054a692b870ffa32.js.map